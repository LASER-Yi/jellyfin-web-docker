"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[31075],{31075:function(e,t,a){a.r(t),a.d(t,{default:function(){return q},show:function(){return L}}),a(63238),a(95289),a(61418);var l,i,s,n=a(65009),r=a.n(n),o=a(93355),u=a(18613),d=a(72365),c=a(28540),b=a(54517),p=a(30325),f=a(94994),v='<div class="formDialogHeader"> <button is="paper-icon-button-light" class="btnCancel autoSize" tabindex="-1" title="${ButtonBack}"><span class="material-icons arrow_back" aria-hidden="true"></span></button> <h3 class="formDialogHeaderTitle"> ${HeaderUploadSubtitle} </h3> </div> <div class="formDialogContent"> <div class="dialogContentInner"> <form class="uploadSubtitleForm"> <div class="flex align-items-center" style="margin:1.5em 0"> <h2 style="margin:0">${HeaderAddUpdateSubtitle}</h2> <button is="emby-button" type="button" class="raised raised-mini btnBrowse"> <span class="material-icons folder" aria-hidden="true"></span> <span>${Browse}</span> </button> </div> <div> <div class="subtitleEditor-dropZone fieldDescription"> <div id="labelDropSubtitle">${LabelDropSubtitleHere}</div> <output id="subtitleOutput" class="flex align-items-center justify-content-center" style="position:absolute;top:0;left:0;right:0;bottom:0;width:100%"></output> <input type="file" accept=".sub,.srt,.vtt,.ass,.ssa" id="uploadSubtitle" name="uploadSubtitle" style="position:absolute;top:0;left:0;right:0;bottom:0;width:100%;opacity:0"/> </div> <div id="fldUpload" class="hide"> <br/> <div class="checkboxContainer"> <label> <input type="checkbox" is="emby-checkbox" id="chkIsForced"/> <span>${LabelIsForced}</span> </label> </div> <div class="selectContainer flex-grow"> <select is="emby-select" id="selectLanguage" required="required" label="${LabelLanguage}"></select> </div> <button is="emby-button" type="submit" class="raised button-submit block"> <span>${Upload}</span> </button> </div> </div> </form> </div> </div> ',h=a(56663),m=(a(38228),a(15856),!1);function g(e){c.ZP.hide();var t=e.target.error;t.code!==t.ABORT_ERR&&(0,h.Z)(f.ZP.translate("MessageFileReadError"))}function y(e){return e&&[".sub",".srt",".vtt",".ass",".ssa"].some((function(t){return e.name.endsWith(t)}))}function S(e){var t=s;if(!y(t))return(0,h.Z)(f.ZP.translate("MessageSubtitleFileTypeAllowed")),void e.preventDefault();c.ZP.show();var a=d.ZP.parentWithClass(this,"dialog"),n=a.querySelector("#selectLanguage").value,r=a.querySelector("#chkIsForced").checked;u.Z.getApiClient(i).uploadItemSubtitle(l,n,r,t).then((function(){a.querySelector("#uploadSubtitle").value="",c.ZP.hide(),m=!0,o.default.close(a)})),e.preventDefault()}function L(e){return new Promise((function(t){m=!1,function(e,t){l=(e=e||{}).itemId,i=e.serverId;var a={removeOnClose:!0,scrollY:!1};p.Z.tv?a.size="fullscreen":a.size="small";var n,u=o.default.createDialog(a);u.classList.add("formDialog"),u.classList.add("subtitleUploaderDialog"),u.innerHTML=f.ZP.translateHtml(v,"core"),p.Z.tv&&b.default.centerFocus.on(u,!1),u.addEventListener("close",(function(){p.Z.tv&&b.default.centerFocus.off(u,!1),c.ZP.hide(),t(m)})),o.default.open(u),(n=u).querySelector(".uploadSubtitleForm").addEventListener("submit",S),n.querySelector("#uploadSubtitle").addEventListener("change",(function(){!function(e,t){var a=t[0];if(!y(a))return e.querySelector("#subtitleOutput").innerHTML="",e.querySelector("#fldUpload").classList.add("hide"),e.querySelector("#labelDropSubtitle").classList.remove("hide"),void(s=null);s=a;var l,i=new FileReader;i.onerror=g,i.onloadstart=function(){e.querySelector("#fldUpload").classList.add("hide")},i.onabort=function(){c.ZP.hide(),console.debug("File read cancelled")},i.onload=(l=a,function(){var t='<div><span class="material-icons subtitles" aria-hidden="true" style="transform: translateY(25%);"></span><span>'.concat(r()(l.name),"</span></div>");e.querySelector("#subtitleOutput").innerHTML=t,e.querySelector("#fldUpload").classList.remove("hide"),e.querySelector("#labelDropSubtitle").classList.add("hide")}),i.readAsDataURL(a)}(n,this.files)})),n.querySelector(".btnBrowse").addEventListener("click",(function(){n.querySelector("#uploadSubtitle").click()}));var d=u.querySelector("#selectLanguage");e.languages&&(d.innerHTML=e.languages.list||null,d.value=e.languages.value||null),u.querySelector(".btnCancel").addEventListener("click",(function(){o.default.close(u)}))}(e,t)}))}var q={show:L}}}]);