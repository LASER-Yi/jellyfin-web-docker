"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[10878],{21475:function(e,n,t){t.r(n),t.d(n,{Component:function(){return q},action:function(){return B},loader:function(){return R}});var a=t(62540),r=t(38345),i=t(33399),s=t(31858),o=t(38008),l=t(47891),c=t(92779),u=t(63703),d=t(96441),f=t(70140),h=t(67854),p=t(57836),g=t(89348),m=t(63696),y=t(87404),v=t(9055),b=t(44419),x=t(84849),A=t(69664),C=t(65242),j=t(86191),S=t(69410),w=t(5898),k=t(31297),D=function(){return D=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},D.apply(this,arguments)},L=function(e,n,t,a){return new(t||(t=Promise))((function(r,i){function s(e){try{l(a.next(e))}catch(e){i(e)}}function o(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,o)}l((a=a.apply(e,n||[])).next())}))},P=function(e,n){var t,a,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],a=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},I=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var a,r,i=t.call(e),s=[];try{for(;(void 0===n||n-- >0)&&!(a=i.next()).done;)s.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return s},E="branding",N="/Branding/Splashscreen",O={CustomCss:"CustomCss",LoginDisclaimer:"LoginDisclaimer",SplashscreenEnabled:"SplashscreenEnabled"},B=function(e){return L(void 0,[e],void 0,(function(e){var n,t,a,i,s,o,l,c=e.request;return P(this,(function(e){switch(e.label){case 0:if(!(n=j.A.getCurrentApi()))throw new Error("No Api instance available");return[4,c.formData()];case 1:return t=e.sent(),a=Object.fromEntries(t),i={CustomCss:null===(s=a.CustomCss)||void 0===s?void 0:s.toString(),LoginDisclaimer:null===(o=a.LoginDisclaimer)||void 0===o?void 0:o.toString(),SplashscreenEnabled:"on"===(null===(l=a.SplashscreenEnabled)||void 0===l?void 0:l.toString())},[4,(0,r.T)(n).updateNamedConfiguration({key:E,body:JSON.stringify(i)})];case 2:return e.sent(),k.q.invalidateQueries({queryKey:[b.t5]}),[2,{isSaved:!0}]}}))}))},R=function(){return k.q.ensureQueryData((0,b.iz)(j.A.getCurrentApi()))},q=function(){var e,n=(0,S.gf)().api,t=(0,y.cq)(),j=(0,y.mP)(),B="submitting"===t.state,R=(0,b.l9)(),q=R.data,T=R.isPending,U=I((0,m.useState)(q||{}),2),F=U[0],H=U[1],z=I((0,m.useState)(),2),Q=z[0],J=z[1],K=I((0,m.useState)(null!==(e=F.SplashscreenEnabled)&&void 0!==e&&e),2),W=K[0],G=K[1],V=I((0,m.useState)(),2),M=V[0],X=V[1];(0,m.useEffect)((function(){n&&!B&&X(n.getUri(N,{t:Date.now()}))}),[n,B]);var Y=(0,m.useCallback)((function(){J(void 0),n&&(0,i.C)(n).deleteCustomSplashscreen().then((function(){X(n.getUri(N,{t:Date.now()}))})).catch((function(e){console.error("[BrandingPage] error deleting image",e),J("ImageDeleteFailed")}))}),[n]),Z=(0,m.useCallback)((function(e){J(void 0);var t=e.target.files;if(!n||!t)return!1;var a=t[0],r=new FileReader;r.onerror=function(e){console.error("[BrandingPage] error reading file",e),J("ImageUploadFailed")},r.onabort=function(e){console.warn("[BrandingPage] aborted reading file",e),J("ImageUploadCancelled")},r.onload=function(){var e;if(r.result){var t=r.result,s=t.split(",")[1];(0,i.C)(n).uploadCustomSplashscreen({body:s},{headers:(e={},e["Content-Type"]=a.type,e)}).then((function(){X(t)})).catch((function(e){console.error("[BrandingPage] error uploading splashscreen",e),J("ImageUploadFailed")}))}},r.readAsDataURL(a)}),[n]),$=(0,m.useCallback)((function(e,t){return L(void 0,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return G(t),[4,(0,r.T)(n).updateNamedConfiguration({key:E,body:JSON.stringify(D(D({},q),{SplashscreenEnabled:t}))})];case 1:return e.sent(),k.q.invalidateQueries({queryKey:[b.t5]}),[2]}}))}))}),[n,q]),_=(0,m.useCallback)((function(e){var n;Object.keys(O).includes(e.target.name)&&H(D(D({},F),((n={})[e.target.name]=e.target.value,n)))}),[F]),ee=(0,m.useCallback)((function(){J(void 0)}),[]);return T?(0,a.jsx)(x.A,{}):(0,a.jsx)(C.A,{id:"brandingPage",title:w.Ay.translate("HeaderBranding"),className:"mainAnimatedPage type-interior",children:(0,a.jsx)(c.A,{className:"content-primary",children:(0,a.jsx)(v.lV,{method:"POST",onSubmit:ee,children:(0,a.jsxs)(f.A,{spacing:3,children:[(0,a.jsx)(g.A,{variant:"h1",children:w.Ay.translate("HeaderBranding")}),!B&&(null==j?void 0:j.isSaved)&&(0,a.jsx)(l.A,{severity:"success",children:w.Ay.translate("SettingsSaved")}),Q&&(0,a.jsx)(l.A,{severity:"error",children:w.Ay.translate(Q)}),(0,a.jsxs)(f.A,{direction:{xs:"column",sm:"row"},spacing:3,children:[(0,a.jsx)(c.A,{sx:{flex:"1 1 0"},children:(0,a.jsx)(A.A,{isLoading:!1,url:W?M:void 0})}),(0,a.jsxs)(f.A,{spacing:{xs:3,sm:2},sx:{flex:"1 1 0"},children:[(0,a.jsx)(d.A,{control:(0,a.jsx)(h.A,{name:O.SplashscreenEnabled,checked:W,onChange:$}),label:w.Ay.translate("EnableSplashScreen")}),(0,a.jsx)(g.A,{variant:"body2",children:w.Ay.translate("CustomSplashScreenSize")}),(0,a.jsxs)(u.A,{component:"label",variant:"outlined",startIcon:(0,a.jsx)(o.A,{}),disabled:!W,children:[(0,a.jsx)("input",{type:"file",accept:"image/*",hidden:!0,onChange:Z}),w.Ay.translate("UploadCustomImage")]}),(0,a.jsx)(u.A,{variant:"outlined",color:"error",startIcon:(0,a.jsx)(s.A,{}),disabled:!W,onClick:Y,children:w.Ay.translate("DeleteCustomImage")})]})]}),(0,a.jsx)(p.A,{fullWidth:!0,multiline:!0,minRows:5,maxRows:5,name:O.LoginDisclaimer,label:w.Ay.translate("LabelLoginDisclaimer"),helperText:w.Ay.translate("LabelLoginDisclaimerHelp"),value:null==F?void 0:F.LoginDisclaimer,onChange:_,slotProps:{input:{className:"textarea-mono"}}}),(0,a.jsx)(p.A,{fullWidth:!0,multiline:!0,minRows:5,maxRows:20,name:O.CustomCss,label:w.Ay.translate("LabelCustomCss"),helperText:w.Ay.translate("LabelCustomCssHelp"),value:null==F?void 0:F.CustomCss,onChange:_,slotProps:{input:{className:"textarea-mono"}}}),(0,a.jsx)(u.A,{type:"submit",size:"large",children:w.Ay.translate("Save")})]})})})})};q.displayName="BrandingPage"},69664:function(e,n,t){var a=t(62540),r=t(12029),i=t(92779),s=t(69856),o=t(90158);t(63696),n.A=function(e){var n=e.isLoading,t=e.alt,l=e.url,c=e.aspectRatio,u=void 0===c?16/9:c,d=e.FallbackIcon,f=void 0===d?r.A:d;return(0,a.jsxs)(s.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",aspectRatio:u,overflow:"hidden"},children:[n&&(0,a.jsx)(o.A,{variant:"rectangular",width:"100%",height:"100%"}),l?(0,a.jsx)("img",{src:l,alt:t,width:"100%"}):(0,a.jsx)(i.A,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(f,{sx:{height:"25%",width:"auto"}})})]})}}}]);