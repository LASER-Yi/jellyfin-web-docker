"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[19199],{1625:function(e,t,n){n.r(t),n.d(t,{Component:function(){return G}});var r=n(62540),a=n(63696),o=n(65242),i=n(87404),l=n(5271),u=n(77890),c=n(58765),s=n(99851),f=n(86074),y=n(34907),d=n(20541),p=n(89809),h=n(84849),v=n(51602),b=n(5898),g=n(15255),A=n(61586),m=n(69410),x=n(71607),T=function(e){var t=(0,m.gf)().api;return(0,A.I)({queryKey:[x.t,e.taskId],queryFn:function(n){var r=n.signal;return function(e,t,n){return r=void 0,a=void 0,i=function(){return function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(r){switch(r.label){case 0:return[4,(0,g.g)(e).getTask(t,n)];case 1:return[2,r.sent().data]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{u(i.next(e))}catch(e){t(e)}}function l(e){try{u(i.throw(e))}catch(e){t(e)}}function u(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,l)}u((i=i.apply(r,a||[])).next())}));var r,a,o,i}(t,e,{signal:r})},enabled:!!t})},j=n(38596),k=n(53678),w=n(57807),O=n(41906),S=n(30177),C=n(31080),I=n(96832),D=[9e9,18e9,27e9,36e9,72e9,108e9,144e9,216e9,288e9,432e9,864e9];function W(e,t){var n=e/1e4,r=new Date;return r.setHours(0,0,0,0),r.setTime(r.getTime()+n),(0,S.A)(r,"p",{locale:t})}function L(e,t){switch(e.Type){case"DailyTrigger":return b.Ay.translate("DailyAt",W(e.TimeOfDayTicks||0,t));case"WeeklyTrigger":return b.Ay.translate("WeeklyAt",function(e,t){if(!e)return"";var n=(0,I.A)(e,"cccc",new Date);return(0,S.A)(n,"cccc",{locale:t})}(e.DayOfWeek,t),W(e.TimeOfDayTicks||0,t));case"IntervalTrigger":return function(e){var t=e/36e9;switch(t){case.25:return b.Ay.translate("EveryXMinutes","15");case.5:return b.Ay.translate("EveryXMinutes","30");case.75:return b.Ay.translate("EveryXMinutes","45");case 1:return b.Ay.translate("EveryHour");default:return b.Ay.translate("EveryXHours",t)}}(e.IntervalTicks||0);case"StartupTrigger":return b.Ay.translate("OnApplicationStartup");default:return e.Type}}var P=function(e){var t=e.cell,n=(0,O.Y)().dateFnsLocale,a=t.getValue(),o=!!a.MaxRuntimeTicks&&a.MaxRuntimeTicks/36e9;return(0,r.jsxs)(l.A,{children:[(0,r.jsx)(s.A,{variant:"body1",children:L(a,n)}),o&&(0,r.jsx)(s.A,{variant:"body2",color:"text.secondary",children:1==o?b.Ay.translate("ValueTimeLimitSingleHour"):b.Ay.translate("ValueTimeLimitMultiHour",o)})]})},M=n(85187),E=n(60545),B=n(48451),F=n(19949),R=n(52974),H=n(11e3),q=n(24034),V=n(14313),N=function(e){var t=e.open,n=e.title,o=e.onClose,i=e.onAdd,l=(0,O.Y)().dateFnsLocale,s=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}((0,a.useState)(q.O.DailyTrigger),2),f=s[0],y=s[1],d=(0,a.useMemo)((function(){return function(e){for(var t=[],n=0;n<864e5;n+=9e5)t.push({name:W(1e4*n,e),value:1e4*n});return t}(l)}),[l]),p=(0,a.useMemo)((function(){return function(e){var t,n,r=[];try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(D),o=a.next();!o.done;o=a.next()){var i=o.value,l=Math.floor(i/1e4),u=l<36e5?"minute":"hour";r.push({name:(0,C.A)(0,l,{locale:e,unit:u}),value:i})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}(l)}),[l]),h=(0,a.useCallback)((function(e){y(e.target.value)}),[]),v=(0,a.useCallback)((function(e){e.preventDefault();var t=new FormData(e.currentTarget),n=Object.fromEntries(t.entries()),r={Type:n.TriggerType.toString()};r.Type==q.O.WeeklyTrigger&&(r.DayOfWeek=n.DayOfWeek.toString()),r.Type!=q.O.DailyTrigger&&r.Type!=q.O.WeeklyTrigger||(r.TimeOfDayTicks=parseInt(n.TimeOfDay.toString(),10)),r.Type==q.O.IntervalTrigger&&(r.IntervalTicks=parseInt(n.Interval.toString(),10)),n.TimeLimit.toString()&&(r.MaxRuntimeTicks=36e9*parseFloat(n.TimeLimit.toString())),i&&i(r)}),[i]);return(0,r.jsxs)(M.A,{open:t,maxWidth:"xs",fullWidth:!0,onClose:o,PaperProps:{component:"form",onSubmit:v},children:[(0,r.jsx)(F.A,{children:n}),(0,r.jsx)(B.A,{children:(0,r.jsxs)(c.A,{spacing:3,children:[(0,r.jsxs)(H.A,{name:"TriggerType",select:!0,fullWidth:!0,value:f,onChange:h,label:b.Ay.translate("LabelTriggerType"),children:[(0,r.jsx)(R.A,{value:q.O.DailyTrigger,children:b.Ay.translate("OptionDaily")}),(0,r.jsx)(R.A,{value:q.O.WeeklyTrigger,children:b.Ay.translate("OptionWeekly")}),(0,r.jsx)(R.A,{value:q.O.IntervalTrigger,children:b.Ay.translate("OptionOnInterval")}),(0,r.jsx)(R.A,{value:q.O.StartupTrigger,children:b.Ay.translate("OnApplicationStartup")})]}),f==q.O.WeeklyTrigger&&(0,r.jsxs)(H.A,{name:"DayOfWeek",select:!0,fullWidth:!0,defaultValue:V.o.Sunday,label:b.Ay.translate("LabelDay"),children:[(0,r.jsx)(R.A,{value:V.o.Sunday,children:b.Ay.translate("Sunday")}),(0,r.jsx)(R.A,{value:V.o.Monday,children:b.Ay.translate("Monday")}),(0,r.jsx)(R.A,{value:V.o.Tuesday,children:b.Ay.translate("Tuesday")}),(0,r.jsx)(R.A,{value:V.o.Wednesday,children:b.Ay.translate("Wednesday")}),(0,r.jsx)(R.A,{value:V.o.Thursday,children:b.Ay.translate("Thursday")}),(0,r.jsx)(R.A,{value:V.o.Friday,children:b.Ay.translate("Friday")}),(0,r.jsx)(R.A,{value:V.o.Saturday,children:b.Ay.translate("Saturday")})]}),(f==q.O.DailyTrigger||f==q.O.WeeklyTrigger)&&(0,r.jsx)(H.A,{name:"TimeOfDay",select:!0,fullWidth:!0,defaultValue:"0",label:b.Ay.translate("LabelTime"),children:d.map((function(e){return(0,r.jsx)(R.A,{value:e.value,children:e.name},e.value)}))}),f==q.O.IntervalTrigger&&(0,r.jsx)(H.A,{name:"Interval",select:!0,fullWidth:!0,defaultValue:p[0].value,label:b.Ay.translate("LabelEveryXMinutes"),children:p.map((function(e){return(0,r.jsx)(R.A,{value:e.value,children:e.name},e.value)}))}),(0,r.jsx)(H.A,{name:"TimeLimit",fullWidth:!0,defaultValue:"",type:"number",inputProps:{min:1,step:.5},label:b.Ay.translate("LabelTimeLimitHours")})]})}),(0,r.jsxs)(E.A,{children:[(0,r.jsx)(u.A,{onClick:o,color:"error",children:b.Ay.translate("ButtonCancel")}),(0,r.jsx)(u.A,{type:"submit",children:b.Ay.translate("Add")})]})]})},X=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i},_=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,o=t.length;a<o;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},G=function(){var e,t=(0,i.g)().id,n=(e=(0,m.gf)().api,(0,j.n)({mutationFn:function(t){return(0,g.g)(e).updateTask(t)},onSuccess:function(e,t){k.q.invalidateQueries({queryKey:[x.t,t.taskId]})}})),A=T({taskId:t||""}),O=A.data,S=A.isLoading,C=X((0,a.useState)(!1),2),I=C[0],D=C[1],W=X((0,a.useState)(!1),2),L=W[0],M=W[1],E=X((0,a.useState)(null),2),B=E[0],F=E[1],R=(0,a.useCallback)((function(){F(null),M(!1)}),[]),H=(0,a.useCallback)((function(e){e&&(F(e),M(!0))}),[]),q=(0,a.useCallback)((function(){var e,t=null===(e=null==O?void 0:O.Triggers)||void 0===e?void 0:e.filter((function(e){return e!=B}));(null==O?void 0:O.Id)&&t&&(n.mutate({taskId:O.Id,taskTriggerInfo:t}),M(!1))}),[O,B,n]),V=(0,a.useCallback)((function(){D(!0)}),[]),G=(0,a.useCallback)((function(){D(!1)}),[]),K=(0,a.useCallback)((function(e){if((null==O?void 0:O.Triggers)&&(null==O?void 0:O.Id)){var t=_(_([],X(O.Triggers),!1),[e],!1);n.mutate({taskId:O.Id,taskTriggerInfo:t}),D(!1)}}),[O,n]),Q=(0,a.useMemo)((function(){return[{id:"TriggerTime",accessorFn:function(e){return e},Cell:P,header:b.Ay.translate("LabelTime")}]}),[]),Y=(0,v.Up)({columns:Q,data:(null==O?void 0:O.Triggers)||[],enableSorting:!1,enableFilters:!1,enableColumnActions:!1,enablePagination:!1,state:{isLoading:S},muiTableContainerProps:{sx:{maxHeight:"calc(100% - 7rem)"}},enableRowActions:!0,positionActionsColumn:"last",displayColumnDefOptions:{"mrt-row-actions":{header:""}},renderRowActions:function(e){var t=e.row;return(0,r.jsx)(l.A,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,r.jsx)(d.A,{disableInteractive:!0,title:b.Ay.translate("ButtonRemove"),children:(0,r.jsx)(y.A,{color:"error",onClick:function(){return H(t.original)},children:(0,r.jsx)(p.A,{})})})})}});return S||!O?(0,r.jsx)(h.A,{}):(0,r.jsxs)(o.A,{id:"scheduledTaskPage",className:"mainAnimatedPage type-interior",children:[(0,r.jsx)(w.A,{open:L,title:b.Ay.translate("HeaderDeleteTaskTrigger"),text:b.Ay.translate("MessageDeleteTaskTrigger"),onCancel:R,onConfirm:q,confirmButtonColor:"error",confirmButtonText:b.Ay.translate("ButtonRemove")}),(0,r.jsx)(N,{open:I,title:b.Ay.translate("ButtonAddScheduledTaskTrigger"),onClose:G,onAdd:K}),(0,r.jsx)(l.A,{className:"content-primary",children:(0,r.jsx)(l.A,{className:"readOnlyContent",children:(0,r.jsxs)(c.A,{spacing:2,children:[(0,r.jsx)(s.A,{variant:"h2",children:O.Name}),(0,r.jsx)(s.A,{variant:"body1",children:O.Description}),(0,r.jsx)(u.A,{sx:{alignSelf:"flex-start"},startIcon:(0,r.jsx)(f.A,{}),onClick:V,children:b.Ay.translate("ButtonAddScheduledTaskTrigger")}),(0,r.jsx)(v.Zs,{table:Y})]})})})]})};G.displayName="TaskPage"},41906:function(e,t,n){n.d(t,{Y:function(){return f}});var r=n(62864),a=n(63696),o=n(5898),i=n(93721),l=n(28626),u=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{u(r.next(e))}catch(e){o(e)}}function l(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,l)}u((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},s=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)i.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i};function f(){var e=this,t=(0,l.Q)(),n=t.dateTimeLocale,f=t.language,y=s((0,a.useState)(r.A),2),d=y[0],p=y[1],h=(0,a.useMemo)((function(){return(0,o.Tl)(f||(0,o.i5)())}),[f]),v=(0,a.useMemo)((function(){return n?(0,o.Tl)(n):h}),[n,h]);return(0,a.useEffect)((function(){u(e,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,i.Fq)((0,i.QC)(v))];case 1:return e=n.sent(),p(e),[3,3];case 2:return t=n.sent(),console.warn("[useLocale] failed to fetch dateFns locale",t),[3,3];case 3:return[2]}}))}))}),[v]),{locale:h,dateTimeLocale:v,dateFnsLocale:d}}},50171:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(91576);function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.A)(e,t)}},57807:function(e,t,n){var r=n(62540),a=n(77890),o=n(85187),i=n(60545),l=n(48451),u=n(47997),c=n(19949),s=(n(63696),n(5898)),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},f.apply(this,arguments)};t.A=function(e){var t=e.confirmButtonColor,n=void 0===t?"primary":t,y=e.confirmButtonText,d=e.title,p=e.text,h=e.onCancel,v=e.onConfirm,b=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["confirmButtonColor","confirmButtonText","title","text","onCancel","onConfirm"]);return(0,r.jsxs)(o.A,f({onClose:h},b,{children:[(0,r.jsx)(c.A,{children:d}),(0,r.jsx)(l.A,{children:(0,r.jsx)(u.A,{children:p})}),(0,r.jsxs)(i.A,{children:[(0,r.jsx)(a.A,{variant:"text",onClick:h,children:s.Ay.translate("ButtonCancel")}),(0,r.jsx)(a.A,{color:n,onClick:v,children:y||s.Ay.translate("ButtonOk")})]})]}))}},69799:function(e,t,n){function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}n.d(t,{A:function(){return l}});var o=n(40694),i=n(72367);function l(e){var t=a();return function(){var n,a=r(e);if(t){var l=r(this).constructor;n=Reflect.construct(a,arguments,l)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"==(0,o.A)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.A)(e)}(this,n)}}},70167:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(16438);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.A)(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){u=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(u)throw i}}}}},71607:function(e,t,n){n.d(t,{s:function(){return l},t:function(){return i}});var r=n(15255),a=n(61586),o=n(69410),i="Tasks",l=function(e){var t=(0,o.gf)().api;return(0,a.I)({queryKey:[i],queryFn:function(n){var a=n.signal;return function(e,t,n){return a=void 0,o=void 0,l=function(){return function(e,t){var n,r,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,r=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}(this,(function(a){switch(a.label){case 0:return[4,(0,r.g)(e).getTasks(t,n)];case 1:return[2,a.sent().data]}}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{u(l.next(e))}catch(e){t(e)}}function r(e){try{u(l.throw(e))}catch(e){t(e)}}function u(t){var a;t.done?e(t.value):(a=t.value,a instanceof i?a:new i((function(e){e(a)}))).then(n,r)}u((l=l.apply(a,o||[])).next())}));var a,o,i,l}(t,e,{signal:a})},enabled:!!t})}}}]);