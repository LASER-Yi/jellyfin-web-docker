"use strict";function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var Module=function(){return function(e){var t;e.ready=new Promise((function(e,r){t=e}));var r,n,a,o,i,s,u,l,c,f,d,p,h,y=null;function v(e){throw e}function g(){var e=p.buffer;o=new Int8Array(e),i=new Int16Array(e),s=new Int32Array(e),u=new Uint8Array(e),l=new Uint16Array(e),c=new Uint32Array(e),f=new Float32Array(e),d=new Float64Array(e)}if(r=function(e){"JASSUB: No usable fontconfig configuration file found, using fallback."===e?console.debug(e):console.log(e)},n=function(e){"Fontconfig error: Cannot load default config file: No such file: (null)"===e?console.debug(e):console.error(e)},a=g,g=function(){a(),self.wasmMemory=p,self.HEAPU8C=new Uint8ClampedArray(p.buffer),self.HEAPU8=new Uint8Array(p.buffer)},p=new WebAssembly.Memory({initial:256,maximum:32768}),g(),(!Math.imul||-5!==Math.imul(4294967295,5))&&(Math.imul=function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16)*n+r*(t>>>16)<<16)|0}),!Math.fround){var m=new Float32Array(1);Math.fround=function(e){return m[0]=e,m[0]}}Math.clz32||(Math.clz32=function(e){var t=32,r=e>>16;return r&&(t-=16,e=r),(r=e>>8)&&(t-=8,e=r),(r=e>>4)&&(t-=4,e=r),(r=e>>2)&&(t-=2,e=r),(r=e>>1)?t-2:t-e}),Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)});var b=("undefined"==typeof TextDecoder?"undefined":_typeof(TextDecoder))<"u"?new TextDecoder("utf8"):void 0;function C(e,t,r){for(var n=t+r,a=t;e[a]&&!(a>=n);)++a;if(a-t>16&&e.buffer&&b)return b.decode(e.subarray(t,a));for(var o="";t<a;){var i=e[t++];if(128&i){var s=63&e[t++];if(192!=(224&i)){var u=63&e[t++];if((i=224==(240&i)?(15&i)<<12|s<<6|u:(7&i)<<18|s<<12|u<<6|63&e[t++])<65536)o+=String.fromCharCode(i);else{var l=i-65536;o+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else o+=String.fromCharCode((31&i)<<6|s)}else o+=String.fromCharCode(i)}return o}function w(e,t){return e?C(u,e,t):""}function T(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var A=void 0;function $(e){for(var t="",r=e;u[r];)t+=A[u[r++]];return t}var P={},S={},j={},O=48,F=57;function _(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=O&&t<=F?"_"+e:e}function M(e,t){var r={};return(r[e=_(e)]=function(){return t.apply(this,arguments)},r)[e]}function I(e,t){var r=M(t,(function(e){this.name=t,this.message=e;var r=new Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var W=void 0;function k(e){throw new W(e)}var x=void 0;function E(e){throw new x(e)}function R(e,t,r){function n(t){var n=r(t);n.length!==e.length&&E("Mismatched type converter count");for(var a=0;a<e.length;++a)U(e[a],n[a])}e.forEach((function(e){j[e]=t}));var a=new Array(t.length),o=[],i=0;t.forEach((function(e,t){S.hasOwnProperty(e)?a[t]=S[e]:(o.push(e),P.hasOwnProperty(e)||(P[e]=[]),P[e].push((function(){a[t]=S[e],++i===o.length&&n(a)})))})),0===o.length&&n(a)}function U(e,t,r){if(r=void 0===r?{}:r,!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=t.name;if(e||k('type "'+n+'" must have a positive integer typeid pointer'),S.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;k("Cannot register type '"+n+"' twice")}if(S[e]=t,delete j[e],P.hasOwnProperty(e)){var a=P[e];delete P[e],a.forEach((function(e){return e()}))}}function D(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function B(e){k(e.$$.ptrType.registeredClass.name+" instance already deleted")}var L=!1;function H(e){}function V(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)}function z(e,t,r){if(t===r)return e;if(void 0===r.baseClass)return null;var n=z(e,t,r.baseClass);return null===n?null:r.downcast(n)}var N={};var G=[];function J(){for(;G.length;){var e=G.pop();e.$$.deleteScheduled=!1,e.delete()}}var q=void 0;var K={};function Y(e,t){return(!t.ptrType||!t.ptr)&&E("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&E("Both smartPtrType and smartPtr must be specified"),t.count={value:1},X(Object.create(e,{$$:{value:t}}))}function X(e){return("undefined"==typeof FinalizationRegistry?"undefined":_typeof(FinalizationRegistry))>"u"?(X=function(e){return e},e):(L=new FinalizationRegistry((function(e){V(e.$$)})),H=function(e){return L.unregister(e)},(X=function(e){var t=e.$$;if(t.smartPtr){var r={$$:t};L.register(e,r,e)}return e})(e))}function Z(){}function Q(e,t,r){if(void 0===e[t].overloadTable){var n=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||k("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[n.argCount]=n}}function ee(e,t,r,n,a,o,i,s){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=n,this.baseClass=a,this.getActualType=o,this.upcast=i,this.downcast=s,this.pureVirtualFunctions=[]}function te(e,t,r){for(;t!==r;)t.upcast||k("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function re(e,t){if(null===t)return this.isReference&&k("null is not a valid "+this.name),0;t.$$||k('Cannot pass "'+be(t)+'" as a '+this.name),t.$$.ptr||k("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass;return te(t.$$.ptr,r,this.registeredClass)}function ne(e,t){var r;if(null===t)return this.isReference&&k("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,r),r):0;t.$$||k('Cannot pass "'+be(t)+'" as a '+this.name),t.$$.ptr||k("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&k("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var n=t.$$.ptrType.registeredClass;if(r=te(t.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&k("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:k("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var a=t.clone();r=this.rawShare(r,me.toHandle((function(){a.delete()}))),null!==e&&e.push(this.rawDestructor,r)}break;default:k("Unsupporting sharing policy")}return r}function ae(e,t){if(null===t)return this.isReference&&k("null is not a valid "+this.name),0;t.$$||k('Cannot pass "'+be(t)+'" as a '+this.name),t.$$.ptr||k("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&k("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass;return te(t.$$.ptr,r,this.registeredClass)}function oe(e){return this.fromWireType(s[e>>2])}function ie(e,t,r,n,a,o,i,s,u,l,c){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=n,this.isSmartPointer=a,this.pointeeType=o,this.sharingPolicy=i,this.rawGetPointee=s,this.rawConstructor=u,this.rawShare=l,this.rawDestructor=c,a||void 0!==t.baseClass?this.toWireType=ne:n?(this.toWireType=re,this.destructorFunction=null):(this.toWireType=ae,this.destructorFunction=null)}var se=[];function ue(e){var t=se[e];return t||(e>=se.length&&(se.length=e+1),se[e]=t=h.get(e)),t}function le(e,t){var r=(e=$(e)).includes("j")?function(e,t){var r=[];return function(){return r.length=0,Object.assign(r,arguments),function(e,t,r){return e.includes("j")?function(e,t,r){var n=dynCalls[e];return r&&r.length?n.apply(null,[t].concat(r)):n.call(null,t)}(e,t,r):ue(t).apply(null,r)}(e,t,r)}}(e,t):ue(t);return"function"!=typeof r&&k("unknown function pointer with signature "+e+": "+t),r}var ce=void 0;function fe(e){var t=Ue(e),r=$(t);return Re(t),r}function de(e,t){var r=[],n={};throw t.forEach((function e(t){if(!n[t]&&!S[t]){if(j[t])return void j[t].forEach(e);r.push(t),n[t]=!0}})),new ce(e+": "+r.map(fe).join([", "]))}function pe(e,t){for(var r=[],n=0;n<e;n++)r.push(c[t+4*n>>2]);return r}function he(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function ye(e,t,r,n,a,o){var i=t.length;i<2&&k("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var s=null!==t[1]&&null!==r,u=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){u=!0;break}var c="void"!==t[0].name,f="",d="";for(l=0;l<i-2;++l)f+=(0!==l?", ":"")+"arg"+l,d+=(0!==l?", ":"")+"arg"+l+"Wired";var p="\n        return function "+_(e)+"("+f+") {\n        if (arguments.length !== "+(i-2)+") {\n          throwBindingError('function "+e+" called with "+arguments.length+" arguments, expected "+(i-2)+" args!');\n        }";u&&(p+="var destructors = [];\n");var h=u?"destructors":"null",y=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],v=[k,n,a,he,t[0],t[1]];for(s&&(p+="var thisWired = classParam.toWireType("+h+", this);\n"),l=0;l<i-2;++l)p+="var arg"+l+"Wired = argType"+l+".toWireType("+h+", arg"+l+"); // "+t[l+2].name+"\n",y.push("argType"+l),v.push(t[l+2]);if(s&&(d="thisWired"+(d.length>0?", ":"")+d),p+=(c||o?"var rv = ":"")+"invoker(fn"+(d.length>0?", ":"")+d+");\n",u)p+="runDestructors(destructors);\n";else for(l=s?1:2;l<t.length;++l){var g=1===l?"thisWired":"arg"+(l-2)+"Wired";null!==t[l].destructorFunction&&(p+=g+"_dtor("+g+"); // "+t[l].name+"\n",y.push(g+"_dtor"),v.push(t[l].destructorFunction))}return c&&(p+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),p+="}\n",y.push(p),function(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+_typeof(e)+" which is not a function");var r=M(e.name||"unknownFunctionName",(function(){}));r.prototype=e.prototype;var n=new r,a=e.apply(n,t);return a instanceof Object?a:n}(Function,y).apply(null,v)}function ve(e,t,r){return e instanceof Object||k(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||k(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||k("cannot call emscripten binding method "+r+" on deleted object"),te(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}var ge=new function(){this.allocated=[void 0],this.freelist=[],this.get=function(e){return this.allocated[e]},this.has=function(e){return void 0!==this.allocated[e]},this.allocate=function(e){var t=this.freelist.pop()||this.allocated.length;return this.allocated[t]=e,t},this.free=function(e){this.allocated[e]=void 0,this.freelist.push(e)}};var me={toValue:function(e){return e||k("Cannot use deleted val. handle = "+e),ge.get(e).value},toHandle:function(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return ge.allocate({refcount:1,value:e})}}};function be(e){if(null===e)return"null";var t=_typeof(e);return"object"===t||"array"===t||"function"===t?e.toString():""+e}function Ce(e,t){switch(t){case 2:return function(e){return this.fromWireType(f[e>>2])};case 3:return function(e){return this.fromWireType(d[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function we(e,t,r){switch(t){case 0:return r?function(e){return o[e]}:function(e){return u[e]};case 1:return r?function(e){return i[e>>1]}:function(e){return l[e>>1]};case 2:return r?function(e){return s[e>>2]}:function(e){return c[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var Te,Ae=("undefined"==typeof TextDecoder?"undefined":_typeof(TextDecoder))<"u"?new TextDecoder("utf-16le"):void 0;function $e(e,t){for(var r=e,n=r>>1,a=n+t/2;!(n>=a)&&l[n];)++n;if((r=n<<1)-e>32&&Ae)return Ae.decode(u.subarray(e,r));for(var o="",s=0;!(s>=t/2);++s){var c=i[e+2*s>>1];if(0==c)break;o+=String.fromCharCode(c)}return o}function Pe(e,t,r){if(void 0===r&&(r=2147483647),r<2)return 0;for(var n=t,a=(r-=2)<2*e.length?r/2:e.length,o=0;o<a;++o){var s=e.charCodeAt(o);i[t>>1]=s,t+=2}return i[t>>1]=0,t-n}function Se(e){return 2*e.length}function je(e,t){for(var r=0,n="";!(r>=t/4);){var a=s[e+4*r>>2];if(0==a)break;if(++r,a>=65536){var o=a-65536;n+=String.fromCharCode(55296|o>>10,56320|1023&o)}else n+=String.fromCharCode(a)}return n}function Oe(e,t,r){if(void 0===r&&(r=2147483647),r<4)return 0;for(var n=t,a=n+r-4,o=0;o<e.length;++o){var i=e.charCodeAt(o);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),s[t>>2]=i,(t+=4)+4>a)break}return s[t>>2]=0,t-n}function Fe(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=55296&&n<=57343&&++r,t+=4}return t}function _e(e){var t=p.buffer;try{return p.grow(e-t.byteLength+65535>>>16),g(),1}catch(e){}}Te=("undefined"==typeof performance?"undefined":_typeof(performance))<"u"&&performance.now?function(){return performance.now()}:Date.now;var Me={};function Ie(){if(!Ie.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"==typeof navigator?"undefined":_typeof(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(var t in Me)void 0===Me[t]?delete e[t]:e[t]=Me[t];var r=[];for(var t in e)r.push(t+"="+e[t]);Ie.strings=r}return Ie.strings}var We=[null,[],[]];function ke(e,t){var a=We[e];0===t||10===t?((1===e?r:n)(C(a,0)),a.length=0):a.push(t)}(function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);A=e})(),W=e.BindingError=I(Error,"BindingError"),x=e.InternalError=I(Error,"InternalError"),Z.prototype.isAliasOf=function(e){if(!(this instanceof Z&&e instanceof Z))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,n=e.$$.ptrType.registeredClass,a=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;n.baseClass;)a=n.upcast(a),n=n.baseClass;return t===n&&r===a},Z.prototype.clone=function(){if(this.$$.ptr||B(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=X(Object.create(Object.getPrototypeOf(this),{$$:{value:D(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e},Z.prototype.delete=function(){this.$$.ptr||B(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&k("Object already scheduled for deletion"),H(this),V(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},Z.prototype.isDeleted=function(){return!this.$$.ptr},Z.prototype.deleteLater=function(){return this.$$.ptr||B(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&k("Object already scheduled for deletion"),G.push(this),1===G.length&&q&&q(J),this.$$.deleteScheduled=!0,this},e.getInheritedInstanceCount=function(){return Object.keys(K).length},e.getLiveInheritedInstances=function(){var e=[];for(var t in K)K.hasOwnProperty(t)&&e.push(K[t]);return e},e.flushPendingDeletes=J,e.setDelayFunction=function(e){q=e,G.length&&q&&q(J)},ie.prototype.getPointee=function(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},ie.prototype.destructor=function(e){this.rawDestructor&&this.rawDestructor(e)},ie.prototype.argPackAdvance=8,ie.prototype.readValueFromPointer=oe,ie.prototype.deleteObject=function(e){null!==e&&e.delete()},ie.prototype.fromWireType=function(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=function(e,t){return t=function(e,t){for(void 0===t&&k("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}(e,t),K[t]}(this.registeredClass,t);if(void 0!==r){if(0===r.$$.count.value)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var n=r.clone();return this.destructor(e),n}function a(){return this.isSmartPointer?Y(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Y(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var o,i=this.registeredClass.getActualType(t),s=N[i];if(!s)return a.call(this);o=this.isConst?s.constPointerType:s.pointerType;var u=z(t,this.registeredClass,o.registeredClass);return null===u?a.call(this):this.isSmartPointer?Y(o.registeredClass.instancePrototype,{ptrType:o,ptr:u,smartPtrType:this,smartPtr:e}):Y(o.registeredClass.instancePrototype,{ptrType:o,ptr:u})},ce=e.UnboundTypeError=I(Error,"UnboundTypeError"),ge.allocated.push({value:void 0},{value:null},{value:!0},{value:!1}),ge.reserved=ge.allocated.length,e.count_emval_handles=function(){for(var e=0,t=ge.reserved;t<ge.allocated.length;++t)void 0!==ge.allocated[t]&&++e;return e};var xe={b:function(e,t,r,n){v("Assertion failed: "+w(e)+", at: "+[t?w(t):"unknown filename",r,n?w(n):"unknown function"])},k:function(e,t,r){return 0},I:function(e,t){},B:function(e,t,r){},K:function(e,t,r){return 0},G:function(e,t,r,n){},n:function(e,t,r,n){},H:function(e,t){},u:function(e,t,r,n,a){},r:function(e,t,r,n,a){var u=T(r);U(e,{name:t=$(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?n:a},argPackAdvance:8,readValueFromPointer:function(e){var n;if(1===r)n=o;else if(2===r)n=i;else{if(4!==r)throw new TypeError("Unknown boolean type size: "+t);n=s}return this.fromWireType(n[e>>u])},destructorFunction:null})},j:function(t,r,n,a,o,i,s,u,l,c,f,d,p){f=$(f),i=le(o,i),u&&(u=le(s,u)),c&&(c=le(l,c)),p=le(d,p);var h=_(f);(function(t,r,n){e.hasOwnProperty(t)?(k("Cannot register public name '"+t+"' twice"),Q(e,t,t),e.hasOwnProperty(n)&&k("Cannot register multiple overloads of a function with the same number of arguments ("+n+")!"),e[t].overloadTable[n]=r):e[t]=r})(h,(function(){de("Cannot construct "+f+" due to unbound types",[a])})),R([t,r,n],a?[a]:[],(function(r){var n,o;r=r[0],o=a?(n=r.registeredClass).instancePrototype:Z.prototype;var s=M(h,(function(){if(Object.getPrototypeOf(this)!==l)throw new W("Use 'new' to construct "+f);if(void 0===d.constructor_body)throw new W(f+" has no accessible constructor");var e=d.constructor_body[arguments.length];if(void 0===e)throw new W("Tried to invoke ctor of "+f+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(d.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),l=Object.create(o,{constructor:{value:s}});s.prototype=l;var d=new ee(f,s,l,p,n,i,u,c);d.baseClass&&(void 0===d.baseClass.__derivedClasses&&(d.baseClass.__derivedClasses=[]),d.baseClass.__derivedClasses.push(d));var y=new ie(f,d,!0,!1,!1),v=new ie(f+"*",d,!1,!1,!1),g=new ie(f+" const*",d,!1,!0,!1);return N[t]={pointerType:v,constPointerType:g},function(t,r,n){e.hasOwnProperty(t)||E("Replacing nonexistant public symbol"),e[t].overloadTable,e[t]=r,e[t].argCount=n}(h,s),[y,v,g]}))},A:function(e,t,r,n,a,o){!function(e,t){if(!e)throw void 0}(t>0);var i=pe(t,r);a=le(n,a),R([],[e],(function(e){var r="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new W("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[t-1]=function(){de("Cannot construct "+e.name+" due to unbound types",i)},R([],i,(function(n){return n.splice(1,0,null),e.registeredClass.constructor_body[t-1]=ye(r,n,null,a,o),[]})),[]}))},d:function(e,t,r,n,a,o,i,s,u){var l=pe(r,n);t=$(t),o=le(a,o),R([],[e],(function(e){var n=(e=e[0]).name+"."+t;function a(){de("Cannot call "+n+" due to unbound types",l)}t.startsWith("@@")&&(t=Symbol[t.substring(2)]),s&&e.registeredClass.pureVirtualFunctions.push(t);var c=e.registeredClass.instancePrototype,f=c[t];return void 0===f||void 0===f.overloadTable&&f.className!==e.name&&f.argCount===r-2?(a.argCount=r-2,a.className=e.name,c[t]=a):(Q(c,t,n),c[t].overloadTable[r-2]=a),R([],l,(function(a){var s=ye(n,a,e,o,i,u);return void 0===c[t].overloadTable?(s.argCount=r-2,c[t]=s):c[t].overloadTable[r-2]=s,[]})),[]}))},c:function(e,t,r,n,a,o,i,s,u,l){t=$(t),a=le(n,a),R([],[e],(function(e){var n=(e=e[0]).name+"."+t,c={get:function(){de("Cannot access "+n+" due to unbound types",[r,i])},enumerable:!0,configurable:!0};return c.set=u?function(){de("Cannot access "+n+" due to unbound types",[r,i])}:function(e){k(n+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,t,c),R([],u?[r,i]:[r],(function(r){var i=r[0],c={get:function(){var t=ve(this,e,n+" getter");return i.fromWireType(a(o,t))},enumerable:!0};if(u){u=le(s,u);var f=r[1];c.set=function(t){var r=ve(this,e,n+" setter"),a=[];u(l,r,f.toWireType(a,t)),he(a)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,c),[]})),[]}))},L:function(e,t){U(e,{name:t=$(t),fromWireType:function(e){var t=me.toValue(e);return function(e){e>=ge.reserved&&0==--ge.get(e).refcount&&ge.free(e)}(e),t},toWireType:function(e,t){return me.toHandle(t)},argPackAdvance:8,readValueFromPointer:oe,destructorFunction:null})},p:function(e,t,r){var n=T(r);U(e,{name:t=$(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:Ce(t,n),destructorFunction:null})},g:function(e,t,r,n,a){t=$(t);var o=T(r),i=function(e){return e};if(0===n){var s=32-8*r;i=function(e){return e<<s>>>s}}var u=t.includes("unsigned");U(e,{name:t,fromWireType:i,toWireType:u?function(e,t){return this.name,t>>>0}:function(e,t){return this.name,t},argPackAdvance:8,readValueFromPointer:we(t,o,0!==n),destructorFunction:null})},e:function(e,t,r){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function a(e){var t=c,r=t[e>>=2],a=t[e+1];return new n(t.buffer,a,r)}U(e,{name:r=$(r),fromWireType:a,argPackAdvance:8,readValueFromPointer:a},{ignoreDuplicateRegistrations:!0})},q:function(e,t){var r="std::string"===(t=$(t));U(e,{name:t,fromWireType:function(e){var t,n=c[e>>2],a=e+4;if(r)for(var o=a,i=0;i<=n;++i){var s=a+i;if(i==n||0==u[s]){var l=w(o,s-o);void 0===t?t=l:(t+=String.fromCharCode(0),t+=l),o=s+1}}else{var f=new Array(n);for(i=0;i<n;++i)f[i]=String.fromCharCode(u[a+i]);t=f.join("")}return Re(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var n,a="string"==typeof t;a||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||k("Cannot pass non-string to std::string"),n=r&&a?function(e){for(var t=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n<=127?t++:n<=2047?t+=2:n>=55296&&n<=57343?(t+=4,++r):t+=3}return t}(t):t.length;var o=Ee(4+n+1),i=o+4;if(c[o>>2]=n,r&&a)!function(e,t,r){!function(e,t,r,n){if(!(n>0))return 0;for(var a=r+n-1,o=0;o<e.length;++o){var i=e.charCodeAt(o);if(i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),i<=127){if(r>=a)break;t[r++]=i}else if(i<=2047){if(r+1>=a)break;t[r++]=192|i>>6,t[r++]=128|63&i}else if(i<=65535){if(r+2>=a)break;t[r++]=224|i>>12,t[r++]=128|i>>6&63,t[r++]=128|63&i}else{if(r+3>=a)break;t[r++]=240|i>>18,t[r++]=128|i>>12&63,t[r++]=128|i>>6&63,t[r++]=128|63&i}}t[r]=0}(e,u,t,r)}(t,i,n+1);else if(a)for(var s=0;s<n;++s){var l=t.charCodeAt(s);l>255&&(Re(i),k("String has UTF-16 code units that do not fit in 8 bits")),u[i+s]=l}else for(s=0;s<n;++s)u[i+s]=t[s];return null!==e&&e.push(Re,o),o},argPackAdvance:8,readValueFromPointer:oe,destructorFunction:function(e){Re(e)}})},l:function(e,t,r){var n,a,o,i,s;r=$(r),2===t?(n=$e,a=Pe,i=Se,o=function(){return l},s=1):4===t&&(n=je,a=Oe,i=Fe,o=function(){return c},s=2),U(e,{name:r,fromWireType:function(e){for(var r,a=c[e>>2],i=o(),u=e+4,l=0;l<=a;++l){var f=e+4+l*t;if(l==a||0==i[f>>s]){var d=n(u,f-u);void 0===r?r=d:(r+=String.fromCharCode(0),r+=d),u=f+t}}return Re(e),r},toWireType:function(e,n){"string"!=typeof n&&k("Cannot pass non-string to C++ string type "+r);var o=i(n),u=Ee(4+o+t);return c[u>>2]=o>>s,a(n,u+4,o+t),null!==e&&e.push(Re,u),u},argPackAdvance:8,readValueFromPointer:oe,destructorFunction:function(e){Re(e)}})},s:function(e,t){U(e,{isVoid:!0,name:t=$(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},y:function(){throw 1/0},C:function(e,t,r,n,a,o,i){return-52},D:function(e,t,r,n,a,o){},f:function(){v("")},m:Te,z:function(e){var t,r=u.length,n=2147483648;if((e>>>=0)>n)return!1;for(var a=1;a<=4;a*=2){var o=r*(1+.2/a);if(o=Math.min(o,e+100663296),_e(Math.min(n,(t=Math.max(e,o))+(65536-t%65536)%65536)))return!0}return!1},E:function(e,t){var r=0;return Ie().forEach((function(n,a){var i=t+r;c[e+4*a>>2]=i,function(e,t){for(var r=0;r<e.length;++r)o[t++>>0]=e.charCodeAt(r);o[t>>0]=0}(n,i),r+=n.length+1})),0},F:function(e,t){var r=Ie();c[e>>2]=r.length;var n=0;return r.forEach((function(e){n+=e.length+1})),c[t>>2]=n,0},h:function(e){throw"exit("+e+")"},i:function(e){return 52},o:function(e,t,r,n){return 52},t:function(e,t,r,n,a){return 70},J:function(e,t,r,n){for(var a=0,o=0;o<r;o++){var i=c[t>>2],s=c[t+4>>2];t+=8;for(var l=0;l<s;l++)ke(e,u[i+l]);a+=s}return c[n>>2]=a,0},x:function(e,t,r){var n=He();try{return ue(e)(t,r)}catch(e){if(Ve(n),e!==e+0)throw e;De(1,0)}},v:function(e,t,r,n){var a=He();try{return ue(e)(t,r,n)}catch(e){if(Ve(a),e!==e+0)throw e;De(1,0)}},w:function(e,t,r,n,a){var o=He();try{return ue(e)(t,r,n,a)}catch(e){if(Ve(o),e!==e+0)throw e;De(1,0)}},a:p};e.getTempRet0=Le,e.setTempRet0=Be;var Ee,Re,Ue,De,Be,Le,He,Ve,ze={a:xe};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(fetch("jassub-worker-modern.wasm"),ze):WebAssembly.instantiate(e.wasm,ze)).then((function(r){y=(r.instance||r).exports,e._malloc=Ee=y.N,Re=y.O,Ue=y.P,e.__embind_initialize_bindings=y.Q,De=y.S,Be=y.T,Le=y.U,He=y.V,Ve=y.W,y.X,y.Y,y.Z,y._,h=y.R,function(e){e.M()}(y),t(e)})),e.ready}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})};function toAbsoluteIndex(e,t){var r=e>>0;return r<0?Math.max(r+t,0):Math.min(r,t)}if(String.prototype.startsWith||(String.prototype.startsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.substring(t,e.length)===e}),String.prototype.includes||(String.prototype.includes=function(e,t){return-1!==this.indexOf(e,t)}),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(e,t){return new Uint8Array(this.subarray(e,t))}),Uint8Array.prototype.fill||(Int8Array.prototype.fill=Int16Array.prototype.fill=Int32Array.prototype.fill=Uint8Array.prototype.fill=Uint16Array.prototype.fill=Uint32Array.prototype.fill=Float32Array.prototype.fill=Float64Array.prototype.fill=Array.prototype.fill=function(e){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),r=t.length>>>0,n=arguments.length,a=toAbsoluteIndex(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,i=void 0===o?r:toAbsoluteIndex(o,r);i>a;)t[a++]=e;return t}),Uint8Array.prototype.copyWithin||(Int8Array.prototype.copyWithin=Int16Array.prototype.copyWithin=Int32Array.prototype.copyWithin=Uint8Array.prototype.copyWithin=Uint16Array.prototype.copyWithin=Uint32Array.prototype.copyWithin=Float32Array.prototype.copyWithin=Float64Array.prototype.copyWithin=Array.prototype.copyWithin=function(e,t){var r=Object(this),n=r.length>>>0,a=toAbsoluteIndex(e,n),o=toAbsoluteIndex(t,n),i=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===i?n:toAbsoluteIndex(i,n))-o,n-a),u=1;for(o<a&&a<o+s&&(u=-1,o+=s-1,a+=s-1);s-- >0;)o in r?r[a]=r[o]:delete r[a],a+=u,o+=u;return r}),Date.now||(Date.now=function(){return(new Date).getTime()}),"performance"in self||(self.performance={now:function(){return Date.now()}}),("undefined"==typeof console?"undefined":_typeof(console))>"u"){var s=function(e,t){postMessage({target:"console",command:e,content:JSON.stringify(Array.prototype.slice.call(t))})};self.console={log:function(){s("log",arguments)},debug:function(){s("debug",arguments)},info:function(){s("info",arguments)},warn:function(){s("warn",arguments)},error:function(){s("error",arguments)}},console.log("Detected lack of console, overridden console")}("undefined"==typeof Promise?"undefined":_typeof(Promise))>"u"&&(self.Promise=function(e){var t=function(){};return e((function(e){return setTimeout((function(){return t(e)}),0)})),{then:function(e){return t=e}}});var read_=function(e,t){var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType=t?"arraybuffer":"text",r.send(null),r.response},readAsync=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){if((200===n.status||0===n.status)&&n.response)return t(n.response)},n.onerror=r,n.send(null)},lastCurrentTime=0,rate=1,rafId=null,nextIsRaf=!1,lastCurrentTimeReceivedAt=Date.now(),targetFps=24,useLocalFonts=!1,blendMode="js",availableFonts={},fontMap_={},fontId=0,debug;self.width=0,self.height=0;var asyncRender=!1;self.addFont=function(e){var t=e.font;return asyncWrite(t)};var findAvailableFonts=function(e){(e=e.trim().toLowerCase()).startsWith("@")&&(e=e.substring(1)),!fontMap_[e]&&(fontMap_[e]=!0,availableFonts[e]?asyncWrite(availableFonts[e]):useLocalFonts&&postMessage({target:"getLocalFont",font:e}))},asyncWrite=function(e){"string"==typeof e?readAsync(e,(function(e){allocFont(new Uint8Array(e))}),console.error):allocFont(e)},allocFont=function(e){var t=_malloc(e.byteLength);self.HEAPU8.set(e,t),jassubObj.addFont("font-"+fontId++,t,e.byteLength),jassubObj.reloadFonts()},processAvailableFonts=function(e){if(availableFonts){for(var t=parseAss(e),r=0;r<t.length;r++)for(var n=0;n<t[r].body.length;n++)"Style"===t[r].body[n].key&&findAvailableFonts(t[r].body[n].value.Fontname);for(var a,o=/\\fn([^\\}]*?)[\\}]/g;null!==(a=o.exec(e));)findAvailableFonts(a[1])}};self.setTrack=function(e){var t=e.content;processAvailableFonts(t),dropAllBlur&&(t=dropBlur(t)),jassubObj.createTrackMem(t),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],postMessage({target:"verifyColorSpace",subtitleColorSpace:subtitleColorSpace})},self.getColorSpace=function(){return postMessage({target:"verifyColorSpace",subtitleColorSpace:subtitleColorSpace})},self.freeTrack=function(){jassubObj.removeTrack()},self.setTrackByUrl=function(e){var t=e.url;self.setTrack({content:read_(t)})};var getCurrentTime=function(){var e=(Date.now()-lastCurrentTimeReceivedAt)/1e3;return _isPaused?lastCurrentTime:(e>5&&(console.error("Didn't received currentTime > 5 seconds. Assuming video was paused."),setIsPaused(!0)),lastCurrentTime+e*rate)},setCurrentTime=function(e){lastCurrentTime=e,lastCurrentTimeReceivedAt=Date.now(),rafId||(nextIsRaf?rafId=requestAnimationFrame(renderLoop):(renderLoop(),setTimeout((function(){nextIsRaf=!1}),20)))},_isPaused=!0,setIsPaused=function(e){e!==_isPaused&&(_isPaused=e,e?rafId&&(clearTimeout(rafId),rafId=null):(lastCurrentTimeReceivedAt=Date.now(),rafId=requestAnimationFrame(renderLoop)))},a="BT601",b="BT709",c="SMPTE240M",d="FCC",libassYCbCrMap=[null,a,null,a,a,b,b,c,c,d,d],render=function(e,t){var r={},n=performance.now(),a="wasm"===blendMode?jassubObj.renderBlend(e,t||0):jassubObj.renderImage(e,t||0);if(debug){var o=performance.now(),i=jassubObj.time;r.WASMRenderTime=i-n,r.WASMBitmapDecodeTime=o-i,r.JSRenderTime=Date.now()}if(0!==jassubObj.changed||t){var s=[],u=[];if(!a)return paintImages({images:s,buffers:u,times:r});if(asyncRender){for(var l=[],c=a,f=0;f<jassubObj.count;c=c.next,++f){var d={w:c.w,h:c.h,x:c.x,y:c.y},p=c.image,h=hasBitmapBug?self.HEAPU8C.slice(p,p+d.w*d.h*4):self.HEAPU8C.subarray(p,p+d.w*d.h*4);l.push(createImageBitmap(new ImageData(h,d.w,d.h))),s.push(d)}Promise.all(l).then((function(e){for(var t=0;t<s.length;t++)s[t].image=e[t];debug&&(r.JSBitmapGenerationTime=Date.now()-r.JSRenderTime),paintImages({images:s,buffers:e,times:r})}))}else{for(var y=a,v=0;v<jassubObj.count;y=y.next,++v){var g={w:y.w,h:y.h,x:y.x,y:y.y,image:y.image};if(!offCanvasCtx){var m=self.wasmMemory.buffer.slice(y.image,y.image+y.w*y.h*4);u.push(m),g.image=m}s.push(g)}paintImages({images:s,buffers:u,times:r})}}else postMessage({target:"unbusy"})};self.demand=function(e){var t=e.time;lastCurrentTime=t,render(t)};var renderLoop=function e(t){rafId=0,render(getCurrentTime(),t),_isPaused||(rafId=requestAnimationFrame(e))},paintImages=function(e){var t=e.times,r=e.images,n=e.buffers,a={target:"render",asyncRender:asyncRender,images:r,times:t,width:self.width,height:self.height,colorSpace:subtitleColorSpace};if(offscreenRender){(offCanvas.height!==self.height||offCanvas.width!==self.width)&&(offCanvas.width=self.width,offCanvas.height=self.height),offCanvasCtx.clearRect(0,0,self.width,self.height);var o,i=_createForOfIteratorHelper(r);try{for(i.s();!(o=i.n()).done;){var s=o.value;s.image&&(asyncRender?(offCanvasCtx.drawImage(s.image,s.x,s.y),s.image.close()):(bufferCanvas.width=s.w,bufferCanvas.height=s.h,bufferCtx.putImageData(new ImageData(self.HEAPU8C.subarray(s.image,s.image+s.w*s.h*4),s.w,s.h),0,0),offCanvasCtx.drawImage(bufferCanvas,s.x,s.y)))}}catch(e){i.e(e)}finally{i.f()}if("hybrid"===offscreenRender){if(!r.length)return postMessage(a);debug&&(t.bitmaps=r.length);try{var u=offCanvas.transferToImageBitmap();a.images=[{image:u,x:0,y:0}],a.asyncRender=!0,postMessage(a,[u])}catch(e){postMessage({target:"unbusy"})}}else{if(debug){t.JSRenderTime=Date.now()-t.JSRenderTime-(t.JSBitmapGenerationTime||0);var l=0;for(var c in t)l+=t[c];console.log("Bitmaps: "+r.length+" Total: "+(0|l)+"ms",t)}postMessage({target:"unbusy"})}}else postMessage(a,n)},parseAss=function(e){var t,r,n,a,o,i,s,u,l,c,f=[],d=e.split(/[\r\n]+/g);for(u=0;u<d.length;u++)if(t=d[u].match(/^\[(.*)\]$/))r=null,f.push({name:t[1],body:[]});else{if(/^\s*$/.test(d[u])||0===f.length)continue;if(c=f[f.length-1].body,";"===d[u][0])c.push({type:"comment",value:d[u].substring(1)});else{if(o=(a=d[u].split(":"))[0],i=a.slice(1).join(":").trim(),(r||"Format"===o)&&(i=i.split(","),r&&i.length>r.length&&(n=i.slice(r.length-1).join(","),(i=i.slice(0,r.length-1)).push(n)),i=i.map((function(e){return e.trim()})),r)){for(s={},l=0;l<i.length;l++)s[r[l]]=i[l];i=s}"Format"===o&&(r=i),c.push({key:o,value:i})}}return f},blurRegex=/\\blur(?:[0-9]+\.)?[0-9]+/gm,dropBlur=function(e){return e.replace(blurRegex,"")},requestAnimationFrame=function(){var e=0;return function(t){var r=Date.now();if(0===e)e=r+1e3/targetFps;else for(;r+2>=e;)e+=1e3/targetFps;var n=Math.max(e-r,0);return setTimeout(t,n)}}(),_applyKeys=function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t[a]=e[a]}},offCanvas,offCanvasCtx,offscreenRender,bufferCanvas,bufferCtx,jassubObj,subtitleColorSpace,dropAllBlur,_malloc,hasBitmapBug;self.init=function(data){hasBitmapBug=data.hasBitmapBug;try{var _s=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(!(_s instanceof WebAssembly.Module&&new WebAssembly.Instance(_s)instanceof WebAssembly.Instance))throw new Error("WASM not supported")}catch(e){console.warn(e),eval(read_(data.legacyWasmUrl))}if(WebAssembly.instantiateStreaming){var _s2=self.fetch;self.fetch=function(e){return _s2(data.wasmUrl)}}Module({wasm:!WebAssembly.instantiateStreaming&&read_(data.wasmUrl,!0)}).then((function(e){_malloc=e._malloc,self.width=data.width,self.height=data.height,blendMode=data.blendMode,(asyncRender=data.asyncRender)&&("undefined"==typeof createImageBitmap?"undefined":_typeof(createImageBitmap))>"u"&&(asyncRender=!1,console.error("'createImageBitmap' needed for 'asyncRender' unsupported!")),availableFonts=data.availableFonts,debug=data.debug,targetFps=data.targetFps||targetFps,useLocalFonts=data.useLocalFonts,dropAllBlur=data.dropAllBlur;var t=data.fallbackFont.toLowerCase();jassubObj=new e.JASSUB(self.width,self.height,t||null,debug),t&&findAvailableFonts(t);var r=data.subContent;r||(r=read_(data.subUrl)),processAvailableFonts(r),dropAllBlur&&(r=dropBlur(r));var n,a=_createForOfIteratorHelper(data.fonts||[]);try{for(a.s();!(n=a.n()).done;){var o=n.value;asyncWrite(o)}}catch(e){a.e(e)}finally{a.f()}jassubObj.createTrackMem(r),subtitleColorSpace=libassYCbCrMap[jassubObj.trackColorSpace],jassubObj.setDropAnimations(data.dropAllAnimations||0),(data.libassMemoryLimit>0||data.libassGlyphLimit>0)&&jassubObj.setMemoryLimits(data.libassGlyphLimit||0,data.libassMemoryLimit||0),postMessage({target:"ready"}),postMessage({target:"verifyColorSpace",subtitleColorSpace:subtitleColorSpace})}))},self.offscreenCanvas=function(e){var t=e.transferable;offCanvas=t[0],offCanvasCtx=offCanvas.getContext("2d"),asyncRender||(bufferCanvas=new OffscreenCanvas(self.height,self.width),bufferCtx=bufferCanvas.getContext("2d",{desynchronized:!0})),offscreenRender=!0},self.detachOffscreen=function(){offCanvas=new OffscreenCanvas(self.height,self.width),offCanvasCtx=offCanvas.getContext("2d",{desynchronized:!0}),offscreenRender="hybrid"},self.canvas=function(e){var t=e.width,r=e.height,n=e.force;if(null==t)throw new Error("Invalid canvas size specified");self.width=t,self.height=r,jassubObj&&jassubObj.resizeCanvas(t,r),n&&render(lastCurrentTime,!0)},self.video=function(e){var t=e.currentTime,r=e.isPaused,n=e.rate;null!=t&&setCurrentTime(t),null!=r&&setIsPaused(r),n=n||n},self.destroy=function(){jassubObj.quitLibrary()},self.createEvent=function(e){var t=e.event;_applyKeys(t,jassubObj.getEvent(jassubObj.allocEvent()))},self.getEvents=function(){for(var e=[],t=0;t<jassubObj.getEventCount();t++){var r=jassubObj.getEvent(t),n=r.Start,a=r.Duration,o=r.ReadOrder,i=r.Layer,s=r.Style,u=r.MarginL,l=r.MarginR,c=r.MarginV,f=r.Name,d=r.Text,p=r.Effect;e.push({Start:n,Duration:a,ReadOrder:o,Layer:i,Style:s,MarginL:u,MarginR:l,MarginV:c,Name:f,Text:d,Effect:p})}postMessage({target:"getEvents",events:e})},self.setEvent=function(e){var t=e.event,r=e.index;_applyKeys(t,jassubObj.getEvent(r))},self.removeEvent=function(e){var t=e.index;jassubObj.removeEvent(t)},self.createStyle=function(e){var t=e.style;_applyKeys(t,jassubObj.getStyle(jassubObj.allocStyle()))},self.getStyles=function(){for(var e=[],t=0;t<jassubObj.getStyleCount();t++){var r=jassubObj.getStyle(t),n=r.Name,a=r.FontName,o=r.FontSize,i=r.PrimaryColour,s=r.SecondaryColour,u=r.OutlineColour,l=r.BackColour,c=r.Bold,f=r.Italic,d=r.Underline,p=r.StrikeOut,h=r.ScaleX,y=r.ScaleY,v=r.Spacing,g=r.Angle,m=r.BorderStyle,b=r.Outline,C=r.Shadow,w=r.Alignment,T=r.MarginL,A=r.MarginR,$=r.MarginV,P=r.Encoding,S=r.treat_fontname_as_pattern,j=r.Blur,O=r.Justify;e.push({Name:n,FontName:a,FontSize:o,PrimaryColour:i,SecondaryColour:s,OutlineColour:u,BackColour:l,Bold:c,Italic:f,Underline:d,StrikeOut:p,ScaleX:h,ScaleY:y,Spacing:v,Angle:g,BorderStyle:m,Outline:b,Shadow:C,Alignment:w,MarginL:T,MarginR:A,MarginV:$,Encoding:P,treat_fontname_as_pattern:S,Blur:j,Justify:O})}postMessage({target:"getStyles",time:Date.now(),styles:e})},self.setStyle=function(e){var t=e.style,r=e.index;_applyKeys(t,jassubObj.getStyle(r))},self.removeStyle=function(e){var t=e.index;jassubObj.removeStyle(t)},onmessage=function(e){var t=e.data;if(!self[t.target])throw new Error("Unknown event target "+t.target);self[t.target](t)};