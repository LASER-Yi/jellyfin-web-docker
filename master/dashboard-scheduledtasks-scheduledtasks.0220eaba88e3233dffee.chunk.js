"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[50570],{25810:function(t,e,n){n.r(e),n.d(e,{default:function(){return v}}),n(69217),n(76056),n(72410),n(63238),n(15610),n(17460),n(52077),n(25901),n(92189),n(91047),n(5769),n(14078),n(51789);var a=n(28540),s=n(94994),r=n(44038),i=n(20990),o=n(93975),l=n(15039),d=n(81643);function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function u(t){ApiClient.getScheduledTasks({isHidden:!1}).then((function(e){!function(t,e){var n;e=e.sort((function(t,e){return(t=t.Category+" "+t.Name)>(e=e.Category+" "+e.Name)?1:t<e?-1:0}));for(var a="",r=0;r<e.length;r++){var i=e[r];i.Category!=n&&((n=i.Category)&&(a+="</div>",a+="</div>"),a+='<div class="verticalSection verticalSection-extrabottompadding">',a+='<div class="sectionTitleContainer" style="margin-bottom:1em;">',a+='<h2 class="sectionTitle">',a+=n,a+="</h2>",0===r&&(a+='<a is="emby-linkbutton" class="raised button-alt headerHelpButton" target="_blank" href="https://jellyfin.org/docs/general/server/tasks">'+s.ZP.translate("Help")+"</a>"),a+="</div>",a+='<div class="paperList">'),a+='<div class="listItem listItem-border scheduledTaskPaperIconItem" data-status="'+i.State+'">',a+="<a is='emby-linkbutton' style='margin:0;padding:0;' class='clearLink listItemIconContainer' href='scheduledtask.html?id="+i.Id+"'>",a+='<span class="material-icons listItemIcon schedule" aria-hidden="true"></span>',a+="</a>",a+='<div class="listItemBody two-line">';var o="left";s.ZP.getIsRTL()&&(o="right"),a+="<a class='clearLink' style='margin:0;padding:0;display:block;text-align:"+o+";' is='emby-linkbutton' href='scheduledtask.html?id="+i.Id+"'>",a+="<h3 class='listItemBodyText'>"+i.Name+"</h3>",a+="<div class='secondary listItemBodyText' id='taskProgress"+i.Id+"'>"+f(i)+"</div>",a+="</a>",a+="</div>","Running"===i.State?a+='<button type="button" is="paper-icon-button-light" id="btnTask'+i.Id+'" class="btnStopTask" data-taskid="'+i.Id+'" title="'+s.ZP.translate("ButtonStop")+'"><span class="material-icons stop" aria-hidden="true"></span></button>':"Idle"===i.State&&(a+='<button type="button" is="paper-icon-button-light" id="btnTask'+i.Id+'" class="btnStartTask" data-taskid="'+i.Id+'" title="'+s.ZP.translate("ButtonStart")+'"><span class="material-icons play_arrow" aria-hidden="true"></span></button>'),a+="</div>"}e.length&&(a+="</div>",a+="</div>"),t.querySelector(".divScheduledTasks").innerHTML=a}(t,e),a.ZP.hide()}))}function f(t){var e="";if("Idle"===t.State){if(t.LastExecutionResult){var n=Date.parse(t.LastExecutionResult.EndTimeUtc),a=Date.parse(t.LastExecutionResult.StartTimeUtc);e+=s.ZP.translate("LabelScheduledTaskLastRan",(0,i.Z)(n,(0,l.LP)()),(0,o.Z)(a,n,{locale:(0,l.Kd)()})),"Failed"===t.LastExecutionResult.Status?e+=" <span style='color:#FF0000;'>("+s.ZP.translate("LabelFailed")+")</span>":"Cancelled"===t.LastExecutionResult.Status?e+=" <span style='color:#0026FF;'>("+s.ZP.translate("LabelCancelled")+")</span>":"Aborted"===t.LastExecutionResult.Status&&(e+=" <span style='color:#FF0000;'>"+s.ZP.translate("LabelAbortedByServerShutdown")+"</span>")}}else if("Running"===t.State){var r=(t.CurrentProgressPercentage||0).toFixed(1);e+='<div style="display:flex;align-items:center;">',e+='<div class="taskProgressOuter" title="'+r+'%" style="flex-grow:1;">',e+='<div class="taskProgressInner" style="width:'+r+'%;">',e+="</div>",e+="</div>",e+="<span style='color:#00a4dc;margin-left:5px;'>"+r+"%</span>",e+="</div>"}else e+="<span style='color:#FF0000;'>"+s.ZP.translate("LabelStopping")+"</span>";return e}function p(t,e){var n=t.querySelector(".material-icons");n.classList.remove("stop","play_arrow"),n.classList.add(e)}function y(t,e){"Running"===e?(t.classList.remove("btnStartTask"),t.classList.add("btnStopTask"),p(t,"stop"),t.title=s.ZP.translate("ButtonStop")):"Idle"===e&&(t.classList.add("btnStartTask"),t.classList.remove("btnStopTask"),p(t,"play_arrow"),t.title=s.ZP.translate("ButtonStart")),$(t).parents(".listItem")[0].setAttribute("data-status",e)}function v(t){function e(){ApiClient.isMessageChannelOpen()||u(t)}function n(e,n,a){n.serverId()===i&&function(e){var n,a=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,s=function(){};return{s:s,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){o=!0,r=t},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw r}}}}(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;t.querySelector("#taskProgress"+s.Id).innerHTML=f(s),y(t.querySelector("#btnTask"+s.Id),s.State)}}catch(t){a.e(t)}finally{a.f()}}(a)}var s,i=ApiClient.serverId();$(".divScheduledTasks",t).on("click",".btnStartTask",(function(){var e=this,n=e.getAttribute("data-taskid");ApiClient.startScheduledTask(n).then((function(){y(e,"Running"),u(t)}))})),$(".divScheduledTasks",t).on("click",".btnStopTask",(function(){var e=this,n=e.getAttribute("data-taskid");ApiClient.stopScheduledTask(n).then((function(){y(e,""),u(t)}))})),t.addEventListener("viewbeforehide",(function(){d.Z.off(r.default,"ScheduledTasksInfo",n),ApiClient.sendMessage("ScheduledTasksInfoStop"),s&&clearInterval(s)})),t.addEventListener("viewshow",(function(){a.ZP.show(),ApiClient.sendMessage("ScheduledTasksInfoStart","1000,1000"),s&&clearInterval(s),s=setInterval(e,1e4),u(t),d.Z.on(r.default,"ScheduledTasksInfo",n)}))}n(38228)},33940:function(t,e,n){function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}n.d(e,{Z:function(){return a}})}}]);