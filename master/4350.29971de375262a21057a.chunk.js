"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4350,76542],{4350:function(e,t,a){a.r(t),a.d(t,{default:function(){return T},show:function(){return z}}),a(14382),a(44962),a(26448),a(78557),a(96054),a(90076),a(83994),a(82367);var n,r=a(79754),i=a(8566),o=a(47629),s=a(46782),l=a(9164),d=a(5898),c=a(59774),u=a(10838),m=a(76542),h=a(34789),g=a(22622),f=(a(10353),a(15453),a(41177)),v=a(47602),b='<div class="formDialogHeader"> <button is="paper-icon-button-light" class="btnCancel autoSize" tabindex="-1" title="${ButtonBack}"><span class="material-icons arrow_back" aria-hidden="true"></span></button> <h3 class="formDialogHeaderTitle"> ${HeaderEditImages} </h3> </div> <div class="formDialogContent smoothScrollY"> <div class="dialogContentInner"> <div id="imagesContainer"> <div class="imageEditor-buttons first-imageEditor-buttons"> <h2 style="margin:0">${Images}</h2> <button type="button" is="emby-button" class="btnBrowseAllImages fab mini autoSize"> <span class="material-icons search" aria-hidden="true"></span> </button> <button type="button" is="emby-button" class="btnOpenUploadMenu fab mini hide"> <span class="material-icons add" aria-hidden="true"></span> </button> </div> <div id="images" class="itemsContainer vertical-wrap"> </div> <br/> </div> <div id="backdropsContainer" class="hide"> <div class="imageEditor-buttons"> <h2 style="margin:0">${Backdrops}</h2> <button type="button" is="emby-button" class="btnBrowseAllImages fab mini autoSize" data-imagetype="Backdrop"> <span class="material-icons search" aria-hidden="true"></span> </button> <button type="button" is="emby-button" class="btnOpenUploadMenu fab mini hide" data-imagetype="Backdrop"> <span class="material-icons add" aria-hidden="true"></span> </button> </div> <div id="backdrops" class="itemsContainer vertical-wrap"> </div> <br/> </div> </div> </div> ',p=!h.A.slow&&!h.A.edge,y=!1;function I(e,t,a){var r;i.Ay.show(),t?(r=c.tF.getApiClient(t.ServerId),C(e,t,r,a)):(r=c.tF.getApiClient(n.ServerId)).getItem(r.getCurrentUserId(),n.Id).then((function(t){C(e,t,r,a)}))}function A(e,t,a,n){e.addEventListener(a,(function(e){var a=o.Ay.parentWithClass(e.target,t);a&&n.call(a,e)}))}function C(e,t,a,r){n=t,a.getRemoteImageProviders({itemId:n.Id}).then((function(t){for(var o=e.querySelectorAll(".btnBrowseAllImages"),d=0,c=o.length;d<c;d++)t.length?o[d].classList.remove("hide"):o[d].classList.add("hide");a.getItemImageInfos(n.Id).then((function(n){!function(e,t,a,n,r){var i=n.filter((function(e){return"Backdrop"!==e.ImageType&&"Chapter"!==e.ImageType}));x(0,0,t,i,r,e.querySelector("#images"))}(e,a,0,n,t),function(e,t,a,n,r){var i=n.filter((function(e){return"Backdrop"===e.ImageType})).sort((function(e,t){return e.ImageIndex-t.ImageIndex}));i.length?(e.querySelector("#backdropsContainer",e).classList.remove("hide"),x(0,0,t,i,r,e.querySelector("#backdrops"))):e.querySelector("#backdropsContainer",e).classList.add("hide")}(e,a,0,n,t),i.Ay.hide(),s.A.tv&&l.A.autoFocus(r||e)}))}))}function S(e,t,a){var r="",i="card scalableCard imageEditorCard";i+=" backdropCard backdropCard-scalable","button"===a.tagName?(i+=" btnImageCard",s.A.tv&&(i+=" show-focus",p&&(i+=" show-animation")),r+='<button type="button" class="'+i+'"'):r+='<div class="'+i+'"',r+=' data-id="'+n.Id+'" data-serverid="'+t.serverId()+'" data-index="'+a.index+'" data-numimages="'+a.numImages+'" data-imagetype="'+e.ImageType+'" data-providers="'+a.imageProviders.length+'"',r+=">",r+='<div class="cardBox visualCardBox">',r+='<div class="cardScalable visualCardBox-cardScalable" style="background-color:transparent;">',r+='<div class="cardPadder-backdrop"></div>',r+='<div class="cardContent">';var o=function(e,t,a,n,r){return(r=r||{}).type=a,r.index=n,r.tag="Backdrop"===a?e.BackdropImageTags[n]:"Primary"===a&&e.PrimaryImageTag||e.ImageTags[a],t.getScaledImageUrl(e.Id||e.ItemId,r)}(n,t,e.ImageType,e.ImageIndex,{maxWidth:a.imageSize});return r+='<div class="cardImageContainer" style="background-image:url(\''+o+"');background-position:center center;background-size:contain;\"></div>",r+="</div>",r+="</div>",r+='<div class="cardFooter visualCardBox-cardFooter">',r+='<h3 class="cardText cardTextCentered" style="margin:0;">'+d.Ay.translate(""+e.ImageType)+"</h3>",r+='<div class="cardText cardText-secondary cardTextCentered">',e.Width&&e.Height?r+=e.Width+" X "+e.Height:r+="&nbsp;",r+="</div>",a.enableFooterButtons&&(r+='<div class="cardText cardTextCentered">',"Backdrop"===e.ImageType?(a.index>0?r+='<button type="button" is="paper-icon-button-light" class="btnMoveImage autoSize" data-imagetype="'+e.ImageType+'" data-index="'+e.ImageIndex+'" data-newindex="'+(e.ImageIndex-1)+'" title="'+d.Ay.translate("MoveLeft")+'"><span class="material-icons chevron_left"></span></button>':r+='<button type="button" is="paper-icon-button-light" class="autoSize" disabled title="'+d.Ay.translate("MoveLeft")+'"><span class="material-icons chevron_left" aria-hidden="true"></span></button>',a.index<a.numImages-1?r+='<button type="button" is="paper-icon-button-light" class="btnMoveImage autoSize" data-imagetype="'+e.ImageType+'" data-index="'+e.ImageIndex+'" data-newindex="'+(e.ImageIndex+1)+'" title="'+d.Ay.translate("MoveRight")+'"><span class="material-icons chevron_right" aria-hidden="true"></span></button>':r+='<button type="button" is="paper-icon-button-light" class="autoSize" disabled title="'+d.Ay.translate("MoveRight")+'"><span class="material-icons chevron_right" aria-hidden="true"></span></button>'):a.imageProviders.length&&(r+='<button type="button" is="paper-icon-button-light" data-imagetype="'+e.ImageType+'" class="btnSearchImages autoSize" title="'+d.Ay.translate("Search")+'"><span class="material-icons search" aria-hidden="true"></span></button>'),r+='<button type="button" is="paper-icon-button-light" data-imagetype="'+e.ImageType+'" data-index="'+(null!=e.ImageIndex?e.ImageIndex:"null")+'" class="btnDeleteImage autoSize" title="'+d.Ay.translate("Delete")+'"><span class="material-icons delete" aria-hidden="true"></span></button>',r+="</div>"),r+="</div>",(r+="</div>")+"</"+a.tagName+">"}function k(e,t,a,n,r,i){var o=function(){r.deleteItemImage(t,a,n).then((function(){y=!0,I(e)}))};i?(0,v.A)({text:d.Ay.translate("ConfirmDeleteImage"),confirmText:d.Ay.translate("Delete"),primary:"delete"}).then(o):o()}function w(e,t,a,n,r,i,o){t.updateItemImageIndex(a,n,r,i).then((function(){y=!0,I(e,null,o)}),(function(){(0,f.A)(d.Ay.translate("ErrorDefault"))}))}function x(e,t,a,n,r,i){var l="",d=300,c=o.Ay.getWindowSize();c.innerWidth>=1280&&(d=Math.round(c.innerWidth/4));for(var u=s.A.tv?"button":"div",h=!s.A.tv,g=0,f=n.length;g<f;g++)l+=S(n[g],a,{index:g,numImages:f,imageProviders:r,imageSize:d,tagName:u,enableFooterButtons:h});i.innerHTML=l,m.default.lazyChildren(i)}function L(e,t){a.e(48232).then(a.bind(a,48232)).then((function(a){a.show(n.Id,n.ServerId,n.Type,t,"Season"==n.Type?n.ParentId:null).then((function(){y=!0,I(e)})).catch((function(){}))}))}function z(e){return new Promise((function(t,l){y=!1,function(e,t,l){var m=e.itemId,h=e.serverId;i.Ay.show();var f=c.tF.getApiClient(h);f.getItem(f.getCurrentUserId(),m).then((function(m){var h={removeOnClose:!0};s.A.tv?h.size="fullscreen":h.size="small";var f=r.default.createDialog(h);f.classList.add("formDialog"),f.innerHTML=d.Ay.translateHtml(b,"core"),s.A.tv&&u.default.centerFocus.on(f,!1),function(e,t){for(var r=e.querySelectorAll(".btnOpenUploadMenu"),i=g.g.supports("fileinput"),s=0,l=r.length;s<l;s++)i?r[s].classList.remove("hide"):r[s].classList.add("hide");A(e,"btnOpenUploadMenu","click",(function(){var r=this.getAttribute("data-imagetype");a.e(61989).then(a.bind(a,61989)).then((function(a){a.default.show({theme:t.theme,imageType:r,itemId:n.Id,serverId:n.ServerId}).then((function(t){t&&(y=!0,I(e))}))}))})),A(e,"btnSearchImages","click",(function(){L(e,this.getAttribute("data-imagetype"))})),A(e,"btnBrowseAllImages","click",(function(){L(e,this.getAttribute("data-imagetype")||"Primary")})),A(e,"btnImageCard","click",(function(){!function(e,t){var n=t.getAttribute("data-id"),r=t.getAttribute("data-serverid"),i=c.tF.getApiClient(r),s=t.getAttribute("data-imagetype"),l=parseInt(t.getAttribute("data-index"),10),u=parseInt(t.getAttribute("data-providers"),10),m=parseInt(t.getAttribute("data-numimages"),10);a.e(62882).then(a.bind(a,62882)).then((function(a){var r=a.default,c=[];c.push({name:d.Ay.translate("Delete"),id:"delete"}),"Backdrop"===s&&(l>0&&c.push({name:d.Ay.translate("MoveLeft"),id:"moveleft"}),l<m-1&&c.push({name:d.Ay.translate("MoveRight"),id:"moveright"})),u&&c.push({name:d.Ay.translate("Search"),id:"search"}),r.show({items:c,positionTo:t}).then((function(a){switch(a){case"delete":k(e,n,s,l,i,!1);break;case"search":L(e,s);break;case"moveleft":w(e,i,n,s,l,l-1,o.Ay.parentWithClass(t,"itemsContainer"));break;case"moveright":w(e,i,n,s,l,l+1,o.Ay.parentWithClass(t,"itemsContainer"))}}))}))}(e,this)})),A(e,"btnDeleteImage","click",(function(){var t=this.getAttribute("data-imagetype"),a=this.getAttribute("data-index");a="null"===a?null:parseInt(a,10);var r=c.tF.getApiClient(n.ServerId);k(e,n.Id,t,a,r,!0)})),A(e,"btnMoveImage","click",(function(){var t=this.getAttribute("data-imagetype"),a=this.getAttribute("data-index"),r=this.getAttribute("data-newindex"),i=c.tF.getApiClient(n.ServerId);w(e,i,n.Id,t,a,r,o.Ay.parentWithClass(this,"itemsContainer"))}))}(f,e),f.addEventListener("close",(function(){s.A.tv&&u.default.centerFocus.off(f,!1),i.Ay.hide(),y?t():l()})),r.default.open(f),I(f,m),f.querySelector(".btnCancel").addEventListener("click",(function(){r.default.close(f)}))}))}(e,t,l)}))}var T={show:z}},76542:function(e,t,a){a.r(t),a.d(t,{default:function(){return y},fillImage:function(){return m},fillImages:function(){return b},getPrimaryImageAspectRatio:function(){return v},lazyChildren:function(){return f},lazyImage:function(){return d},setLazyImage:function(){return p}}),a(29305),a(32733),a(84701),a(14382),a(69892),a(44962),a(89336),a(26448),a(78557),a(95021),a(73687),a(83994),a(93062),a(82367);var n=a(99891),r=a(82885);function i(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return o(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var s=new function(){return new Worker(a.p+"blurhash.worker.bundle.js")},l={};function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getAttribute("data-src");t&&g(e,t)}function c(e,t,a,n){var r=document.createElement("canvas");r.setAttribute("aria-hidden","true"),r.width=a,r.height=n;var i=r.getContext("2d"),o=i.createImageData(a,n);o.data.set(t),i.putImageData(o,0,0),requestAnimationFrame((function(){r.classList.add("blurhash-canvas"),e.parentNode.insertBefore(r,e),e.classList.add("blurhashed"),e.removeAttribute("data-blurhash")}))}function u(e,t){try{l[t]=(l[t]||[]).filter((function(t){return t!==e})),l[t].push(e),s.postMessage({hash:t,width:20,height:20})}catch(t){return console.error(t),void e.classList.add("non-blurhashable")}}function m(e){if(!e)throw new Error("entry cannot be null");var t,a=e.target;t=a?a.getAttribute("data-src"):e,e.isIntersecting?t&&g(a,t):t||function(e){var t;e.removeEventListener("animationend",h);var a,n=e.previousSibling;"CANVAS"===(null==n?void 0:n.tagName)&&n.classList.remove("lazy-hidden"),null===(t=e.parentNode)||void 0===t||null===(t=t.querySelector(".cardPadder"))||void 0===t||t.classList.remove("lazy-hidden-children"),"IMG"!==e.tagName?(a=e.style.backgroundImage.slice(4,-1).replace(/"/g,""),e.style.backgroundImage="none"):(a=e.getAttribute("src"),e.setAttribute("src","")),e.setAttribute("data-src",a),e.classList.remove("lazy-image-fadein-fast","lazy-image-fadein"),e.classList.add("lazy-hidden")}(a)}function h(e){var t=e.target;requestAnimationFrame((function(){var e,a=t.previousSibling;t.classList.contains("blurhashed")&&"CANVAS"===(null==a?void 0:a.tagName)&&a.classList.add("lazy-hidden"),null===(e=t.parentNode)||void 0===e||null===(e=e.querySelector(".cardPadder"))||void 0===e||e.classList.add("lazy-hidden-children")})),t.removeEventListener("animationend",h)}function g(e,t){if(void 0===t)throw new TypeError("url cannot be undefined");var a=new Image;a.src=t,e.classList.add("lazy-hidden"),e.addEventListener("animationend",h),a.addEventListener("load",(function(){requestAnimationFrame((function(){"IMG"!==e.tagName?e.style.backgroundImage="url('"+t+"')":e.setAttribute("src",t),e.removeAttribute("data-src"),r.enableFastFadein()?e.classList.add("lazy-image-fadein-fast"):e.classList.add("lazy-image-fadein"),e.classList.remove("lazy-hidden")}))}))}function f(e){if(r.enableBlurhash()){var t,a=i(e.querySelectorAll(".lazy"));try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.getAttribute("data-blurhash");!o.classList.contains("blurhashed","non-blurhashable")&&s?u(o,s):s||o.classList.contains("blurhashed")||o.classList.add("non-blurhashable")}}catch(e){a.e(e)}finally{a.f()}}n.WK(e,m)}function v(e){for(var t=[],a=0,n=e.length;a<n;a++){var r=e[a].PrimaryImageAspectRatio||0;r&&(t[t.length]=r)}if(!t.length)return null;t.sort((function(e,t){return e-t}));var i,o=Math.floor(t.length/2);i=t.length%2?t[o]:(t[o-1]+t[o])/2;var s=2/3;if(Math.abs(s-i)<=.15)return s;var l=16/9;if(Math.abs(l-i)<=.2)return l;if(Math.abs(1-i)<=.15)return 1;var d=4/3;return Math.abs(d-i)<=.15?d:i}function b(e){for(var t=0,a=e.length;t<a;t++)m(e[0])}function p(e,t){e.classList.add("lazy"),e.setAttribute("data-src",t),d(e)}s.addEventListener("message",(function(e){var t=e.data,a=t.pixels,n=t.hsh,r=t.width,o=t.height,s=l[n];if(null!=s&&s.length){var d,u=i(s);try{for(u.s();!(d=u.n()).done;)c(d.value,a,r,o)}catch(e){u.e(e)}finally{u.f()}delete l[n]}}));var y={setLazyImage:p,fillImages:b,fillImage:m,lazyImage:d,lazyChildren:f,getPrimaryImageAspectRatio:v}},99891:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}a.d(t,{WK:function(){return s}}),a(29305),a(32733),a(84701),a(81678),a(69892),a(44962),a(4754),a(94),a(36947),a(78557),a(83994),a(23630),a(82367);var o=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t},(t=[{key:"createObserver",value:function(){var e=this.options.callback,t=new IntersectionObserver((function(t){t.forEach((function(t){e(t)}))}),{rootMargin:"50%",threshold:0});this.observer=t}},{key:"addElements",value:function(e){var t=this.observer;t||(this.createObserver(),t=this.observer),Array.from(e).forEach((function(e){t.observe(e)}))}},{key:"destroyObserver",value:function(){var e=this.observer;e&&(e.disconnect(),this.observer=null)}},{key:"destroy",value:function(){this.destroyObserver(),this.options=null}}])&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function s(e,t){!function(e,t,a){e.length&&new o({callback:a}).addElements(e)}(e.getElementsByClassName("lazy"),0,t)}t.Ay={LazyLoader:o,lazyChildren:s}}}]);