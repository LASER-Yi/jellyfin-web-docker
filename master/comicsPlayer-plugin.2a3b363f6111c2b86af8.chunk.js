"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2430,2126],{6781:function(e,t,n){n.r(t),n.d(t,{ComicsPlayer:function(){return p}}),n(86248),n(5769),n(61484),n(63238),n(17460),n(14078),n(23938),n(95289),n(61418),n(98010),n(58112),n(95623),n(72410),n(69217),n(70684),n(68581),n(55849),n(99785),n(15610),n(52077),n(25901),n(92189),n(91047);var i=n(44839),r=n(51161),a=n(48102),s=n(84280),o=n(52050),c=n(18613),l=n(60934),A=n(16870);function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function d(e,t,n,i,r,a,s){try{var o=e[a](s),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(i,r)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function m(e,t,n){return t&&f(e.prototype,t),n&&f(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(11309),n(33609);var p=function(){function e(){var t=this;h(this,e),v(this,"onDirChanged",(function(){var e=t.comicsPlayerSettings.langDir;e=e&&"ltr"!==e?"ltr":"rtl",t.changeLanguageDirection(e),t.comicsPlayerSettings.langDir=e})),v(this,"onViewChanged",(function(){var e=t.comicsPlayerSettings.pagesPerView;e=e&&1!==e?1:2,t.changeView(e),t.comicsPlayerSettings.pagesPerView=e})),this.name="Comics Player",this.type="mediaplayer",this.id="comicsplayer",this.priority=1,this.imageMap=new Map,this.onDialogClosed=this.onDialogClosed.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this)}return m(e,[{key:"play",value:function(e){this.currentPage=0,this.pageCount=0;var t=e.items[0].Id;this.comicsPlayerSettings=l.getComicsPlayerSettings(t);var n=this.createMediaElement();return this.setCurrentSrc(n,e)}},{key:"stop",value:function(){var e;this.unbindEvents();var t={src:this.item};Events.trigger(this,"stopped",[t]);var n=this.item.Id;l.setComicsPlayerSettings(this.comicsPlayerSettings,n),null===(e=this.archiveSource)||void 0===e||e.release();var i=this.mediaElement;i&&(a.default.close(i),this.mediaElement=null),r.ZP.hide()}},{key:"destroy",value:function(){}},{key:"currentTime",value:function(){return this.currentPage}},{key:"duration",value:function(){return this.pageCount}},{key:"currentItem",value:function(){return this.item}},{key:"volume",value:function(){return 100}},{key:"isMuted",value:function(){return!1}},{key:"paused",value:function(){return!1}},{key:"seekable",value:function(){return!0}},{key:"onDialogClosed",value:function(){this.stop()}},{key:"changeLanguageDirection",value:function(e){var t=this.currentPage;this.swiperInstance.changeLanguageDirection(e);var n="ltr"===e?"arrow_circle_left":"arrow_circle_right";this.mediaElement.querySelector(".btnToggleLangDir > span").classList.remove(n);var i="ltr"===e?"arrow_circle_right":"arrow_circle_left";this.mediaElement.querySelector(".btnToggleLangDir > span").classList.add(i);var r="ltr"===e?"Right To Left":"Left To Right";this.mediaElement.querySelector(".btnToggleLangDir").title=r,this.reload(t)}},{key:"changeView",value:function(e){var t=this.currentPage;this.swiperInstance.params.slidesPerView=e,this.swiperInstance.params.slidesPerGroup=e;var n=1===e?"devices_fold":"import_contacts";this.mediaElement.querySelector(".btnToggleView > span").classList.remove(n);var i=1===e?"import_contacts":"devices_fold";this.mediaElement.querySelector(".btnToggleView > span").classList.add(i);var r=1===e?"Double Page View":"Single Page View";this.mediaElement.querySelector(".btnToggleView").title=r,this.reload(t)}},{key:"reload",value:function(e){var t=this.swiperInstance.params.effect;this.swiperInstance.params.effect="none",this.swiperInstance.update(),this.swiperInstance.slideNext(),this.swiperInstance.slidePrev(),this.currentPage!=e&&(this.swiperInstance.slideTo(e),this.swiperInstance.update()),this.swiperInstance.params.effect=t,this.swiperInstance.update()}},{key:"onWindowKeyUp",value:function(e){"Escape"===s.ZP.getKeyName(e)&&this.stop()}},{key:"bindMediaElementEvents",value:function(){var e=this.mediaElement;null==e||e.addEventListener("close",this.onDialogClosed,{once:!0}),null==e||e.querySelector(".btnExit").addEventListener("click",this.onDialogClosed,{once:!0}),null==e||e.querySelector(".btnToggleLangDir").addEventListener("click",this.onDirChanged),null==e||e.querySelector(".btnToggleView").addEventListener("click",this.onViewChanged)}},{key:"bindEvents",value:function(){this.bindMediaElementEvents(),document.addEventListener("keyup",this.onWindowKeyUp)}},{key:"unbindMediaElementEvents",value:function(){var e=this.mediaElement;null==e||e.removeEventListener("close",this.onDialogClosed),null==e||e.querySelector(".btnExit").removeEventListener("click",this.onDialogClosed),null==e||e.querySelector(".btnToggleLangDir").removeEventListener("click",this.onDirChanged),null==e||e.querySelector(".btnToggleView").removeEventListener("click",this.onViewChanged)}},{key:"unbindEvents",value:function(){this.unbindMediaElementEvents(),document.removeEventListener("keyup",this.onWindowKeyUp)}},{key:"createMediaElement",value:function(){var e=this.mediaElement;if(e)return e;if(!(e=document.getElementById("comicsPlayer"))){e=a.default.createDialog({exitAnimationDuration:400,size:"fullscreen",autoFocus:!1,scrollY:!1,exitAnimation:"fadeout",removeOnClose:!0});var t=1===this.comicsPlayerSettings.pagesPerView?"import_contacts":"devices_fold",n="ltr"===this.comicsPlayerSettings.langDir?"arrow_circle_right":"arrow_circle_left";e.id="comicsPlayer",e.classList.add("slideshowDialog"),e.innerHTML="<div dir=".concat(this.comicsPlayerSettings.langDir,' class="slideshowSwiperContainer">\n                                <div class="swiper-wrapper"></div>\n                                <div class="swiper-button-next actionButtonIcon"></div>\n                                <div class="swiper-button-prev actionButtonIcon"></div>\n                                <div class="swiper-pagination"></div>\n                            </div>\n                            <div class="actionButtons">\n                                <button is="paper-icon-button-light" class="autoSize btnToggleLangDir" tabindex="-1">\n                                    <span class="material-icons actionButtonIcon ').concat(n,'" aria-hidden="true"></span>\n                                </button>\n                                <button is="paper-icon-button-light" class="autoSize btnToggleView" tabindex="-1">\n                                    <span class="material-icons actionButtonIcon ').concat(t,'" aria-hidden="true"></span>\n                                </button>\n                                <button is="paper-icon-button-light" class="autoSize btnExit" tabindex="-1">\n                                    <span class="material-icons actionButtonIcon close" aria-hidden="true"></span>\n                                </button>\n                            </div>'),a.default.open(e)}this.mediaElement=e;var i="ltr"===this.comicsPlayerSettings.langDir?"Right To Left":"Left To Right";this.mediaElement.querySelector(".btnToggleLangDir").title=i;var r=1===this.comicsPlayerSettings.pagesPerView?"Double Page View":"Single Page View";return this.mediaElement.querySelector(".btnToggleView").title=r,this.bindEvents(),e}},{key:"setCurrentSrc",value:function(e,t){var n=this,a=t.items[0];this.item=a,this.streamInfo={started:!0,ended:!1,item:this.item,mediaSource:{Id:a.Id}},r.ZP.show();var s=a.ServerId,l=c.Z.getApiClient(s);i.X.init({workerUrl:o.appRouter.baseUrl()+"/libraries/worker-bundle.js"});var u=l.getItemDownloadUrl(a.Id);return this.archiveSource=new y(u),this.archiveSource.load().then((function(){r.ZP.hide(),n.pageCount=n.archiveSource.urls.length,n.currentPage=t.startPositionTicks/1e4||0,n.swiperInstance=new A.t(e.querySelector(".slideshowSwiperContainer"),{direction:"horizontal",loop:!1,zoom:{minRatio:1,toggle:!0,containerClass:"slider-zoom-container"},autoplay:!1,keyboard:{enabled:!0},preloadImages:!0,slidesPerView:n.comicsPlayerSettings.pagesPerView,slidesPerGroup:n.comicsPlayerSettings.pagesPerView,slidesPerColumn:1,initialSlide:n.currentPage,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0,type:"fraction"},virtual:{slides:n.archiveSource.urls,cache:!0,renderSlide:n.getImgFromUrl,addSlidesBefore:1,addSlidesAfter:1}}),n.swiperInstance.on("slideChange",(function(){n.currentPage=n.swiperInstance.activeIndex,Events.trigger(n,"pause")}))}))}},{key:"getImgFromUrl",value:function(e){return'<div class="swiper-slide">\n                   <div class="slider-zoom-container">\n                       <img src="'.concat(e,'" class="swiper-slide-img">\n                   </div>\n               </div>')}},{key:"canPlayMediaType",value:function(e){return"book"===(e||"").toLowerCase()}},{key:"canPlayItem",value:function(e){return!(!e.Path||!e.Path.endsWith("cbz")&&!e.Path.endsWith("cbr"))}}]),e}(),w=["jpg","jpeg","jpe","jif","jfif","jfi","png","avif","gif","bmp","dib","tiff","tif","webp"],y=function(){function e(t){h(this,e),this.url=t,this.files=[],this.urls=[]}var t,n;return m(e,[{key:"load",value:(t=regeneratorRuntime.mark((function e(){var t,n,r,a,s,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.url);case 2:if((t=e.sent).ok){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.blob();case 7:return n=e.sent,e.next=10,i.X.open(n);case 10:return this.archive=e.sent,e.next=13,this.archive.getFilesArray();case 13:return this.raw=e.sent,e.next=16,this.archive.extractFiles();case 16:return e.next=18,this.archive.getFilesArray();case 18:r=(r=e.sent).filter((function(e){var t=e.file.name,n=t.lastIndexOf(".");return-1!==n&&w.includes(t.slice(n+1))})),r.sort((function(e,t){return e.file.name<t.file.name?-1:1})),a=u(r);try{for(a.s();!(s=a.n()).done;)o=s.value,c=URL.createObjectURL(o.file),this.urls.push(c)}catch(e){a.e(e)}finally{a.f()}case 23:case"end":return e.stop()}}),e,this)})),n=function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function s(e){d(a,i,r,s,o,"next",e)}function o(e){d(a,i,r,s,o,"throw",e)}s(void 0)}))},function(){return n.apply(this,arguments)})},{key:"release",value:function(){this.files=[],this.urls.forEach(URL.revokeObjectURL),this.urls=[]}}]),e}();t.default=p},18375:function(e,t,n){var i=n(54933),r=n.n(i),a=n(93476),s=n.n(a)()(r());s.push([e.id,"#comicsPlayer{background:#fff}#comicsPlayer .slideshowSwiperContainer{height:100%}#comicsPlayer .slider-zoom-container{height:100%;text-align:center}#comicsPlayer .swiper-slide-img{height:100%;max-height:100%;max-width:100%;object-fit:contain;width:100%}#comicsPlayer .swiper-pagination{background:#fff;color:#000;left:50%;padding:2px 5px;text-shadow:0 0 20px #fff;-webkit-transform:translate(-50%);transform:translate(-50%);width:-webkit-max-content;width:max-content}#comicsPlayer .actionButtons>button:hover{background:#fff}",""]),t.Z=s},33609:function(e,t,n){n.r(t);var i=n(1892),r=n.n(i),a=n(95760),s=n.n(a),o=n(38311),c=n.n(o),l=n(58192),A=n.n(l),u=n(38060),g=n.n(u),d=n(54865),h=n.n(d),f=n(18375),m={};m.styleTagTransform=h(),m.setAttributes=A(),m.insert=c().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=g(),r()(f.Z,m),t.default=f.Z&&f.Z.locals?f.Z.locals:void 0},49954:function(e){e.exports="data:application/font-woff;charset=utf-8;base64, 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"}}]);