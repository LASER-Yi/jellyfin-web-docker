"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7051],{29955:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}}),r(5769),r(86248),r(95623),r(23938),r(63238),r(61418),r(17460),r(14078);var n=r(94389),a=r(67469),c=r(83094),o=r(56705),i=r(78695),s=r(3319),u=r(47518),l=r(44614),d=(r(46650),r(45368),r(76543)),v=r(53913),m=r(25152),g=r(90914),f=r(61642),h=r(61097);function S(e,t,r,n,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void r(e)}i.done?t(s):Promise.resolve(s).then(n,a)}var y=!u.Z.slow&&!u.Z.edge;function q(e,t,r,n){o.ZP.show(),t.authenticateUserByName(r,n).then((function(e){var r=e.User;o.ZP.hide(),C(r.Id,e.AccessToken,t)}),(function(t){if(e.querySelector("#txtManualPassword").value="",o.ZP.hide(),[401,403].includes(t.status)){var r=401===t.status?"MessageInvalidUser":"MessageUnauthorizedUser";(0,m.Z)(l.ZP.translate(r))}else d.ZP.alert({message:l.ZP.translate("MessageUnableToConnectToServer"),title:l.ZP.translate("HeaderConnectionFailure")})}))}function C(e,t,r){d.ZP.onServerChanged(e,t,r),d.ZP.navigate("home.html")}function b(e,t,r){e.querySelector(".chkRememberLogin").checked=a.Z.enableAutoLogin(),e.querySelector(".manualLoginForm").classList.remove("hide"),e.querySelector(".visualLoginForm").classList.add("hide"),e.querySelector(".btnManual").classList.add("hide"),r?e.querySelector("#txtManualPassword").focus():e.querySelector("#txtManualName").focus(),t?e.querySelector(".btnCancel").classList.remove("hide"):e.querySelector(".btnCancel").classList.add("hide")}function k(e,t){function u(){var e=t.serverid;return e?v.Z.getOrCreateApiClient(e):ApiClient}function m(){e.querySelector(".visualLoginForm").classList.remove("hide"),e.querySelector(".manualLoginForm").classList.add("hide"),e.querySelector(".btnManual").classList.remove("hide"),Promise.resolve().then(r.bind(r,6610)).then((function(t){t.default.autoFocus(e)}))}e.querySelector("#divUsers").addEventListener("click",(function(t){var r=c.ZP.parentWithClass(t.target,"card"),n=r?r.querySelector(".cardContent"):null;if(n){var a=e,o=n.getAttribute("data-userid"),i=n.getAttribute("data-username"),s=n.getAttribute("data-haspw");"manual"===o?(a.querySelector("#txtManualName").value="",b(a,!0)):"false"==s?q(a,u(),i,""):(a.querySelector("#txtManualName").value=i,a.querySelector("#txtManualPassword").value="",b(a,!0,!0))}})),e.querySelector(".manualLoginForm").addEventListener("submit",(function(t){a.Z.enableAutoLogin(e.querySelector(".chkRememberLogin").checked);var r=u();return q(e,r,e.querySelector("#txtManualName").value,e.querySelector("#txtManualPassword").value),t.preventDefault(),!1})),e.querySelector(".btnForgotPassword").addEventListener("click",(function(){d.ZP.navigate("forgotpassword.html")})),e.querySelector(".btnCancel").addEventListener("click",m),e.querySelector(".btnQuick").addEventListener("click",(function(){return e=u(),t=e.getUrl("/QuickConnect/Initiate"),e.getJSON(t).then((function(t){if(!t.Secret||!t.Code)return console.error("Malformed quick connect response",t),!1;(0,f.Z)({dialogOptions:{id:"quickConnectAlert"},title:l.ZP.translate("QuickConnect"),text:l.ZP.translate("QuickConnectAuthorizeCode",t.Code)});var r=e.getUrl("/QuickConnect/Connect?Secret="+t.Secret),n=setInterval((function(){e.getJSON(r).then(function(){var t,r=(t=regeneratorRuntime.mark((function t(r){var a,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.Authenticated){t.next=2;break}return t.abrupt("return");case 2:return clearInterval(n),(a=document.getElementById("quickConnectAlert"))&&g.default.close(a),t.next=7,e.quickConnect(r.Secret);case 7:C((c=t.sent).User.Id,c.AccessToken,e);case 9:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,a){var c=t.apply(e,r);function o(e){S(c,n,a,o,i,"next",e)}function i(e){S(c,n,a,o,i,"throw",e)}o(void 0)}))});return function(e){return r.apply(this,arguments)}}(),(function(e){clearInterval(n);var t=document.getElementById("quickConnectAlert");t&&g.default.close(t),d.ZP.alert({message:l.ZP.translate("QuickConnectDeactivated"),title:l.ZP.translate("HeaderError")}),console.error("Unable to login with quick connect",e)}))}),5e3,r);return!0}),(function(e){return d.ZP.alert({message:l.ZP.translate("QuickConnectNotActive"),title:l.ZP.translate("HeaderError")}),console.error("Quick connect error: ",e),!1})),!1;var e,t})),e.querySelector(".btnManual").addEventListener("click",(function(){e.querySelector("#txtManualName").value="",b(e,!0)})),e.querySelector(".btnSelectServer").addEventListener("click",(function(){d.ZP.selectServer()})),e.addEventListener("viewshow",(function(){o.ZP.show(),s.Z.setTransparentMenu(!0),n.M.supports("multiserver")||e.querySelector(".btnSelectServer").classList.add("hide");var t=u();t.getQuickConnect("Enabled").then((function(t){!0===t&&e.querySelector(".btnQuick").classList.remove("hide")})).catch((function(){console.debug("Failed to get QuickConnect status")})),t.getPublicUsers().then((function(r){r.length?(m(),function(e,t,r){for(var n="",a=0;a<r.length;a++){var c=r[a],o="card squareCard scalableCard squareCard-scalable";i.Z.tv&&(o+=" show-focus",y&&(o+=" show-animation")),n+='<button type="button" class="'+o+'">',n+='<div class="cardBox cardBox-bottompadded">',n+='<div class="cardScalable">',n+='<div class="cardPadder cardPadder-square"></div>',n+='<div class="cardContent" data-haspw="'.concat(c.HasPassword,'" data-username="').concat(c.Name,'" data-userid="').concat(c.Id,'">'),c.PrimaryImageTag?n+='<div class="cardImageContainer coveredImage" style="background-image:url(\''+t.getUserImageUrl(c.Id,{width:300,tag:c.PrimaryImageTag,type:"Primary"})+"');\"></div>":(n+='<div class="cardImage flex align-items-center justify-content-center '.concat(h.default.getDefaultBackgroundClass(),'">'),n+='<span class="material-icons cardImageIcon person"></span>',n+="</div>"),n+="</div>",n+="</div>",n+='<div class="cardFooter visualCardBox-cardFooter">',n+='<div class="cardText singleCardText cardTextCentered">'+c.Name+"</div>",n+="</div>",n+="</div>",n+="</button>"}e.querySelector("#divUsers").innerHTML=n}(e,t,r)):(e.querySelector("#txtManualName").value="",b(e,!1,!1))})).catch().then((function(){o.ZP.hide()})),t.getJSON(t.getUrl("Branding/Configuration")).then((function(t){e.querySelector(".disclaimer").textContent=t.LoginDisclaimer||""}))})),e.addEventListener("viewhide",(function(){s.Z.setTransparentMenu(!1)}))}}}]);