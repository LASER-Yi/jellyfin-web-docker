/*! For license information please see 70538.23ea077c9a932337681d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[70538],{70538:function(e,t,n){n.r(t),n.d(t,{default:function(){return O},show:function(){return I}}),n(29305),n(32733),n(84701),n(2623),n(44962),n(17731),n(10849),n(70389),n(36947),n(26437),n(52697),n(78557),n(90076),n(50987),n(83994),n(82367);var r,o,a,i=n(22696),l=n.n(i),u=n(81273),s=n(75384),c=n(79754),d=n(36300),f=n(8566),p=n(10838),v=n(46782),b=n(5898),y=n(67430),h='<div class="formDialogHeader"> <button is="paper-icon-button-light" class="btnCancel autoSize" tabindex="-1" title="${ButtonBack}"><span class="material-icons arrow_back" aria-hidden="true"></span></button> <h3 class="formDialogHeaderTitle"> ${HeaderUploadSubtitle} </h3> </div> <div class="formDialogContent"> <div class="dialogContentInner"> <form class="uploadSubtitleForm"> <div class="flex align-items-center" style="margin:1.5em 0"> <h2 style="margin:0">${HeaderAddUpdateSubtitle}</h2> <button is="emby-button" type="button" class="raised raised-mini btnBrowse"> <span class="material-icons folder" aria-hidden="true"></span> <span>${Browse}</span> </button> </div> <div> <div class="subtitleEditor-dropZone fieldDescription"> <div id="labelDropSubtitle">${LabelDropSubtitleHere}</div> <output id="subtitleOutput" class="flex align-items-center justify-content-center" style="position:absolute;top:0;left:0;right:0;bottom:0;width:100%"></output> <input type="file" accept=".sub,.srt,.vtt,.ass,.ssa,.mks" id="uploadSubtitle" name="uploadSubtitle" style="position:absolute;top:0;left:0;right:0;bottom:0;width:100%;opacity:0"/> </div> <div id="fldUpload" class="hide"> <br/> <div class="checkboxContainer"> <label> <input type="checkbox" is="emby-checkbox" id="chkIsForced"/> <span>${LabelIsForced}</span> </label> <label> <input type="checkbox" is="emby-checkbox" id="chkIsHearingImpaired"/> <span>${LabelIsHearingImpaired}</span> </label> </div> <div class="selectContainer flex-grow"> <select is="emby-select" id="selectLanguage" required="required" label="${LabelLanguage}"></select> </div> <button is="emby-button" type="submit" class="raised button-submit block"> <span>${Upload}</span> </button> </div> </div> </form> </div> </div> ',m=n(71866),g=(n(10353),n(63001),n(76562));function S(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof l?r:l,s=Object.create(u.prototype);return w(s,"_invoke",function(n,r,o){var a,l,u,s=0,c=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,l=0,u=e,f.n=n,i}};function p(n,r){for(l=n,u=r,t=0;!d&&s&&!o&&t<c.length;t++){var o,a=c[t],p=f.p,v=a[2];n>3?(o=v===r)&&(u=a[(l=a[4])?5:(l=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(l=0,f.v=r,f.n=a[1]):p<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,f.n=v,l=0))}if(o||n>1)return i;throw d=!0,r}return function(o,c,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===c&&p(c,v),l=c,u=v;(t=l<2?e:u)||!d;){a||(l?l<3?(l>1&&(f.n=-1),p(l,u)):f.n=u:f.v=u);try{if(s=2,a){if(l||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,l<2&&(l=0)}else 1===l&&(t=a.return)&&t.call(a),l<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),l=1);a=e}else if((t=(d=f.n<0)?u:n.call(r,f))!==i)break}catch(t){a=e,l=1,u=t}finally{s=1}}return{value:t,done:d}}}(n,o,a),!0),s}var i={};function l(){}function u(){}function s(){}t=Object.getPrototypeOf;var c=[][r]?t(t([][r]())):(w(t={},r,(function(){return this})),t),d=s.prototype=l.prototype=Object.create(c);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,w(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return u.prototype=s,w(d,"constructor",s),w(s,"constructor",u),u.displayName="GeneratorFunction",w(s,o,"GeneratorFunction"),w(d),w(d,o,"Generator"),w(d,r,(function(){return this})),w(d,"toString",(function(){return"[object Generator]"})),(S=function(){return{w:a,m:f}})()}function w(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}w=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){w(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}},w(e,t,n,r)}function L(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):Promise.resolve(u).then(r,o)}var k=!1;function A(e){f.Ay.hide();var t=e.target.error;t.code!==t.ABORT_ERR&&(0,m.A)(b.Ay.translate("MessageFileReadError"))}function F(e){return e&&[".sub",".srt",".vtt",".ass",".ssa",".mks"].some((function(t){return e.name.endsWith(t)}))}function q(e){return D.apply(this,arguments)}function D(){var e;return e=S().m((function e(t){var n,i,l,p,v,h,w,L;return S().w((function(e){for(;;)switch(e.n){case 0:if(F(n=a)){e.n=1;break}return(0,m.A)(b.Ay.translate("MessageSubtitleFileTypeAllowed")),t.preventDefault(),e.a(2);case 1:return f.Ay.show(),i=d.Ay.parentWithClass(this,"dialog"),l=i.querySelector("#selectLanguage").value,p=i.querySelector("#chkIsForced").checked,v=i.querySelector("#chkIsHearingImpaired").checked,h=(0,u.L)((0,s.C)(y.tF.getApiClient(o))),e.n=2,(0,g.We)(n);case 2:w=e.v,L=n.name.substring(n.name.lastIndexOf(".")+1).toLowerCase(),h.uploadSubtitle({itemId:r,uploadSubtitleDto:{Data:w,Language:l,IsForced:p,Format:L,IsHearingImpaired:v}}).then((function(){i.querySelector("#uploadSubtitle").value="",f.Ay.hide(),k=!0,c.default.close(i)})),t.preventDefault();case 3:return e.a(2)}}),e,this)})),D=function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){L(a,r,o,i,l,"next",e)}function l(e){L(a,r,o,i,l,"throw",e)}i(void 0)}))},D.apply(this,arguments)}function I(e){return new Promise((function(t){k=!1,function(e,t){r=(e=e||{}).itemId,o=e.serverId;var n={removeOnClose:!0,scrollY:!1};v.A.tv?n.size="fullscreen":n.size="small";var i,u=c.default.createDialog(n);u.classList.add("formDialog"),u.classList.add("subtitleUploaderDialog"),u.innerHTML=b.Ay.translateHtml(h,"core"),v.A.tv&&p.default.centerFocus.on(u,!1),u.addEventListener("close",(function(){v.A.tv&&p.default.centerFocus.off(u,!1),f.Ay.hide(),t(k)})),c.default.open(u),(i=u).querySelector(".uploadSubtitleForm").addEventListener("submit",q),i.querySelector("#uploadSubtitle").addEventListener("change",(function(){!function(e,t){var n=t[0];if(!F(n))return e.querySelector("#subtitleOutput").innerHTML="",e.querySelector("#fldUpload").classList.add("hide"),e.querySelector("#labelDropSubtitle").classList.remove("hide"),void(a=null);a=n;var r,o=new FileReader;o.onerror=A,o.onloadstart=function(){e.querySelector("#fldUpload").classList.add("hide")},o.onabort=function(){f.Ay.hide(),console.debug("File read cancelled")},o.onload=(r=n,function(){var t='<div><span class="material-icons subtitles" aria-hidden="true" style="transform: translateY(25%);"></span><span>'.concat(l()(r.name),"</span></div>");e.querySelector("#subtitleOutput").innerHTML=t,e.querySelector("#fldUpload").classList.remove("hide"),e.querySelector("#labelDropSubtitle").classList.add("hide")}),o.readAsDataURL(n)}(i,this.files)})),i.querySelector(".btnBrowse").addEventListener("click",(function(){i.querySelector("#uploadSubtitle").click()}));var s=u.querySelector("#selectLanguage");e.languages&&(s.innerHTML=e.languages.list||null,s.value=e.languages.value||null),u.querySelector(".btnCancel").addEventListener("click",(function(){c.default.close(u)}))}(e,t)}))}var O={show:I}},76562:function(e,t,n){function r(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var n,r,o,a=null===(o=null===(r=null===(n=e.target)||void 0===n?void 0:n.result)||void 0===r?void 0:r.split)||void 0===o?void 0:o.call(r,",")[1];t(a)},r.onerror=n,r.readAsDataURL(e)}))}function o(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var n,r=null===(n=e.target)||void 0===n?void 0:n.result;t(r)},r.onerror=n,r.readAsText(e)}))}function a(e,t){void 0===t&&(t=1);var n=Math.log(e)/Math.log(1024)|0;return(e/Math.pow(1024,n)).toFixed(t)+" "+(n?"KMGTPEZY"[--n]+"iB":"Bytes")}n.d(t,{Qv:function(){return o},We:function(){return r},iJ:function(){return a}})}}]);