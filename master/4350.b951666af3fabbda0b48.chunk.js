"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4350,76542],{4350:function(e,t,a){a.r(t),a.d(t,{default:function(){return M},show:function(){return T}}),a(14382),a(44962),a(26448),a(78557),a(96054),a(90076),a(83994),a(82367);var n,r=a(97339),i=a(79754),o=a(8566),s=a(47629),l=a(46782),d=a(9164),c=a(5898),u=a(67430),m=a(10838),h=a(76542),g=a(34789),f=a(22622),v=(a(10353),a(15453),a(41177)),b=a(47602),p='<div class="formDialogHeader"> <button is="paper-icon-button-light" class="btnCancel autoSize" tabindex="-1" title="${ButtonBack}"><span class="material-icons arrow_back" aria-hidden="true"></span></button> <h3 class="formDialogHeaderTitle"> ${HeaderEditImages} </h3> </div> <div class="formDialogContent smoothScrollY"> <div class="dialogContentInner"> <div id="imagesContainer"> <div class="imageEditor-buttons first-imageEditor-buttons"> <h2 style="margin:0">${Images}</h2> <button type="button" is="emby-button" class="btnBrowseAllImages fab mini autoSize"> <span class="material-icons search" aria-hidden="true"></span> </button> <button type="button" is="emby-button" class="btnOpenUploadMenu fab mini hide"> <span class="material-icons add" aria-hidden="true"></span> </button> </div> <div id="images" class="itemsContainer vertical-wrap"> </div> <br/> </div> <div id="backdropsContainer" class="hide"> <div class="imageEditor-buttons"> <h2 style="margin:0">${Backdrops}</h2> <button type="button" is="emby-button" class="btnBrowseAllImages fab mini autoSize" data-imagetype="Backdrop"> <span class="material-icons search" aria-hidden="true"></span> </button> <button type="button" is="emby-button" class="btnOpenUploadMenu fab mini hide" data-imagetype="Backdrop"> <span class="material-icons add" aria-hidden="true"></span> </button> </div> <div id="backdrops" class="itemsContainer vertical-wrap"> </div> <br/> </div> </div> </div> ',y=!g.A.slow&&!g.A.edge,I=!1;function A(e,t,a){var r;o.Ay.show(),t?(r=u.tF.getApiClient(t.ServerId),S(e,t,r,a)):(r=u.tF.getApiClient(n.ServerId)).getItem(r.getCurrentUserId(),n.Id).then((function(t){S(e,t,r,a)}))}function C(e,t,a,n){e.addEventListener(a,(function(e){var a=s.Ay.parentWithClass(e.target,t);a&&n.call(a,e)}))}function S(e,t,a,r){n=t,a.getRemoteImageProviders({itemId:n.Id}).then((function(t){for(var i=e.querySelectorAll(".btnBrowseAllImages"),s=0,c=i.length;s<c;s++)t.length?i[s].classList.remove("hide"):i[s].classList.add("hide");a.getItemImageInfos(n.Id).then((function(n){!function(e,t,a,n,r){var i=n.filter((function(e){return"Backdrop"!==e.ImageType&&"Chapter"!==e.ImageType}));L(0,0,t,i,r,e.querySelector("#images"))}(e,a,0,n,t),function(e,t,a,n,r){var i=n.filter((function(e){return"Backdrop"===e.ImageType})).sort((function(e,t){return e.ImageIndex-t.ImageIndex}));i.length?(e.querySelector("#backdropsContainer",e).classList.remove("hide"),L(0,0,t,i,r,e.querySelector("#backdrops"))):e.querySelector("#backdropsContainer",e).classList.add("hide")}(e,a,0,n,t),o.Ay.hide(),l.A.tv&&d.A.autoFocus(r||e)}))}))}function k(e,t,a){var r="",i="card scalableCard imageEditorCard";i+=" backdropCard backdropCard-scalable","button"===a.tagName?(i+=" btnImageCard",l.A.tv&&(i+=" show-focus",y&&(i+=" show-animation")),r+='<button type="button" class="'+i+'"'):r+='<div class="'+i+'"',r+=' data-id="'+n.Id+'" data-serverid="'+t.serverId()+'" data-index="'+a.index+'" data-numimages="'+a.numImages+'" data-imagetype="'+e.ImageType+'" data-providers="'+a.imageProviders.length+'"',r+=">",r+='<div class="cardBox visualCardBox">',r+='<div class="cardScalable visualCardBox-cardScalable" style="background-color:transparent;">',r+='<div class="cardPadder-backdrop"></div>',r+='<div class="cardContent">';var o=function(e,t,a,n,r){return(r=r||{}).type=a,r.index=n,r.tag="Backdrop"===a?e.BackdropImageTags[n]:"Primary"===a&&e.PrimaryImageTag||e.ImageTags[a],t.getScaledImageUrl(e.Id||e.ItemId,r)}(n,t,e.ImageType,e.ImageIndex,{maxWidth:a.imageSize});return r+='<div class="cardImageContainer" style="background-image:url(\''+o+"');background-position:center center;background-size:contain;\"></div>",r+="</div>",r+="</div>",r+='<div class="cardFooter visualCardBox-cardFooter">',r+='<h3 class="cardText cardTextCentered" style="margin:0;">'+c.Ay.translate(""+e.ImageType)+"</h3>",r+='<div class="cardText cardText-secondary cardTextCentered">',e.Width&&e.Height?r+=e.Width+" X "+e.Height:r+="&nbsp;",r+="</div>",a.enableFooterButtons&&(r+='<div class="cardText cardTextCentered">',"Backdrop"===e.ImageType?(a.index>0?r+='<button type="button" is="paper-icon-button-light" class="btnMoveImage autoSize" data-imagetype="'+e.ImageType+'" data-index="'+e.ImageIndex+'" data-newindex="'+(e.ImageIndex-1)+'" title="'+c.Ay.translate("MoveLeft")+'"><span class="material-icons chevron_left"></span></button>':r+='<button type="button" is="paper-icon-button-light" class="autoSize" disabled title="'+c.Ay.translate("MoveLeft")+'"><span class="material-icons chevron_left" aria-hidden="true"></span></button>',a.index<a.numImages-1?r+='<button type="button" is="paper-icon-button-light" class="btnMoveImage autoSize" data-imagetype="'+e.ImageType+'" data-index="'+e.ImageIndex+'" data-newindex="'+(e.ImageIndex+1)+'" title="'+c.Ay.translate("MoveRight")+'"><span class="material-icons chevron_right" aria-hidden="true"></span></button>':r+='<button type="button" is="paper-icon-button-light" class="autoSize" disabled title="'+c.Ay.translate("MoveRight")+'"><span class="material-icons chevron_right" aria-hidden="true"></span></button>'):a.imageProviders.length&&(r+='<button type="button" is="paper-icon-button-light" data-imagetype="'+e.ImageType+'" class="btnSearchImages autoSize" title="'+c.Ay.translate("Search")+'"><span class="material-icons search" aria-hidden="true"></span></button>'),r+='<button type="button" is="paper-icon-button-light" data-imagetype="'+e.ImageType+'" data-index="'+(null!=e.ImageIndex?e.ImageIndex:"null")+'" class="btnDeleteImage autoSize" title="'+c.Ay.translate("Delete")+'"><span class="material-icons delete" aria-hidden="true"></span></button>',r+="</div>"),r+="</div>",(r+="</div>")+"</"+a.tagName+">"}function w(e,t,a,n,r,i){var o=function(){r.deleteItemImage(t,a,n).then((function(){I=!0,A(e)}))};i?(0,b.A)({text:c.Ay.translate("ConfirmDeleteImage"),confirmText:c.Ay.translate("Delete"),primary:"delete"}).then(o):o()}function x(e,t,a,n,r,i,o){t.updateItemImageIndex(a,n,r,i).then((function(){I=!0,A(e,null,o)}),(function(){(0,v.A)(c.Ay.translate("ErrorDefault"))}))}function L(e,t,a,n,r,i){var o="",d=300,c=s.Ay.getWindowSize();c.innerWidth>=1280&&(d=Math.round(c.innerWidth/4));for(var u=l.A.tv?"button":"div",m=!l.A.tv,g=0,f=n.length;g<f;g++)o+=k(n[g],a,{index:g,numImages:f,imageProviders:r,imageSize:d,tagName:u,enableFooterButtons:m});i.innerHTML=o,h.default.lazyChildren(i)}function z(e,t){a.e(48232).then(a.bind(a,48232)).then((function(a){a.show(n.Id,n.ServerId,n.Type,t,"Season"==n.Type?n.ParentId:null).then((function(){I=!0,A(e)})).catch((function(){}))}))}function T(e){return new Promise((function(t,d){I=!1,function(e,t,d){var h=e.itemId,g=e.serverId;o.Ay.show();var v=u.tF.getApiClient(g);v.getItem(v.getCurrentUserId(),h).then((function(h){var g={removeOnClose:!0};l.A.tv?g.size="fullscreen":g.size="small";var v=i.default.createDialog(g);v.classList.add("formDialog"),v.innerHTML=c.Ay.translateHtml(p,"core"),l.A.tv&&m.default.centerFocus.on(v,!1),function(e,t){for(var i=e.querySelectorAll(".btnOpenUploadMenu"),o=f.g.supports(r.Y.FileInput),l=0,d=i.length;l<d;l++)o?i[l].classList.remove("hide"):i[l].classList.add("hide");C(e,"btnOpenUploadMenu","click",(function(){var r=this.getAttribute("data-imagetype");a.e(61989).then(a.bind(a,61989)).then((function(a){a.default.show({theme:t.theme,imageType:r,itemId:n.Id,serverId:n.ServerId}).then((function(t){t&&(I=!0,A(e))}))}))})),C(e,"btnSearchImages","click",(function(){z(e,this.getAttribute("data-imagetype"))})),C(e,"btnBrowseAllImages","click",(function(){z(e,this.getAttribute("data-imagetype")||"Primary")})),C(e,"btnImageCard","click",(function(){!function(e,t){var n=t.getAttribute("data-id"),r=t.getAttribute("data-serverid"),i=u.tF.getApiClient(r),o=t.getAttribute("data-imagetype"),l=parseInt(t.getAttribute("data-index"),10),d=parseInt(t.getAttribute("data-providers"),10),m=parseInt(t.getAttribute("data-numimages"),10);a.e(62882).then(a.bind(a,62882)).then((function(a){var r=a.default,u=[];u.push({name:c.Ay.translate("Delete"),id:"delete"}),"Backdrop"===o&&(l>0&&u.push({name:c.Ay.translate("MoveLeft"),id:"moveleft"}),l<m-1&&u.push({name:c.Ay.translate("MoveRight"),id:"moveright"})),d&&u.push({name:c.Ay.translate("Search"),id:"search"}),r.show({items:u,positionTo:t}).then((function(a){switch(a){case"delete":w(e,n,o,l,i,!1);break;case"search":z(e,o);break;case"moveleft":x(e,i,n,o,l,l-1,s.Ay.parentWithClass(t,"itemsContainer"));break;case"moveright":x(e,i,n,o,l,l+1,s.Ay.parentWithClass(t,"itemsContainer"))}}))}))}(e,this)})),C(e,"btnDeleteImage","click",(function(){var t=this.getAttribute("data-imagetype"),a=this.getAttribute("data-index");a="null"===a?null:parseInt(a,10);var r=u.tF.getApiClient(n.ServerId);w(e,n.Id,t,a,r,!0)})),C(e,"btnMoveImage","click",(function(){var t=this.getAttribute("data-imagetype"),a=this.getAttribute("data-index"),r=this.getAttribute("data-newindex"),i=u.tF.getApiClient(n.ServerId);x(e,i,n.Id,t,a,r,s.Ay.parentWithClass(this,"itemsContainer"))}))}(v,e),v.addEventListener("close",(function(){l.A.tv&&m.default.centerFocus.off(v,!1),o.Ay.hide(),I?t():d()})),i.default.open(v),A(v,h),v.querySelector(".btnCancel").addEventListener("click",(function(){i.default.close(v)}))}))}(e,t,d)}))}var M={show:T}},76542:function(e,t,a){a.r(t),a.d(t,{default:function(){return y},fillImage:function(){return m},fillImages:function(){return b},getPrimaryImageAspectRatio:function(){return v},lazyChildren:function(){return f},lazyImage:function(){return d},setLazyImage:function(){return p}}),a(29305),a(32733),a(84701),a(14382),a(69892),a(44962),a(89336),a(26448),a(78557),a(95021),a(73687),a(83994),a(93062),a(82367);var n=a(99891),r=a(82885);function i(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return o(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,i=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw i}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var s=new function(){return new Worker(a.p+"blurhash.worker.bundle.js")},l={};function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getAttribute("data-src");t&&g(e,t)}function c(e,t,a,n){var r=document.createElement("canvas");r.setAttribute("aria-hidden","true"),r.width=a,r.height=n;var i=r.getContext("2d"),o=i.createImageData(a,n);o.data.set(t),i.putImageData(o,0,0),requestAnimationFrame((function(){r.classList.add("blurhash-canvas"),e.parentNode.insertBefore(r,e),e.classList.add("blurhashed"),e.removeAttribute("data-blurhash")}))}function u(e,t){try{l[t]=(l[t]||[]).filter((function(t){return t!==e})),l[t].push(e),s.postMessage({hash:t,width:20,height:20})}catch(t){return console.error(t),void e.classList.add("non-blurhashable")}}function m(e){if(!e)throw new Error("entry cannot be null");var t,a=e.target;t=a?a.getAttribute("data-src"):e,e.isIntersecting?t&&g(a,t):t||function(e){var t;e.removeEventListener("animationend",h);var a,n=e.previousSibling;"CANVAS"===(null==n?void 0:n.tagName)&&n.classList.remove("lazy-hidden"),null===(t=e.parentNode)||void 0===t||null===(t=t.querySelector(".cardPadder"))||void 0===t||t.classList.remove("lazy-hidden-children"),"IMG"!==e.tagName?(a=e.style.backgroundImage.slice(4,-1).replace(/"/g,""),e.style.backgroundImage="none"):(a=e.getAttribute("src"),e.setAttribute("src","")),e.setAttribute("data-src",a),e.classList.remove("lazy-image-fadein-fast","lazy-image-fadein"),e.classList.add("lazy-hidden")}(a)}function h(e){var t=e.target;requestAnimationFrame((function(){var e,a=t.previousSibling;t.classList.contains("blurhashed")&&"CANVAS"===(null==a?void 0:a.tagName)&&a.classList.add("lazy-hidden"),null===(e=t.parentNode)||void 0===e||null===(e=e.querySelector(".cardPadder"))||void 0===e||e.classList.add("lazy-hidden-children")})),t.removeEventListener("animationend",h)}function g(e,t){if(void 0===t)throw new TypeError("url cannot be undefined");var a=new Image;a.src=t,e.classList.add("lazy-hidden"),e.addEventListener("animationend",h),a.addEventListener("load",(function(){requestAnimationFrame((function(){"IMG"!==e.tagName?e.style.backgroundImage="url('"+t+"')":e.setAttribute("src",t),e.removeAttribute("data-src"),r.enableFastFadein()?e.classList.add("lazy-image-fadein-fast"):e.classList.add("lazy-image-fadein"),e.classList.remove("lazy-hidden")}))}))}function f(e){if(r.enableBlurhash()){var t,a=i(e.querySelectorAll(".lazy"));try{for(a.s();!(t=a.n()).done;){var o=t.value,s=o.getAttribute("data-blurhash");!o.classList.contains("blurhashed","non-blurhashable")&&s?u(o,s):s||o.classList.contains("blurhashed")||o.classList.add("non-blurhashable")}}catch(e){a.e(e)}finally{a.f()}}n.WK(e,m)}function v(e){for(var t=[],a=0,n=e.length;a<n;a++){var r=e[a].PrimaryImageAspectRatio||0;r&&(t[t.length]=r)}if(!t.length)return null;t.sort((function(e,t){return e-t}));var i,o=Math.floor(t.length/2);i=t.length%2?t[o]:(t[o-1]+t[o])/2;var s=2/3;if(Math.abs(s-i)<=.15)return s;var l=16/9;if(Math.abs(l-i)<=.2)return l;if(Math.abs(1-i)<=.15)return 1;var d=4/3;return Math.abs(d-i)<=.15?d:i}function b(e){for(var t=0,a=e.length;t<a;t++)m(e[0])}function p(e,t){e.classList.add("lazy"),e.setAttribute("data-src",t),d(e)}s.addEventListener("message",(function(e){var t=e.data,a=t.pixels,n=t.hsh,r=t.width,o=t.height,s=l[n];if(null!=s&&s.length){var d,u=i(s);try{for(u.s();!(d=u.n()).done;)c(d.value,a,r,o)}catch(e){u.e(e)}finally{u.f()}delete l[n]}}));var y={setLazyImage:p,fillImages:b,fillImage:m,lazyImage:d,lazyChildren:f,getPrimaryImageAspectRatio:v}},99891:function(e,t,a){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}a.d(t,{WK:function(){return s}}),a(29305),a(32733),a(84701),a(81678),a(69892),a(44962),a(4754),a(94),a(36947),a(78557),a(83994),a(23630),a(82367);var o=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t},(t=[{key:"createObserver",value:function(){var e=this.options.callback,t=new IntersectionObserver((function(t,a){t.forEach((function(t){e(t,a)}))}),{rootMargin:"50%",threshold:0});this.observer=t}},{key:"addElements",value:function(e){var t=this.observer;t||(this.createObserver(),t=this.observer),Array.from(e).forEach((function(e){t.observe(e)}))}},{key:"destroyObserver",value:function(){var e=this.observer;e&&(e.disconnect(),this.observer=null)}},{key:"destroy",value:function(){this.destroyObserver(),this.options=null}}])&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();function s(e,t){!function(e,t,a){e.length&&new o({callback:a}).addElements(e)}(e.getElementsByClassName("lazy"),0,t)}t.Ay={LazyLoader:o,lazyChildren:s}}}]);