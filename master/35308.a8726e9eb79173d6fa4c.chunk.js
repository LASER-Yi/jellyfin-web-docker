"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[35308],{35308:function(e,t,n){n.r(t),n.d(t,{default:function(){return E},startMultiSelect:function(){return I},stopMultiSelect:function(){return P}}),n(24776),n(14382),n(76281),n(44962),n(86584),n(89336),n(78557),n(90076),n(99425),n(83994),n(23630),n(82367);var a,i=n(97339),r=n(34789),o=n(22622),c=n(8566),l=n(5898),s=n(67430),u=n(36300),d=n(41177),h=n(47602),v=n(23648),f=n(98320),m=[],p=[];function y(){var e=a;if(e){e.parentNode.removeChild(e),a=null,m=[],p=[];for(var t=document.querySelectorAll(".itemSelectionPanel"),n=0,i=t.length;n<i;n++){var r=t[n].parentNode;r.removeChild(t[n]),r.classList.remove("withMultiSelect")}}}function A(e,t){var n=u.Ay.parentWithAttribute(e,"data-id").getAttribute("data-id");if(t?m.filter((function(e){return e===n})).length||(m.push(n),p.push(e)):(m=m.filter((function(e){return e!==n})),p=p.filter((function(t){return t!==e}))),m.length){var a=document.querySelector(".itemSelectionCount");a&&(a.innerHTML=f.Ay.toLocaleString(m.length))}else y()}function k(){A(this,this.checked)}function b(e,t,n){var a=e.querySelector(".itemSelectionPanel");if(!a){(a=document.createElement("div")).classList.add("itemSelectionPanel");var i=e.querySelector(".cardBox")||e.querySelector(".cardContent");i.classList.add("withMultiSelect"),i.appendChild(a);var r="chkItemSelect";t&&n&&(r+=" checkedInitial");var o=t?" checked":"";a.innerHTML='<label class="checkboxContainer"><input type="checkbox" is="emby-checkbox" data-outlineclass="multiSelectCheckboxOutline" class="'.concat(r,'"').concat(o,"/><span></span></label>"),a.querySelector(".chkItemSelect").addEventListener("change",k)}}function g(e){var t=s.tF.currentApiClient();t.getCurrentUser().then((function(a){t.getItem(t.getCurrentUserId(),m[0]).then((function(r){var s=[];s.push({name:l.Ay.translate("SelectAll"),id:"selectall",icon:"select_all"}),s.push({name:l.Ay.translate("AddToCollection"),id:"addtocollection",icon:"add"}),s.push({name:l.Ay.translate("AddToPlaylist"),id:"playlist",icon:"playlist_add"}),a.Policy.EnableContentDeletion&&s.push({name:l.Ay.translate("Delete"),id:"delete",icon:"delete"}),a.Policy.EnableContentDownloading&&o.g.supports(i.Y.FileDownload),a.Policy.IsAdministrator&&s.push({name:l.Ay.translate("GroupVersions"),id:"groupvideos",icon:"call_merge"}),s.push({name:l.Ay.translate("MarkPlayed"),id:"markplayed",icon:"check_box"}),s.push({name:l.Ay.translate("MarkUnplayed"),id:"markunplayed",icon:"check_box_outline_blank"}),v.Ay.canRefreshMetadata(r,a)&&s.push({name:l.Ay.translate("RefreshMetadata"),id:"refresh",icon:"refresh"}),n.e(62882).then(n.bind(n,62882)).then((function(a){a.show({items:s,positionTo:e.target,callback:function(e){var a=m.slice(0),i=t.serverInfo().Id;switch(e){case"selectall":for(var r=document.querySelectorAll(".itemSelectionPanel"),o=0,s=r.length;o<s;o++){var u=r[o].querySelector(".chkItemSelect");!u||u.classList.contains("checkedInitial")||u.checked||0==u.getBoundingClientRect().width||(u.checked=!0,A(u,!0))}break;case"addtocollection":n.e(3380).then(n.bind(n,3380)).then((function(e){(new(0,e.default)).show({items:a,serverId:i})})),y(),S();break;case"playlist":Promise.all([n.e(45642),n.e(81949)]).then(n.bind(n,4330)).then((function(e){(new(0,e.default)).show({items:a,serverId:i}).catch((function(){}))})).catch((function(e){console.error("[AddToPlaylist] failed to load playlist editor",e)})),y(),S();break;case"delete":(function(e,t){return new Promise((function(n,a){var i=l.Ay.translate("ConfirmDeleteItem"),r=l.Ay.translate("HeaderDeleteItem");t.length>1&&(i=l.Ay.translate("ConfirmDeleteItems"),r=l.Ay.translate("HeaderDeleteItems")),(0,h.A)(i,r).then((function(){var i=t.map((function(t){return e.deleteItem(t)}));Promise.all(i).then(n,(function(){var e;(e=l.Ay.translate("ErrorDeletingItem"),new Promise((function(t){(0,d.A)(e).then(t,t)}))).then(a,a)}))}),a)}))})(t,a).then(S),y(),S();break;case"groupvideos":!function(e,t){t.length<2?(0,d.A)({text:l.Ay.translate("PleaseSelectTwoItems")}):(c.Ay.show(),e.ajax({type:"POST",url:e.getUrl("Videos/MergeVersions",{Ids:t.join(",")})}).then((function(){c.Ay.hide(),y(),S()})))}(t,a);break;case"markplayed":a.forEach((function(e){t.markPlayed(t.getCurrentUserId(),e)})),y(),S();break;case"markunplayed":a.forEach((function(e){t.markUnplayed(t.getCurrentUserId(),e)})),y(),S();break;case"refresh":n.e(77004).then(n.bind(n,77004)).then((function(e){new(0,e.default)({itemIds:a,serverId:i}).show()})),y(),S()}}})}))}))}))}function S(){var e=[];[].forEach.call(p,(function(t){var n=u.Ay.parentWithAttribute(t,"is","emby-itemscontainer");n&&!e.includes(n)&&e.push(n)}));for(var t=0,n=e.length;t<n;t++)e[t].notifyRefreshNeeded(!0)}function C(e,t){Promise.resolve().then(n.bind(n,77157)).then((function(){for(var n=document.querySelectorAll(".card"),i=0,r=n.length;i<r;i++)b(n[i],e===n[i],t);!function(){var e=a;if(!e){(e=document.createElement("div")).classList.add("selectionCommandsPanel"),document.body.appendChild(e),a=e;var t="";t+='<button is="paper-icon-button-light" class="btnCloseSelectionPanel autoSize"><span class="material-icons close" aria-hidden="true"></span></button>',t+='<h1 class="itemSelectionCount"></h1>',t+='<button is="paper-icon-button-light" class="btnSelectionPanelOptions autoSize"><span class="material-icons '.concat("more_vert",'" aria-hidden="true"></span></button>'),e.innerHTML=t,e.querySelector(".btnCloseSelectionPanel").addEventListener("click",y);var n=e.querySelector(".btnSelectionPanelOptions");u.Ay.addEventListener(n,"click",g,{passive:!0})}}(),A(e,!0)}))}function L(e){var t=e.target;if(m.length){var n=u.Ay.parentWithClass(t,"card");if(n){var a=n.querySelector(".itemSelectionPanel");if(a)return function(e,t){if(!u.Ay.parentWithClass(e.target,"chkItemSelect")){var n=t.querySelector(".chkItemSelect");if(n)if(n.classList.contains("checkedInitial"))n.classList.remove("checkedInitial");else{var a=!n.checked;n.checked=a,A(n,a)}}return e.preventDefault(),e.stopPropagation(),!1}(e,a)}return e.preventDefault(),e.stopPropagation(),!1}}function E(e){var t,n,a,i,o,c=e.container;function l(e){var t=u.Ay.parentWithClass(e.target,"card");return t&&C(t,!0),e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function s(e){return e.changedTouches||e.targetTouches||e.touches}function d(e){var r=s(e)[0];if(t=null,a=0,i=0,r){a=r.clientX,i=r.clientY;var o=r.target;if(o){var c=u.Ay.parentWithClass(o,"card");c&&(n&&(clearTimeout(n),n=null),t=c,n=setTimeout(p,550))}}}function h(e){if(t){var n,r,o=s(e)[0];if(o){var c=o.clientX||0,l=o.clientY||0;n=Math.abs(c-(a||0)),r=Math.abs(l-(i||0))}else n=100,r=100;(n>=5||r>=5)&&m()}}function v(){m()}function f(e){n&&(clearTimeout(n),n=null),t=e.target,n=setTimeout(p,550)}function m(){n&&(clearTimeout(n),n=null),t=null}function p(){if(t){var e=u.Ay.parentWithClass(t,"card");t=null,e&&C(e,!0)}}o=c,r.A.touch&&!r.A.safari?o.addEventListener("contextmenu",l):(u.Ay.addEventListener(o,"touchstart",d,{passive:!0}),u.Ay.addEventListener(o,"touchmove",h,{passive:!0}),u.Ay.addEventListener(o,"touchend",v,{passive:!0}),u.Ay.addEventListener(o,"touchcancel",v,{passive:!0}),u.Ay.addEventListener(o,"mousedown",f,{passive:!0}),u.Ay.addEventListener(o,"mouseleave",m,{passive:!0}),u.Ay.addEventListener(o,"mouseup",m,{passive:!0})),!1!==e.bindOnClick&&c.addEventListener("click",L),this.onContainerClick=L,this.destroy=function(){c.removeEventListener("click",L),c.removeEventListener("contextmenu",l);var e=c;u.Ay.removeEventListener(e,"touchstart",d,{passive:!0}),u.Ay.removeEventListener(e,"touchmove",h,{passive:!0}),u.Ay.removeEventListener(e,"touchend",v,{passive:!0}),u.Ay.removeEventListener(e,"mousedown",f,{passive:!0}),u.Ay.removeEventListener(e,"mouseleave",m,{passive:!0}),u.Ay.removeEventListener(e,"mouseup",m,{passive:!0})}}document.addEventListener("viewbeforehide",y);var I=function(e){C(e,!1)},P=function(){y()}}}]);