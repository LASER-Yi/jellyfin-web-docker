"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1075],{31075:function(e,t,a){a.r(t),a.d(t,{default:function(){return y},show:function(){return g}}),a(63238),a(95289),a(61418);var l,i,s,n=a(93355),r=a(18613),o=a(72365),u=a(28540),d=a(15723),c=a(30325),b=a(94994),p=a(56663),f=(a(38228),a(15856),!1);function v(e){u.ZP.hide();var t=e.target.error;t.code!==t.ABORT_ERR&&(0,p.Z)(b.ZP.translate("MessageFileReadError"))}function h(e){return e&&[".sub",".srt",".vtt",".ass",".ssa"].some((function(t){return e.name.endsWith(t)}))}function m(e){var t=s;if(!h(t))return(0,p.Z)(b.ZP.translate("MessageSubtitleFileTypeAllowed")),void e.preventDefault();u.ZP.show();var a=o.ZP.parentWithClass(this,"dialog"),d=a.querySelector("#selectLanguage").value,c=a.querySelector("#chkIsForced").checked;r.Z.getApiClient(i).uploadItemSubtitle(l,d,c,t).then((function(){a.querySelector("#uploadSubtitle").value="",u.ZP.hide(),f=!0,n.default.close(a)})),e.preventDefault()}function g(e){return new Promise((function(t){f=!1,function(e,t){l=(e=e||{}).itemId,i=e.serverId;var a={removeOnClose:!0,scrollY:!1};c.Z.tv?a.size="fullscreen":a.size="small";var r,o=n.default.createDialog(a);o.classList.add("formDialog"),o.classList.add("subtitleUploaderDialog"),o.innerHTML=b.ZP.translateHtml('<div class="formDialogHeader"> <button is="paper-icon-button-light" class="btnCancel autoSize" tabindex="-1" title="${ButtonBack}"><span class="material-icons arrow_back" aria-hidden="true"></span></button> <h3 class="formDialogHeaderTitle"> ${HeaderUploadSubtitle} </h3> </div> <div class="formDialogContent"> <div class="dialogContentInner"> <form class="uploadSubtitleForm"> <div class="flex align-items-center" style="margin:1.5em 0"> <h2 style="margin:0">${HeaderAddUpdateSubtitle}</h2> <button is="emby-button" type="button" class="raised raised-mini btnBrowse"> <span class="material-icons folder" aria-hidden="true"></span> <span>${Browse}</span> </button> </div> <div> <div class="subtitleEditor-dropZone fieldDescription"> <div id="labelDropSubtitle">${LabelDropSubtitleHere}</div> <output id="subtitleOutput" class="flex align-items-center justify-content-center" style="position:absolute;top:0;left:0;right:0;bottom:0;width:100%"></output> <input type="file" accept=".sub,.srt,.vtt,.ass,.ssa" id="uploadSubtitle" name="uploadSubtitle" style="position:absolute;top:0;left:0;right:0;bottom:0;width:100%;opacity:0"/> </div> <div id="fldUpload" class="hide"> <br/> <div class="checkboxContainer"> <label> <input type="checkbox" is="emby-checkbox" id="chkIsForced"/> <span>${LabelIsForced}</span> </label> </div> <div class="selectContainer flex-grow"> <select is="emby-select" id="selectLanguage" required="required" label="${LabelLanguage}" autofocus></select> </div> <button is="emby-button" type="submit" class="raised button-submit block"> <span>${Upload}</span> </button> </div> </div> </form> </div> </div> ',"core"),c.Z.tv&&d.Z.centerFocus.on(o,!1),o.addEventListener("close",(function(){c.Z.tv&&d.Z.centerFocus.off(o,!1),u.ZP.hide(),t(f)})),n.default.open(o),(r=o).querySelector(".uploadSubtitleForm").addEventListener("submit",m),r.querySelector("#uploadSubtitle").addEventListener("change",(function(){!function(e,t){var a=t[0];if(!h(a))return e.querySelector("#subtitleOutput").innerHTML="",e.querySelector("#fldUpload").classList.add("hide"),e.querySelector("#labelDropSubtitle").classList.remove("hide"),void(s=null);s=a;var l,i=new FileReader;i.onerror=v,i.onloadstart=function(){e.querySelector("#fldUpload").classList.add("hide")},i.onabort=function(){u.ZP.hide(),console.debug("File read cancelled")},i.onload=(l=a,function(){var t='<a><span class="material-icons subtitles" aria-hidden="true" style="transform: translateY(25%);"></span><span>'+escape(l.name)+"</span><a/>";e.querySelector("#subtitleOutput").innerHTML=t,e.querySelector("#fldUpload").classList.remove("hide"),e.querySelector("#labelDropSubtitle").classList.add("hide")}),i.readAsDataURL(a)}(r,this.files)})),r.querySelector(".btnBrowse").addEventListener("click",(function(){r.querySelector("#uploadSubtitle").click()}));var p=o.querySelector("#selectLanguage");e.languages&&(p.innerHTML=e.languages.list||null,p.value=e.languages.value||null),o.querySelector(".btnCancel").addEventListener("click",(function(){n.default.close(o)}))}(e,t)}))}var y={show:g}}}]);