"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9656],{65299:function(e,t,r){r.r(t),r.d(t,{default:function(){return y}}),r(13227),r(81414),r(37666),r(26031),r(95822),r(56187),r(38690),r(11908),r(14011),r(11431),r(33096),r(89228);var n=r(94994),i=r(67561),o=r(44038),s=r(28540),a=r(72365),c=r(30531),d=(r(38228),r(61414),r(18613)),l=r(56663);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===u(i)?i:String(i)),n)}var i}function h(e){var t=e.options,r=d.Z.getApiClient(t.serverId);return t.parent.querySelector(".recordingFields").classList.remove("hide"),r.getLiveTvProgram(t.programId,r.getCurrentUserId()).then((function(r){e.TimerId=r.TimerId,e.Status=r.Status,e.SeriesTimerId=r.SeriesTimerId,function(e,t){t.IsSeries?e.querySelector(".recordSeriesContainer").classList.remove("hide"):e.querySelector(".recordSeriesContainer").classList.add("hide"),t.SeriesTimerId?(e.querySelector(".btnManageSeriesRecording").classList.remove("hide"),e.querySelector(".seriesRecordingButton .recordingIcon").classList.add("recordingIcon-active"),e.querySelector(".seriesRecordingButton .buttonText").innerHTML=n.ZP.translate("CancelSeries")):(e.querySelector(".btnManageSeriesRecording").classList.add("hide"),e.querySelector(".seriesRecordingButton .recordingIcon").classList.remove("recordingIcon-active"),e.querySelector(".seriesRecordingButton .buttonText").innerHTML=n.ZP.translate("RecordSeries")),t.TimerId&&"Cancelled"!==t.Status?(e.querySelector(".btnManageRecording").classList.remove("hide"),e.querySelector(".singleRecordingButton .recordingIcon").classList.add("recordingIcon-active"),"InProgress"===t.Status?e.querySelector(".singleRecordingButton .buttonText").innerHTML=n.ZP.translate("StopRecording"):e.querySelector(".singleRecordingButton .buttonText").innerHTML=n.ZP.translate("DoNotRecord")):(e.querySelector(".btnManageRecording").classList.add("hide"),e.querySelector(".singleRecordingButton .recordingIcon").classList.remove("recordingIcon-active"),e.querySelector(".singleRecordingButton .buttonText").innerHTML=n.ZP.translate("Record"))}(t.parent,r)}))}function m(e,t,r){var n=this.options;(r.Id&&this.TimerId===r.Id||r.ProgramId&&n&&n.programId===r.ProgramId)&&this.refresh()}function f(e,t,r){var n=this.options;(r.Id&&this.SeriesTimerId===r.Id||r.ProgramId&&n&&n.programId===r.ProgramId)&&this.refresh()}function b(){var e=this.options;if(this.TimerId&&"Cancelled"!==this.Status){var t=this;r.e(21341).then(r.bind(r,21341)).then((function(r){r.default.show(t.TimerId,e.serverId,{enableCancel:!1}).then((function(){t.changed=!0}))}))}}function v(){var e=this.options;if(this.SeriesTimerId){var t=this;r.e(4896).then(r.bind(r,4896)).then((function(r){r.default.show(t.SeriesTimerId,e.serverId,{enableCancel:!1}).then((function(){t.changed=!0}))}))}}function S(e){this.changed=!0;var t=this,r=this.options,n=d.Z.getApiClient(r.serverId),o=!a.ZP.parentWithTag(e.target,"BUTTON").querySelector(".material-icons").classList.contains("recordingIcon-active"),l=this.TimerId&&"Cancelled"!==this.Status;o?l||(s.ZP.show(),c.default.createRecording(n,r.programId,!1).then((function(){i.Z.trigger(t,"recordingchanged"),h(t),s.ZP.hide()}))):l&&(s.ZP.show(),c.default.cancelTimer(n,this.TimerId,!0).then((function(){i.Z.trigger(t,"recordingchanged"),h(t),s.ZP.hide()})))}function p(e){this.changed=!0;var t=this,r=this.options,i=d.Z.getApiClient(r.serverId);a.ZP.parentWithTag(e.target,"BUTTON").querySelector(".material-icons").classList.contains("recordingIcon-active")?this.SeriesTimerId&&i.cancelLiveTvSeriesTimer(this.SeriesTimerId).then((function(){(0,l.Z)(n.ZP.translate("RecordingCancelled")),h(t)})):(r.parent.querySelector(".recordSeriesContainer").classList.remove("hide"),this.SeriesTimerId||(this.TimerId?c.default.changeRecordingToSeries(i,this.TimerId,r.programId):c.default.createRecording(i,r.programId,!0)).then((function(){h(t)})))}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.embed();var r=m.bind(this);this.timerChangedHandler=r,i.Z.on(o.default,"TimerCreated",r),i.Z.on(o.default,"TimerCancelled",r);var n=f.bind(this);this.seriesTimerChangedHandler=n,i.Z.on(o.default,"SeriesTimerCreated",n),i.Z.on(o.default,"SeriesTimerCancelled",n)}var t,r;return t=e,(r=[{key:"embed",value:function(){var e=this;return new Promise((function(t){var r=e.options.parent;r.innerHTML=n.ZP.translateHtml('<div class="recordingFields hide"> <div class="recordSeriesContainer recordingFields-buttons flex align-items-center hide"> <div> <button is="emby-button" type="button" class="raised recordingButton seriesRecordingButton"> <span class="material-icons recordingIcon fiber_smart_record" aria-hidden="true"></span> <span class="buttonText">${RecordSeries}</span> </button> </div> <button is="emby-button" type="button" class="button-flat secondaryText manageRecordingButton btnManageSeriesRecording hide"> <span class="manageButtonText">${SeriesSettings}</span> </button> </div> <div class="recordingFields-buttons flex align-items-center"> <div> <button is="emby-button" type="button" class="raised recordingButton singleRecordingButton"> <span class="material-icons recordingIcon fiber_manual_record" aria-hidden="true"></span> <span class="buttonText">${Record}</span> </button> </div> <button is="emby-button" type="button" class="button-flat secondaryText manageRecordingButton btnManageRecording hide"> <span class="manageButtonText">${Settings}</span> </button> </div> </div> ',"core"),r.querySelector(".singleRecordingButton").addEventListener("click",S.bind(e)),r.querySelector(".seriesRecordingButton").addEventListener("click",p.bind(e)),r.querySelector(".btnManageRecording").addEventListener("click",b.bind(e)),r.querySelector(".btnManageSeriesRecording").addEventListener("click",v.bind(e)),h(e).then(t)}))}},{key:"hasChanged",value:function(){return this.changed}},{key:"refresh",value:function(){h(this)}},{key:"destroy",value:function(){var e=this.timerChangedHandler;this.timerChangedHandler=null,i.Z.off(o.default,"TimerCreated",e),i.Z.off(o.default,"TimerCancelled",e);var t=this.seriesTimerChangedHandler;this.seriesTimerChangedHandler=null,i.Z.off(o.default,"SeriesTimerCreated",t),i.Z.off(o.default,"SeriesTimerCancelled",t)}}])&&g(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}()}}]);