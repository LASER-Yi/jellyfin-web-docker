"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[88788],{43018:function(e,n,r){r.r(n),r.d(n,{default:function(){return K}});var t,a=r(62540),i=r(63696),l=r(5271),o=r(19044),s=r(99502),c=r(99851),u=r(51602),f=r(9055),d=r(55099),v=r(61586),y=r(14847),h=function(e){var n=(0,y.gf)().api;return(0,v.I)({queryKey:["LogEntries",e],queryFn:function(r){var t=r.signal;return function(e,n,r){return t=void 0,a=void 0,l=function(){return function(e,n){var r,t,a,i,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(l=0)),l;)try{if(r=1,t&&(a=2&o[0]?t.return:o[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,o[1])).done)return a;switch(t=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,t=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){l.label=o[1];break}if(6===o[0]&&l.label<a[1]){l.label=a[1],a=o;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(o);break}a[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],t=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(t){switch(t.label){case 0:return e?[4,(0,d.A)(e).getLogEntries(n,{signal:null==r?void 0:r.signal})]:(console.warn("[fetchLogEntries] No API instance available"),[2]);case 1:return[2,t.sent().data]}}))},new((i=void 0)||(i=Promise))((function(e,n){function r(e){try{s(l.next(e))}catch(e){n(e)}}function o(e){try{s(l.throw(e))}catch(e){n(e)}}function s(n){var t;n.done?e(n.value):(t=n.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}s((l=l.apply(t,a||[])).next())}));var t,a,i,l}(n,e,{signal:t})},enabled:!!n})},p=r(34907),b=r(46999),g=r(5898),m=function(e){var n=e.row;return n.original.ItemId?(0,a.jsx)(p.A,{size:"large",title:g.Ay.translate("LabelMediaDetails"),component:f.N_,to:"/details?id=".concat(n.original.ItemId),children:(0,a.jsx)(b.A,{fontSize:"inherit"})}):void 0},x=r(10104),A=r(23392),w=function(e){var n,r=e.level;switch(r){case x.$.Information:n="info";break;case x.$.Warning:n="warning";break;case x.$.Error:case x.$.Critical:n="error"}var t=g.Ay.translate("LogLevel.".concat(r));return(0,a.jsx)(A.A,{size:"small",color:n,label:t,title:t})},S=function(e){var n=e.cell.getValue();return n?(0,a.jsx)(w,{level:n}):void 0},C=r(10789),I=r(83113),j=r(20541),k=function(e){var n=e.row.original,r=n.ShortOverview,t=n.Overview,o=null!=r?r:t,s=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var t,a,i=r.call(e),l=[];try{for(;(void 0===n||n-- >0)&&!(t=i.next()).done;)l.push(t.value)}catch(e){a={error:e}}finally{try{t&&!t.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return l}((0,i.useState)(!1),2),c=s[0],u=s[1],f=(0,i.useCallback)((function(){u(!1)}),[]),d=(0,i.useCallback)((function(){u(!0)}),[]);return o?(0,a.jsxs)(l.A,{sx:{display:"flex",width:"100%",alignItems:"center"},children:[(0,a.jsx)(l.A,{sx:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},component:"div",title:o,children:o}),r&&t&&(0,a.jsx)(I.x,{onClickAway:f,children:(0,a.jsx)(j.A,{title:t,placement:"top",arrow:!0,onClose:f,open:c,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,children:(0,a.jsx)(p.A,{onClick:d,children:(0,a.jsx)(C.A,{})})})})]}):null},z=r(92342),L=function(e){var n=e.user;return(null==n?void 0:n.Id)?(0,a.jsx)(p.A,{size:"large",color:"inherit",sx:{padding:0},title:n.Name||void 0,component:f.N_,to:"/dashboard/users/profile?userId=".concat(n.Id),children:(0,a.jsx)(z.A,{user:n})}):void 0},U=r(7397),P=r(7758),T=function(e){var n=(0,y.gf)().api;return(0,v.I)({queryKey:["Users"],queryFn:function(r){var t=r.signal;return function(e,n,r){return t=void 0,a=void 0,l=function(){return function(e,n){var r,t,a,i,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(l=0)),l;)try{if(r=1,t&&(a=2&o[0]?t.return:o[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,o[1])).done)return a;switch(t=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,t=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){l.label=o[1];break}if(6===o[0]&&l.label<a[1]){l.label=a[1],a=o;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(o);break}a[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],t=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(t){switch(t.label){case 0:return e?[4,(0,P.q)(e).getUsers(n,{signal:null==r?void 0:r.signal})]:(console.warn("[fetchUsers] No API instance available"),[2]);case 1:return[2,t.sent().data]}}))},new((i=void 0)||(i=Promise))((function(e,n){function r(e){try{s(l.next(e))}catch(e){n(e)}}function o(e){try{s(l.throw(e))}catch(e){n(e)}}function s(n){var t;n.done?e(n.value):(t=n.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}s((l=l.apply(t,a||[])).next())}));var t,a,i,l}(n,e,{signal:t})},enabled:!!n})},N=r(98320),O=r(67202),F=function(){return F=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var a in n=arguments[r])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},F.apply(this,arguments)},E=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var t,a,i=r.call(e),l=[];try{for(;(void 0===n||n-- >0)&&!(t=i.next()).done;)l.push(t.value)}catch(e){a={error:e}}finally{try{t&&!t.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return l},R=function(e,n,r){if(r||2===arguments.length)for(var t,a=0,i=n.length;a<i;a++)!t&&a in n||(t||(t=Array.prototype.slice.call(n,0,a)),t[a]=n[a]);return e.concat(t||Array.prototype.slice.call(n))},q="useractivity";!function(e){e.All="All",e.User="User",e.System="System"}(t||(t={}));var H=function(e){return null===e?t.All:(0,O.G)(e)?t.User:t.System},K=function(){var e=E((0,f.ok)(),2),n=e[0],r=e[1],d=E((0,i.useState)(H(n.get(q))),2),v=d[0],y=d[1],p=E((0,i.useState)({pageIndex:0,pageSize:25}),2),b=p[0],x=p[1],A=T(),w=A.data,C=A.isLoading,I=(0,i.useMemo)((function(){return w?w.reduce((function(e,n){var r,t=n.Id;return t?F(F({},e),((r={})[t]=n,r)):e}),{}):{}}),[w]),j=function(e){return function(n){var r=n.row;return(0,a.jsx)(L,{user:r.original.UserId&&e[r.original.UserId]||void 0})}}(I),z=(0,i.useMemo)((function(){return{startIndex:b.pageIndex*b.pageSize,limit:b.pageSize,hasUserId:v!==t.All?v===t.User:void 0}}),[v,b.pageIndex,b.pageSize]),P=h(z),O=P.data,K=P.isLoading,M=C||K,D=(0,i.useMemo)((function(){return v===t.System?[]:[{id:"User",accessorFn:function(e){var n;return e.UserId&&(null===(n=I[e.UserId])||void 0===n?void 0:n.Name)},header:g.Ay.translate("LabelUser"),size:75,Cell:j,enableResizing:!1,muiTableBodyCellProps:{align:"center"}}]}),[v,I,j]),G=(0,i.useMemo)((function(){return R(R([{id:"Date",accessorFn:function(e){return(0,N.mk)(e.Date)},header:g.Ay.translate("LabelTime"),size:160,Cell:function(e){var n=e.cell;return(0,N.Rt)(n.getValue())}},{accessorKey:"Severity",header:g.Ay.translate("LabelLevel"),size:90,Cell:S,enableResizing:!1,muiTableBodyCellProps:{align:"center"}}],E(D),!1),[{accessorKey:"Name",header:g.Ay.translate("LabelName"),size:270},{id:"Overview",accessorFn:function(e){return e.ShortOverview||e.Overview},header:g.Ay.translate("LabelOverview"),size:170,Cell:k},{accessorKey:"Type",header:g.Ay.translate("LabelType"),size:150},{id:"Actions",accessorFn:function(e){return e.ItemId},header:"",size:60,Cell:m,enableColumnActions:!1,enableColumnFilter:!1,enableResizing:!1,enableSorting:!1}],!1)}),[D]),$=(0,i.useCallback)((function(e,n){null!==n&&y(n)}),[]);(0,i.useEffect)((function(){H(n.get(q))!==v&&(v===t.All?n.delete(q):n.set(q,"".concat(v===t.User)),r(n))}),[v,n,r]);var B=(0,u.Up)({columns:G,data:(null==O?void 0:O.Items)||[],enableColumnPinning:!0,enableColumnResizing:!0,enableStickyFooter:!0,enableStickyHeader:!0,muiTableContainerProps:{sx:{maxHeight:"calc(100% - 7rem)"}},initialState:{density:"compact"},state:{isLoading:M,pagination:b},manualPagination:!0,onPaginationChange:x,rowCount:(null==O?void 0:O.TotalRecordCount)||0,renderTopToolbarCustomActions:function(){return(0,a.jsxs)(s.A,{size:"small",value:v,onChange:$,exclusive:!0,children:[(0,a.jsx)(o.A,{value:t.All,children:g.Ay.translate("All")}),(0,a.jsx)(o.A,{value:t.User,children:g.Ay.translate("LabelUser")}),(0,a.jsx)(o.A,{value:t.System,children:g.Ay.translate("LabelSystem")})]})}});return(0,a.jsx)(U.A,{id:"serverActivityPage",title:g.Ay.translate("HeaderActivity"),className:"mainAnimatedPage type-interior",children:(0,a.jsxs)(l.A,{className:"content-primary",sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,a.jsx)(l.A,{sx:{marginBottom:1},children:(0,a.jsx)(c.A,{variant:"h2",children:g.Ay.translate("HeaderActivity")})}),(0,a.jsx)(u.zp,{table:B})]})})}}}]);