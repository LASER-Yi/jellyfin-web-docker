"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[99075],{19168:function(e,n,r){r.r(n),r.d(n,{default:function(){return k}});var l=r(62540),a=r(63696),t=r(5898),s=r(8566),c=r(30658),i=r(42301),o=r(50723),d=r(76116),u=r(91281),h=r(65242),m=r(45228),f=r(35049),y=r(95271),A=r(36135),v=r(18879),b=r(38596),p=r(69410),C=r(87404),x=function(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var l,a,t=r.call(e),s=[];try{for(;(void 0===n||n-- >0)&&!(l=t.next()).done;)s.push(l.value)}catch(e){a={error:e}}finally{try{l&&!l.done&&(r=t.return)&&r.call(t)}finally{if(a)throw a.error}}return s},k=function(){var e,n=(0,C.Zp)(),r=x((0,a.useState)([]),2),k=r[0],N=r[1],E=x((0,a.useState)([]),2),S=E[0],j=E[1],L=x((0,a.useState)(!1),2),q=L[0],w=L[1],P=(0,a.useRef)(null),g=(0,a.useCallback)((function(){w(!1)}),[]),I=(0,f.g)(),F=I.data,U=I.isSuccess,T=(0,y.e)(),B=T.data,H=T.isSuccess,O=(e=(0,p.gf)().api,(0,b.n)({mutationFn:function(n){return(0,v.q)(e).createUserByName(n)}})),D=(0,A.E)(),z=function(e){return e.map((function(e){return{Id:e.Id,Name:e.Name}}))},R=(0,a.useCallback)((function(e){var n=P.current;n?(j(z(e)),n.querySelector(".folderAccess").dispatchEvent(new CustomEvent("create")),n.querySelector(".chkEnableAllFolders").checked=!1):console.error("Unexpected null reference")}),[]),Z=(0,a.useCallback)((function(e){var n=P.current;if(n){var r=z(e);N(r),n.querySelector(".channelAccess").dispatchEvent(new CustomEvent("create"));var l=n.querySelector(".channelAccessContainer");r.length?l.classList.remove("hide"):l.classList.add("hide"),n.querySelector(".chkEnableAllChannels").checked=!1}else console.error("Unexpected null reference")}),[]),G=(0,a.useCallback)((function(){P.current?(null==F?void 0:F.Items)?(null==B?void 0:B.Items)?(R(null==F?void 0:F.Items),Z(null==B?void 0:B.Items),s.Ay.hide()):console.error("[add] channels not available"):console.error("[add] mediaFolders not available"):console.error("Unexpected null reference")}),[Z,R,F,B]);return(0,a.useEffect)((function(){s.Ay.show(),U&&H&&G()}),[G,U,H]),(0,a.useEffect)((function(){var e=P.current;if(e){var r=function(r){var l;return s.Ay.show(),l={Name:e.querySelector("#txtUsername").value,Password:e.querySelector("#txtPassword").value},O.mutate({createUserByName:l},{onSuccess:function(r){var l=r.data;if(!l.Id||!l.Policy)throw new Error("Unexpected null user id or policy");l.Policy.EnableAllFolders=e.querySelector(".chkEnableAllFolders").checked,l.Policy.EnabledFolders=[],l.Policy.EnableAllFolders||(l.Policy.EnabledFolders=Array.prototype.filter.call(e.querySelectorAll(".chkFolder"),(function(e){return e.checked})).map((function(e){return e.getAttribute("data-id")}))),l.Policy.EnableAllChannels=e.querySelector(".chkEnableAllChannels").checked,l.Policy.EnabledChannels=[],l.Policy.EnableAllChannels||(l.Policy.EnabledChannels=Array.prototype.filter.call(e.querySelectorAll(".chkChannel"),(function(e){return e.checked})).map((function(e){return e.getAttribute("data-id")}))),D.mutate({userId:l.Id,userPolicy:l.Policy},{onSuccess:function(){n("/dashboard/users/profile?userId=".concat(l.Id))},onError:function(){console.error("[usernew] failed to update user policy"),w(!0)}})}}),r.preventDefault(),r.stopPropagation(),!1},l=function(){var n=e.querySelector(".channelAccessListContainer");this.checked?n.classList.add("hide"):n.classList.remove("hide")},a=function(){var n=e.querySelector(".folderAccessListContainer");this.checked?n.classList.add("hide"):n.classList.remove("hide")},t=function(){window.history.back()};return e.querySelector(".chkEnableAllChannels").addEventListener("change",l),e.querySelector(".chkEnableAllFolders").addEventListener("change",a),e.querySelector(".newUserProfileForm").addEventListener("submit",r),e.querySelector("#btnCancel").addEventListener("click",t),function(){e.querySelector(".chkEnableAllChannels").removeEventListener("change",l),e.querySelector(".chkEnableAllFolders").removeEventListener("change",a),e.querySelector(".newUserProfileForm").removeEventListener("submit",r),e.querySelector("#btnCancel").removeEventListener("click",t)}}console.error("Unexpected null reference")}),[G,O,D,n]),(0,l.jsxs)(h.A,{id:"newUserPage",className:"mainAnimatedPage type-interior",children:[(0,l.jsx)(m.A,{open:q,onClose:g,message:t.Ay.translate("ErrorDefault")}),(0,l.jsxs)("div",{ref:P,className:"content-primary",children:[(0,l.jsx)("div",{className:"verticalSection",children:(0,l.jsx)(c.A,{title:t.Ay.translate("HeaderAddUser")})}),(0,l.jsxs)("form",{className:"newUserProfileForm",children:[(0,l.jsx)("div",{className:"inputContainer",children:(0,l.jsx)(i.A,{type:"text",id:"txtUsername",label:t.Ay.translate("LabelName"),required:!0})}),(0,l.jsx)("div",{className:"inputContainer",children:(0,l.jsx)(i.A,{type:"password",id:"txtPassword",label:t.Ay.translate("LabelPassword")})}),(0,l.jsx)(d.A,{containerClassName:"folderAccessContainer",headerTitle:"HeaderLibraryAccess",checkBoxClassName:"chkEnableAllFolders",checkBoxTitle:"OptionEnableAccessToAllLibraries",listContainerClassName:"folderAccessListContainer",accessClassName:"folderAccess",listTitle:"HeaderLibraries",description:"LibraryAccessHelp",children:S.map((function(e){return(0,l.jsx)(u.A,{className:"chkFolder",itemId:e.Id,itemName:e.Name},e.Id)}))}),(0,l.jsx)(d.A,{containerClassName:"channelAccessContainer verticalSection-extrabottompadding hide",headerTitle:"HeaderChannelAccess",checkBoxClassName:"chkEnableAllChannels",checkBoxTitle:"OptionEnableAccessToAllChannels",listContainerClassName:"channelAccessListContainer",accessClassName:"channelAccess",listTitle:"Channels",description:"ChannelAccessHelp",children:k.map((function(e){return(0,l.jsx)(u.A,{className:"chkChannel",itemId:e.Id,itemName:e.Name},e.Id)}))}),(0,l.jsxs)("div",{children:[(0,l.jsx)(o.A,{type:"submit",className:"raised button-submit block",title:t.Ay.translate("Save")}),(0,l.jsx)(o.A,{type:"button",id:"btnCancel",className:"raised button-cancel block",title:t.Ay.translate("ButtonCancel")})]})]})]})]})}},45228:function(e,n,r){var l=r(62540),a=r(63696),t=r(40643),s=r(75487),c=r(10301),i=function(){return i=Object.assign||function(e){for(var n,r=1,l=arguments.length;r<l;r++)for(var a in n=arguments[r])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},i.apply(this,arguments)};n.A=function(e){var n=(0,a.useCallback)((function(n){var r;null===(r=e.onClose)||void 0===r||r.call(e,n,"clickaway")}),[e]),r=(0,l.jsx)(s.A,{size:"small",color:"inherit",onClick:n,children:(0,l.jsx)(c.A,{fontSize:"small"})});return(0,l.jsx)(t.A,i({autoHideDuration:3300,action:r},e))}},76116:function(e,n,r){var l=r(62540),a=(r(63696),r(5898)),t=r(91281);n.A=function(e){var n=e.containerClassName,r=e.headerTitle,s=e.checkBoxClassName,c=e.checkBoxTitle,i=e.listContainerClassName,o=e.accessClassName,d=e.listTitle,u=e.description,h=e.children;return(0,l.jsxs)("div",{className:n,children:[(0,l.jsx)("h2",{children:a.Ay.translate(r)}),(0,l.jsx)(t.A,{labelClassName:"checkboxContainer",className:s,title:c}),(0,l.jsxs)("div",{className:i,children:[(0,l.jsxs)("div",{className:o,children:[(0,l.jsx)("h3",{className:"checkboxListLabel",children:a.Ay.translate(d)}),(0,l.jsx)("div",{className:"checkboxList paperList",style:{padding:".5em 1em"},children:h})]}),(0,l.jsx)("div",{className:"fieldDescription",children:a.Ay.translate(u)})]})]})}}}]);