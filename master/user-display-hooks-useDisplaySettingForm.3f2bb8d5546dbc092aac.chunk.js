"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2743,19630],{73845:function(e,n,t){t.r(n),t.d(n,{useDisplaySettingForm:function(){return d}});var a=t(27378),r=t(27851),s=t(56663),i=t(94994),o=t(84119),l=function(){return l=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},l.apply(this,arguments)},u=function(e,n,t,a){return new(t||(t=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(e){s(e)}}function o(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}l((a=a.apply(e,n||[])).next())}))},c=function(e,n){var t,a,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],a=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},f=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var a,r,s=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(a=s.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(r)throw r.error}}return i};function d(){var e=this,n=f((0,r.lr)(),1)[0],t=(0,o.useDisplaySettings)({userId:n.get("userId")}),d=t.displaySettings,p=t.loading,b=t.saveDisplaySettings,h=f((0,a.useState)(),2),y=h[0],v=h[1];(0,a.useEffect)((function(){p||!d||y||v(d)}),[y,p,d]);var g=(0,a.useCallback)((function(e){var n,t=e.name,a=e.value;y&&v(l(l({},y),((n={})[t]=a,n)))}),[y,v]),m=(0,a.useCallback)((function(){return u(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return y?[4,b(y)]:[3,2];case 1:e.sent(),(0,s.Z)(i.ZP.translate("SettingsSaved")),e.label=2;case 2:return[2]}}))}))}),[y,b]);return{loading:p,values:y,submitChanges:m,updateField:g}}},84119:function(e,n,t){t.r(n),t.d(n,{useDisplaySettings:function(){return d}});var a=t(27378),r=t(92811),s=t(30325),i=t(48215),o=t(45220),l=t(60934),u=function(e,n,t,a){return new(t||(t=Promise))((function(r,s){function i(e){try{l(a.next(e))}catch(e){s(e)}}function o(e){try{l(a.throw(e))}catch(e){s(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,o)}l((a=a.apply(e,n||[])).next())}))},c=function(e,n){var t,a,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(t=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],a=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},f=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var a,r,s=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(a=s.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(r)throw r.error}}return i};function d(e){var n=this,t=e.userId,r=f((0,a.useState)(!0),2),s=r[0],o=r[1],l=f((0,a.useState)(),2),d=l[0],h=l[1],y=f((0,a.useState)(),2),v=y[0],g=y[1],m=(0,i.h_)(),S=m.__legacyApiClient__,w=m.user;return(0,a.useEffect)((function(){if(t&&w&&S)return o(!0),u(n,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return[4,p({api:S,currentUser:w,userId:t})];case 1:return e=n.sent(),g(e.displaySettings),h(e.userSettings),o(!1),[2]}}))})),function(){o(!1)}}),[S,w,t]),{displaySettings:v,loading:s,saveDisplaySettings:(0,a.useCallback)((function(e){return u(n,void 0,void 0,(function(){return c(this,(function(n){return t&&d&&S?[2,b({api:S,newDisplaySettings:e,userSettings:d,userId:t})]:[2]}))}))}),[S,d,t])}}function p(e){var n,t,a=e.currentUser,r=e.userId,i=e.api;return u(this,void 0,void 0,(function(){var e,o,u;return c(this,(function(c){switch(c.label){case 0:return e=r&&r!==(null==a?void 0:a.Id)?new l.UserSettings:l.currentSettings,r&&r!==(null==a?void 0:a.Id)?[3,1]:(u=a,[3,3]);case 1:return[4,i.getUser(r)];case 2:u=c.sent(),c.label=3;case 3:return o=u,[4,e.setUserInfo(r,i)];case 4:return c.sent(),[2,{displaySettings:{customCss:e.customCss(),dashboardTheme:e.dashboardTheme()||"auto",dateTimeLocale:e.dateTimeLocale()||"auto",disableCustomCss:Boolean(e.disableCustomCss()),displayMissingEpisodes:null!==(t=null===(n=null==o?void 0:o.Configuration)||void 0===n?void 0:n.DisplayMissingEpisodes)&&void 0!==t&&t,enableBlurHash:Boolean(e.enableBlurhash()),enableFasterAnimation:Boolean(e.enableFastFadein()),enableItemDetailsBanner:Boolean(e.detailsBanner()),enableLibraryBackdrops:Boolean(e.enableBackdrops()),enableLibraryThemeSongs:Boolean(e.enableThemeSongs()),enableLibraryThemeVideos:Boolean(e.enableThemeVideos()),enableRewatchingInNextUp:Boolean(e.enableRewatchingInNextUp()),episodeImagesInNextUp:Boolean(e.useEpisodeImagesInNextUpAndResume()),language:e.language()||"auto",layout:s.Z.getSavedLayout()||"auto",libraryPageSize:e.libraryPageSize(),maxDaysForNextUp:e.maxDaysForNextUp(),screensaver:e.screensaver()||"none",screensaverInterval:e.backdropScreensaverInterval(),theme:e.theme()},userSettings:e}]}}))}))}function b(e){var n=e.api,t=e.newDisplaySettings,a=e.userSettings,i=e.userId;return u(this,void 0,void 0,(function(){var e,l;return c(this,(function(u){switch(u.label){case 0:return[4,n.getUser(i)];case 1:return e=u.sent(),r.M.supports("displaylanguage")&&a.language(h(t.language)),a.customCss(h(t.customCss)),a.dashboardTheme(h(t.dashboardTheme)),a.dateTimeLocale(h(t.dateTimeLocale)),a.disableCustomCss(t.disableCustomCss),a.enableBlurhash(t.enableBlurHash),a.enableFastFadein(t.enableFasterAnimation),a.detailsBanner(t.enableItemDetailsBanner),a.enableBackdrops(t.enableLibraryBackdrops),a.enableThemeSongs(t.enableLibraryThemeSongs),a.enableThemeVideos(t.enableLibraryThemeVideos),a.enableRewatchingInNextUp(t.enableRewatchingInNextUp),a.useEpisodeImagesInNextUpAndResume(t.episodeImagesInNextUp),a.libraryPageSize(t.libraryPageSize),a.maxDaysForNextUp(t.maxDaysForNextUp),a.screensaver(h(t.screensaver)),a.backdropScreensaverInterval(t.screensaverInterval),a.theme(t.theme),s.Z.setLayout(h(t.layout)),l=[o.Z.setTheme(a.theme())],e.Id&&e.Configuration&&(e.Configuration.DisplayMissingEpisodes=t.displayMissingEpisodes,l.push(n.updateUserConfiguration(e.Id,e.Configuration))),[4,Promise.all(l)];case 2:return u.sent(),[2]}}))}))}function h(e){return/^(auto|none)$/.test(e)?"":e}}}]);