"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[60278,78938],{60278:function(e,t,r){r.r(t),r(81678),r(4754),r(29305),r(32733),r(78557),r(94),r(36947),r(84701),r(44962),r(83994),r(82367);var n=r(47629),i=r(78938),a=(r(15453),r(10353),r(86191));function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:String(t)}function l(){var e=this.item;if(e){var t=e.ServerId,r=e.Id,n=e.TimerId,a=e.Status,c=e.SeriesTimerId,o=this;i.default.toggleRecording(t,r,n,a,c).then((function(){o.refresh(t,r)}))}}function u(e,t){var r=e.querySelector(".material-icons");r.classList.remove("fiber_smart_record"),r.classList.remove("fiber_manual_record"),r.classList.add(t)}var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t;var r=t.button;u(r,"fiber_manual_record"),t.item?this.refreshItem(t.item):t.itemId&&t.serverId&&this.refresh(t.itemId,t.serverId);var i=l.bind(this);this.clickFn=i,n.Ay.addEventListener(r,"click",i,{passive:!0})}var t,r;return t=e,(r=[{key:"refresh",value:function(e,t){var r=a.A.getApiClient(e),n=this;r.getItem(r.getCurrentUserId(),t).then((function(e){n.refreshItem(e)}))}},{key:"refreshItem",value:function(e){var t=this.options.button;this.item=e,u(t,function(e){var t;if("SeriesTimer"===e.Type)return"fiber_smart_record";if(e.TimerId||e.SeriesTimerId)t=e.Status||"Cancelled";else{if("Timer"!==e.Type)return"fiber_manual_record";t=e.Status}return e.SeriesTimerId&&"Cancelled"!==t?"fiber_smart_record":"fiber_manual_record"}(e)),e.TimerId&&"Cancelled"!==(e.Status||"Cancelled")?t.classList.add("recordingIcon-active"):t.classList.remove("recordingIcon-active")}},{key:"destroy",value:function(){var e=this.options;if(e){var t=e.button,r=this.clickFn;r&&n.Ay.removeEventListener(t,"click",r,{passive:!0})}this.options=null,this.item=null}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=f},78938:function(e,t,r){r.r(t),r(78557),r(90076);var n=r(9482),i=r(56869),a=r(86191),c=r(50764),o=r(40532),s=r(48080);function l(e,t,r,a){return i.Ay.show(),e.getItem(e.getCurrentUserId(),r).then((function(o){return o.IsSeries?e.getNewLiveTvTimerDefaults({programId:r}).then((function(t){return e.createLiveTvSeriesTimer(t).then((function(){i.Ay.hide(),(0,c.A)(n.Ay.translate("SeriesRecordingScheduled"))}))})):a?u(t,e.serverId()):f(e.serverId(),t,!0)}))}function u(e,t){return new Promise((function(r,c){(0,o.A)({text:n.Ay.translate("MessageConfirmRecordingCancellation"),primary:"delete",confirmText:n.Ay.translate("HeaderCancelRecording"),cancelText:n.Ay.translate("HeaderKeepRecording")}).then((function(){i.Ay.show(),f(a.A.getApiClient(t),e,!0).then(r,c)}),c)}))}function f(e,t,r){return i.Ay.show(),e.cancelLiveTvTimer(t).then((function(){!1!==r&&(i.Ay.hide(),(0,c.A)(n.Ay.translate("RecordingCancelled")))}))}function d(e,t,r){return i.Ay.show(),e.getNewLiveTvTimerDefaults({programId:t}).then((function(t){return(r?e.createLiveTvSeriesTimer(t):e.createLiveTvTimer(t)).then((function(){i.Ay.hide(),(0,c.A)(n.Ay.translate("RecordingScheduled"))}))}))}t.default={cancelTimer:f,createRecording:d,changeRecordingToSeries:l,toggleRecording:function(e,t,r,o,u){var m=a.A.getApiClient(e),y=r&&"Cancelled"!==o;return u&&y?function(e,t,r,o,l){return new Promise((function(t,u){var d=[];d.push({name:n.Ay.translate("HeaderKeepRecording"),id:"cancel",type:"submit"}),"InProgress"===o?d.push({name:n.Ay.translate("HeaderStopRecording"),id:"canceltimer",type:"cancel"}):d.push({name:n.Ay.translate("HeaderCancelRecording"),id:"canceltimer",type:"cancel"}),d.push({name:n.Ay.translate("HeaderCancelSeries"),id:"cancelseriestimer",type:"cancel"}),s.A.show({text:n.Ay.translate("MessageConfirmRecordingCancellation"),buttons:d}).then((function(o){var s=a.A.getApiClient(e);"canceltimer"===o?(i.Ay.show(),f(s,r,!0).then(t,u)):"cancelseriestimer"===o?(i.Ay.show(),s.cancelLiveTvSeriesTimer(l).then((function(){(0,c.A)(n.Ay.translate("SeriesCancelled")),i.Ay.hide(),t()}),u)):t()}),u)}))}(e,0,r,o,u):y&&t?l(m,r,t,!0):t?d(m,t):Promise.reject()},cancelTimerWithConfirmation:u,cancelSeriesTimerWithConfirmation:function(e,t){return new Promise((function(r,s){(0,o.A)({text:n.Ay.translate("MessageConfirmRecordingCancellation"),primary:"delete",confirmText:n.Ay.translate("HeaderCancelSeries"),cancelText:n.Ay.translate("HeaderKeepSeries")}).then((function(){i.Ay.show(),a.A.getApiClient(t).cancelLiveTvSeriesTimer(e).then((function(){(0,c.A)(n.Ay.translate("SeriesCancelled")),i.Ay.hide(),r()}),s)}),s)}))}}}}]);