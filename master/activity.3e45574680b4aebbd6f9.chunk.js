"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[88788],{4092:function(e,n,t){t.r(n),t.d(n,{default:function(){return H}});var r,a=t(62540),i=t(63696),l=t(10104),o=t(5271),s=t(19044),c=t(99502),u=t(99851),f=t(51602),d=t(9055),v=t(55099),y=t(61586),p=t(69410),h=function(e){var n=(0,p.gf)().api;return(0,y.I)({queryKey:["LogEntries",e],queryFn:function(t){var r=t.signal;return function(e,n,t){return r=void 0,a=void 0,l=function(){return function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=o(0),l.throw=o(1),l.return=o(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;l&&(l=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(r){switch(r.label){case 0:return e?[4,(0,v.A)(e).getLogEntries(n,{signal:null==t?void 0:t.signal})]:(console.warn("[fetchLogEntries] No API instance available"),[2]);case 1:return[2,r.sent().data]}}))},new((i=void 0)||(i=Promise))((function(e,n){function t(e){try{s(l.next(e))}catch(e){n(e)}}function o(e){try{s(l.throw(e))}catch(e){n(e)}}function s(n){var r;n.done?e(n.value):(r=n.value,r instanceof i?r:new i((function(e){e(r)}))).then(t,o)}s((l=l.apply(r,a||[])).next())}));var r,a,i,l}(n,e,{signal:r})},enabled:!!n})},b=t(34907),g=t(46999),m=t(5898),x=function(e){var n=e.row;return n.original.ItemId?(0,a.jsx)(b.A,{size:"large",title:m.Ay.translate("LabelMediaDetails"),component:d.N_,to:"/details?id=".concat(n.original.ItemId),children:(0,a.jsx)(g.A,{fontSize:"inherit"})}):void 0},A=t(23392),w=function(e){var n,t=e.level;switch(t){case l.$.Information:n="info";break;case l.$.Warning:n="warning";break;case l.$.Error:case l.$.Critical:n="error"}var r=m.Ay.translate("LogLevel.".concat(t));return(0,a.jsx)(A.A,{size:"small",color:n,label:r,title:r})},S=function(e){var n=e.cell.getValue();return n?(0,a.jsx)(w,{level:n}):void 0},I=t(10789),j=t(83113),C=t(20541),k=function(e){var n=e.row.original,t=n.ShortOverview,r=n.Overview,l=null!=t?t:r,s=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,a,i=t.call(e),l=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return l}((0,i.useState)(!1),2),c=s[0],u=s[1],f=(0,i.useCallback)((function(){u(!1)}),[]),d=(0,i.useCallback)((function(){u(!0)}),[]);return l?(0,a.jsxs)(o.A,{sx:{display:"flex",width:"100%",alignItems:"center"},children:[(0,a.jsx)(o.A,{sx:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},component:"div",title:l,children:l}),t&&r&&(0,a.jsx)(j.x,{onClickAway:f,children:(0,a.jsx)(C.A,{title:r,placement:"top",arrow:!0,onClose:f,open:c,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,children:(0,a.jsx)(b.A,{onClick:d,children:(0,a.jsx)(I.A,{})})})})]}):null},L=t(81965),z=function(e){var n=e.user;return(null==n?void 0:n.Id)?(0,a.jsx)(b.A,{size:"large",color:"inherit",sx:{padding:0},title:n.Name||void 0,component:d.N_,to:"/dashboard/users/profile?userId=".concat(n.Id),children:(0,a.jsx)(L.A,{user:n})}):void 0},U=t(65242),O=t(7758),P=function(e){var n=(0,p.gf)().api;return(0,y.I)({queryKey:["Users"],queryFn:function(t){var r=t.signal;return function(e,n,t){return r=void 0,a=void 0,l=function(){return function(e,n){var t,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=o(0),l.throw=o(1),l.return=o(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;l&&(l=0,o[0]&&(i=0)),i;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=n.call(e,i)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(r){switch(r.label){case 0:return e?[4,(0,O.q)(e).getUsers(n,{signal:null==t?void 0:t.signal})]:(console.warn("[fetchUsers] No API instance available"),[2]);case 1:return[2,r.sent().data]}}))},new((i=void 0)||(i=Promise))((function(e,n){function t(e){try{s(l.next(e))}catch(e){n(e)}}function o(e){try{s(l.throw(e))}catch(e){n(e)}}function s(n){var r;n.done?e(n.value):(r=n.value,r instanceof i?r:new i((function(e){e(r)}))).then(t,o)}s((l=l.apply(r,a||[])).next())}));var r,a,i,l}(n,e,{signal:r})},enabled:!!n})},N=t(98320),T=t(44305),F=function(){return F=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},F.apply(this,arguments)},E=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,a,i=t.call(e),l=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)l.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return l},M=function(e,n,t){if(t||2===arguments.length)for(var r,a=0,i=n.length;a<i;a++)!r&&a in n||(r||(r=Array.prototype.slice.call(n,0,a)),r[a]=n[a]);return e.concat(r||Array.prototype.slice.call(n))},R="useractivity";!function(e){e.All="All",e.User="User",e.System="System"}(r||(r={}));var q=function(e){return null===e?r.All:(0,T.G)(e)?r.User:r.System},H=function(){var e=E((0,d.ok)(),2),n=e[0],t=e[1],v=E((0,i.useState)(q(n.get(R))),2),y=v[0],p=v[1],b=E((0,i.useState)({pageIndex:0,pageSize:25}),2),g=b[0],A=b[1],w=P(),I=w.data,j=w.isLoading,C=(0,i.useMemo)((function(){return I?I.reduce((function(e,n){var t,r=n.Id;return r?F(F({},e),((t={})[r]=n,t)):e}),{}):{}}),[I]),L=(0,i.useMemo)((function(){var e=[];return null==I||I.forEach((function(n){n.Name&&e.push(n.Name)})),e}),[I]),O=function(e){return function(n){var t=n.row;return(0,a.jsx)(z,{user:t.original.UserId&&e[t.original.UserId]||void 0})}}(C),T=(0,i.useMemo)((function(){return{startIndex:g.pageIndex*g.pageSize,limit:g.pageSize,hasUserId:y!==r.All?y===r.User:void 0}}),[y,g.pageIndex,g.pageSize]),H=h(T),K=H.data,V=H.isLoading,$=j||V,D=(0,i.useMemo)((function(){return y===r.System?[]:[{id:"User",accessorFn:function(e){var n;return e.UserId&&(null===(n=C[e.UserId])||void 0===n?void 0:n.Name)},header:m.Ay.translate("LabelUser"),size:75,Cell:O,enableResizing:!1,muiTableBodyCellProps:{align:"center"},filterVariant:"multi-select",filterSelectOptions:L}]}),[y,L,C,O]),G=(0,i.useMemo)((function(){return M(M([{id:"Date",accessorFn:function(e){return(0,N.mk)(e.Date)},header:m.Ay.translate("LabelTime"),size:160,Cell:function(e){var n=e.cell;return(0,N.Rt)(n.getValue())},filterVariant:"datetime-range"},{accessorKey:"Severity",header:m.Ay.translate("LabelLevel"),size:90,Cell:S,enableResizing:!1,muiTableBodyCellProps:{align:"center"},filterVariant:"multi-select",filterSelectOptions:Object.values(l.$).map((function(e){return m.Ay.translate("LogLevel.".concat(e))}))}],E(D),!1),[{accessorKey:"Name",header:m.Ay.translate("LabelName"),size:270},{id:"Overview",accessorFn:function(e){return e.ShortOverview||e.Overview},header:m.Ay.translate("LabelOverview"),size:170,Cell:k},{accessorKey:"Type",header:m.Ay.translate("LabelType"),size:150},{id:"Actions",accessorFn:function(e){return e.ItemId},header:"",size:60,Cell:x,enableColumnActions:!1,enableColumnFilter:!1,enableResizing:!1,enableSorting:!1}],!1)}),[D]),B=(0,i.useCallback)((function(e,n){null!==n&&p(n)}),[]);(0,i.useEffect)((function(){q(n.get(R))!==y&&(y===r.All?n.delete(R):n.set(R,"".concat(y===r.User)),t(n))}),[y,n,t]);var _=(0,f.Up)({columns:G,data:(null==K?void 0:K.Items)||[],enableColumnPinning:!0,enableColumnResizing:!0,enableStickyFooter:!0,enableStickyHeader:!0,muiTableContainerProps:{sx:{maxHeight:"calc(100% - 7rem)"}},initialState:{density:"compact"},state:{isLoading:$,pagination:g},manualPagination:!0,onPaginationChange:A,rowCount:(null==K?void 0:K.TotalRecordCount)||0,renderTopToolbarCustomActions:function(){return(0,a.jsxs)(c.A,{size:"small",value:y,onChange:B,exclusive:!0,children:[(0,a.jsx)(s.A,{value:r.All,children:m.Ay.translate("All")}),(0,a.jsx)(s.A,{value:r.User,children:m.Ay.translate("LabelUser")}),(0,a.jsx)(s.A,{value:r.System,children:m.Ay.translate("LabelSystem")})]})}});return(0,a.jsx)(U.A,{id:"serverActivityPage",title:m.Ay.translate("HeaderActivity"),className:"mainAnimatedPage type-interior",children:(0,a.jsxs)(o.A,{className:"content-primary",sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,a.jsx)(o.A,{sx:{marginBottom:1},children:(0,a.jsx)(u.A,{variant:"h2",children:m.Ay.translate("HeaderActivity")})}),(0,a.jsx)(f.zp,{table:_})]})})}}}]);