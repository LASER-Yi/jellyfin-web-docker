"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[23920],{7397:function(e,t,n){var r=n(30177),i=n(41906);t.A=function(e){var t=e.cell,n=(0,i.Y)().dateFnsLocale;return(0,r.A)(t.getValue(),"Pp",{locale:n})}},32203:function(e,t,n){n.d(t,{Bq:function(){return l},Jd:function(){return c},yq:function(){return a}});var r=n(65369),i=n(11444),o="assets/img/devices/";function a(e){var t;switch(e.AppName||e.Client){case"Samsung Smart TV":return o+"samsungtv.svg";case"Xbox One":return o+"xbox.svg";case"Sony PS4":return o+"playstation.svg";case"Kodi":case"Kodi JellyCon":return o+"kodi.svg";case"Jellyfin Android":case"AndroidTV":case"Android TV":return o+"android.svg";case"Jellyfin Mobile (iOS)":case"Jellyfin Mobile (iPadOS)":case"Jellyfin iOS":case"Jellyfin iPadOS":case"Jellyfin tvOS":case"Swiftfin iPadOS":case"Swiftfin iOS":case"Swiftfin tvOS":case"Infuse":case"Infuse-Direct":case"Infuse-Library":return o+"apple.svg";case"Home Assistant":return o+"home-assistant.svg";case"Jellyfin for WebOS":case"LG Smart TV":return o+"webos.svg";case"Jellyfin Roku":return o+"roku.svg";case"Finamp":return o+"finamp.svg";case"Jellyfin Web":return function(e){switch(e){case"Opera":case"Opera TV":case"Opera Android":return o+"opera.svg";case"Chrome":case"Chrome Android":return o+"chrome.svg";case"Firefox":case"Firefox Android":return o+"firefox.svg";case"Safari":case"Safari iPad":case"Safari iPhone":return o+"safari.svg";case"Edge Chromium":case"Edge Chromium Android":case"Edge Chromium iPad":case"Edge Chromium iPhone":return o+"edgechromium.svg";case"Edge":return o+"edge.svg";case"Internet Explorer":return o+"msie.svg";default:return o+"html5.svg"}}(e.Name||e.DeviceName);default:if(null===(t=e.Capabilities)||void 0===t?void 0:t.IconUrl)try{return new URL(e.Capabilities.IconUrl).toString()}catch(t){console.error("[getDeviceIcon] device capabilities has invalid IconUrl",e,t)}return o+"other.svg"}}function c(e){switch(e){case r.X.Movies:return"movie";case r.X.Music:return"music_note";case r.X.Homevideos:case r.X.Photos:return"photo";case r.X.Livetv:return"live_tv";case r.X.Tvshows:return"tv";case r.X.Trailers:return"theaters";case r.X.Musicvideos:return"music_video";case r.X.Books:return"book";case r.X.Boxsets:return"video_library";case r.X.Playlists:return"queue";case"channels":return"videocam";case void 0:return"quiz";default:return"folder"}}function l(e,t){switch(e){case i.D.MusicAlbum:return"album";case i.D.MusicArtist:case i.D.Person:return"person";case i.D.Audio:return"audiotrack";case i.D.Movie:return"movie";case i.D.Episode:case i.D.Series:return"tv";case i.D.Program:return"live_tv";case i.D.Book:return"book";case i.D.Folder:return"folder";case i.D.BoxSet:return"video_library";case i.D.Playlist:return"queue";case i.D.Photo:return"photo";case i.D.PhotoAlbum:return"photo_album";default:return t}}t.Ay={getDeviceIcon:a,getLibraryIcon:c,getItemTypeIcon:l}},36589:function(e,t,n){n.d(t,{O:function(){return u}});var r=n(62540),i=n(5271),o=n(58765),a=n(99851),c=n(51602),l=(n(63696),n(65242)),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)},u={enableColumnPinning:!0,enableColumnResizing:!0,enableStickyFooter:!0,enableStickyHeader:!0,muiTableContainerProps:{sx:{maxHeight:"calc(100% - 7rem)"}}};t.A=function(e){var t=e.title,n=e.subtitle,u=e.table,f=e.children,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["title","subtitle","table","children"]);return(0,r.jsxs)(l.A,s({title:t},d,{children:[(0,r.jsxs)(i.A,{className:"content-primary",sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,r.jsxs)(o.A,{spacing:2,sx:{marginBottom:1},children:[(0,r.jsx)(a.A,{variant:"h2",children:t}),n&&(0,r.jsx)(a.A,{children:n})]}),(0,r.jsx)(c.zp,{table:u})]}),f]}))}},41906:function(e,t,n){n.d(t,{Y:function(){return f}});var r=n(62864),i=n(63696),o=n(5898),a=n(93721),c=n(28626),l=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function c(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},u=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function f(){var e=this,t=(0,c.Q)(),n=t.dateTimeLocale,f=t.language,d=u((0,i.useState)(r.A),2),p=d[0],v=d[1],y=(0,i.useMemo)((function(){return(0,o.Tl)(f||(0,o.i5)())}),[f]),h=(0,i.useMemo)((function(){return n?(0,o.Tl)(n):y}),[n,y]);return(0,i.useEffect)((function(){l(e,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,a.Fq)((0,a.QC)(h))];case 1:return e=n.sent(),v(e),[3,3];case 2:return t=n.sent(),console.warn("[useLocale] failed to fetch dateFns locale",t),[3,3];case 3:return[2]}}))}))}),[h]),{locale:y,dateTimeLocale:h,dateFnsLocale:p}}},56080:function(e,t,n){n.r(t),n.d(t,{Component:function(){return k}});var r=n(62540),i=n(16638),o=n(97217),a=n(5271),c=n(77890),l=n(34907),s=n(20541),u=n(34401),f=n(51602),d=n(63696),p=n(7397),v=n(36589),y=n(57227),h=n(16576),m=n(38596),b=n(69410),g=n(53678),x=n(61586),A="Devices",w=function(e){var t=(0,b.gf)().api;return(0,x.I)({queryKey:[A,e],queryFn:function(n){var r=n.signal;return function(e,t,n){return r=void 0,i=void 0,a=function(){return function(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(r){switch(r.label){case 0:return[4,(0,h.g)(e).getDevices(t,{signal:null==n?void 0:n.signal})];case 1:return[2,r.sent().data]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function c(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,c)}l((a=a.apply(r,i||[])).next())}));var r,i,o,a}(t,e,{signal:r})},enabled:!!t})},O=n(32203),j=function(e){var t=e.row,n=e.renderedCellValue;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{alt:t.original.AppName||void 0,src:(0,O.yq)(t.original),style:{display:"inline-block",maxWidth:"1.5em",maxHeight:"1.5em",marginRight:"1rem"}}),n]})},C=n(57807),S=n(92058),I=n(5898),D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D.apply(this,arguments)},P=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},k=function(){var e=(0,b.gf)().api,t=w({}),n=t.data,x=t.isLoading,O=t.isRefetching,k=(0,d.useMemo)((function(){return(null==n?void 0:n.Items)||[]}),[n]),E=(0,S.y)(),L=E.usersById,N=E.names,T=E.isLoading,B=P((0,d.useState)(!1),2),F=B[0],q=B[1],M=P((0,d.useState)(!1),2),X=M[0],J=M[1],R=P((0,d.useState)(),2),U=R[0],V=R[1],z=function(){var e=(0,b.gf)().api;return(0,m.n)({mutationFn:function(t){return(0,h.g)(e).deleteDevice(t)},onSuccess:function(){g.q.invalidateQueries({queryKey:[A]})}})}(),H=function(){var e=(0,b.gf)().api;return(0,m.n)({mutationFn:function(t){return(0,h.g)(e).updateDeviceOptions(t)},onSuccess:function(){g.q.invalidateQueries({queryKey:[A]})}})}(),_=x||T,K=(0,d.useCallback)((function(e){return function(){e&&(V(e),q(!0))}}),[]),G=(0,d.useCallback)((function(){V(void 0),q(!1)}),[]),Q=(0,d.useCallback)((function(){U&&z.mutate({id:U},{onSettled:G})}),[z,G,U]),W=(0,d.useCallback)((function(){J(!0)}),[]),Y=(0,d.useCallback)((function(){J(!1)}),[]),Z=(0,d.useCallback)((function(){k&&Promise.all(k.map((function(t){return e&&t.Id&&e.deviceInfo.id===t.Id?z.mutateAsync({id:t.Id}):Promise.resolve()}))).catch((function(e){console.error("[DevicesPage] failed deleting all devices",e)})).finally((function(){Y()}))}),[e,z,k,Y]),$=function(e){return function(t){var n=t.renderedCellValue,i=t.row;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.A,{user:i.original.LastUserId&&e[i.original.LastUserId]||void 0,sx:{mr:"1rem"}}),n]})}}(L),ee=(0,d.useMemo)((function(){return[{id:"DateLastActivity",accessorFn:function(e){return e.DateLastActivity?(0,u.A)(e.DateLastActivity):void 0},header:I.Ay.translate("LastActive"),size:160,Cell:p.A,filterVariant:"datetime-range",enableEditing:!1},{id:"Name",accessorFn:function(e){return e.CustomName||e.Name},header:I.Ay.translate("LabelDevice"),size:200,Cell:j},{id:"App",accessorFn:function(e){return[e.AppName,e.AppVersion].filter((function(e){return!!e})).join(" ")},header:I.Ay.translate("LabelAppName"),size:200,enableEditing:!1},{accessorKey:"LastUserName",header:I.Ay.translate("LabelUser"),size:120,enableEditing:!1,Cell:$,filterVariant:"multi-select",filterSelectOptions:N}]}),[$,N]),te=(0,f.Up)(D(D({},v.O),{columns:ee,data:k,initialState:{density:"compact",pagination:{pageIndex:0,pageSize:25}},state:{isLoading:_},autoResetPageIndex:!O,enableEditing:!0,onEditingRowSave:function(e){var t,n=e.table,r=e.row,i=null===(t=e.values.Name)||void 0===t?void 0:t.trim(),o=r.original.CustomName?i!==r.original.CustomName:i!==r.original.Name;r.original.Id&&o&&H.mutate({id:r.original.Id,deviceOptionsDto:{CustomName:i||void 0}}),n.setEditingRow(null)},enableRowActions:!0,positionActionsColumn:"last",displayColumnDefOptions:{"mrt-row-actions":{header:""}},renderRowActions:function(t){var n=t.row,c=t.table,u=e&&n.original.Id&&e.deviceInfo.id===n.original.Id;return(0,r.jsxs)(a.A,{sx:{display:"flex",gap:1},children:[(0,r.jsx)(s.A,{title:I.Ay.translate("Edit"),children:(0,r.jsx)(l.A,{onClick:function(){return c.setEditingRow(n)},children:(0,r.jsx)(o.A,{})})}),u?(0,r.jsx)(l.A,{color:"error",disabled:!0,children:(0,r.jsx)(i.A,{})}):(0,r.jsx)(s.A,{title:I.Ay.translate("Delete"),children:(0,r.jsx)(l.A,{color:"error",onClick:K(n.original.Id),children:(0,r.jsx)(i.A,{})})})]})},renderTopToolbarCustomActions:function(){return(0,r.jsx)(c.A,{color:"error",startIcon:(0,r.jsx)(i.A,{}),onClick:W,children:I.Ay.translate("DeleteAll")})}}));return(0,r.jsxs)(v.A,{id:"devicesPage",title:I.Ay.translate("HeaderDevices"),className:"mainAnimatedPage type-interior",table:te,children:[(0,r.jsx)(C.A,{open:F,title:I.Ay.translate("HeaderDeleteDevice"),text:I.Ay.translate("DeleteDeviceConfirmation"),onCancel:G,onConfirm:Q,confirmButtonColor:"error",confirmButtonText:I.Ay.translate("Delete")}),(0,r.jsx)(C.A,{open:X,title:I.Ay.translate("HeaderDeleteDevices"),text:I.Ay.translate("DeleteDevicesConfirmation"),onCancel:Y,onConfirm:Z,confirmButtonColor:"error",confirmButtonText:I.Ay.translate("Delete")})]})};k.displayName="DevicesPage"},57227:function(e,t,n){var r=n(62540),i=n(34907),o=(n(63696),n(9055)),a=n(81965),c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)};t.A=function(e){var t=e.user,n=e.sx;return(null==t?void 0:t.Id)?(0,r.jsx)(i.A,{size:"large",color:"inherit",sx:c({padding:0},n),title:t.Name||void 0,component:o.N_,to:"/dashboard/users/profile?userId=".concat(t.Id),children:(0,r.jsx)(a.A,{user:t})}):void 0}},57807:function(e,t,n){var r=n(62540),i=n(77890),o=n(85187),a=n(60545),c=n(48451),l=n(47997),s=n(19949),u=(n(63696),n(5898)),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)};t.A=function(e){var t=e.confirmButtonColor,n=void 0===t?"primary":t,d=e.confirmButtonText,p=e.title,v=e.text,y=e.onCancel,h=e.onConfirm,m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["confirmButtonColor","confirmButtonText","title","text","onCancel","onConfirm"]);return(0,r.jsxs)(o.A,f({},m,{children:[(0,r.jsx)(s.A,{children:p}),(0,r.jsx)(c.A,{children:(0,r.jsx)(l.A,{children:v})}),(0,r.jsxs)(a.A,{children:[(0,r.jsx)(i.A,{variant:"text",onClick:y,children:u.Ay.translate("ButtonCancel")}),(0,r.jsx)(i.A,{color:n,onClick:h,children:d||u.Ay.translate("ButtonOk")})]})]}))}},92058:function(e,t,n){n.d(t,{y:function(){return l}});var r=n(7758),i=n(61586),o=n(69410),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)},c=function(e){var t=(0,o.gf)().api;return(0,i.I)({queryKey:["Users"],queryFn:function(n){var i=n.signal;return function(e,t,n){return i=void 0,o=void 0,c=function(){return function(e,t){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){o=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){o.label=c[1];break}if(6===c[0]&&o.label<i[1]){o.label=i[1],i=c;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(c);break}i[2]&&o.ops.pop(),o.trys.pop();continue}c=t.call(e,o)}catch(e){c=[6,e],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(i){switch(i.label){case 0:return[4,(0,r.q)(e).getUsers(t,{signal:null==n?void 0:n.signal})];case 1:return[2,i.sent().data]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{l(c.next(e))}catch(e){t(e)}}function r(e){try{l(c.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a((function(e){e(i)}))).then(n,r)}l((c=c.apply(i,o||[])).next())}));var i,o,a,c}(t,e,{signal:i})},enabled:!!t})},l=function(){var e=c(),t=e.data,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["data"]),r={},i=[];return t&&t.forEach((function(e){var t=e.Id;t&&(r[t]=e),e.Name&&i.push(e.Name)})),a({users:t,usersById:r,names:i},n)}}}]);