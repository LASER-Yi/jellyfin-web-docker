/*! For license information please see bookPlayer-plugin.1e8df074e96d7fd0bdf1.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[10905,19842,64633,68672],{14447:function(e,t,n){n.r(t),n.d(t,{BookPlayer:function(){return P}}),n(29305),n(32733),n(84701),n(81678),n(2623),n(84734),n(44962),n(4754),n(10849),n(70389),n(94),n(36947),n(26437),n(52697),n(78557),n(90076),n(50987),n(83994),n(82367);var o=n(8566),i=n(74550),r=n(79754),a=n(35222),l=n(80245),s=n(5898),u=n(67430),c=n(34789),d=n(82885),h=n(19842),f=n(38783),y=n(44797),v=(n(15453),n(68104));function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function b(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function r(n,o,i,r){var s=o&&o.prototype instanceof l?o:l,u=Object.create(s.prototype);return m(u,"_invoke",function(n,o,i){var r,l,s,u=0,c=i||[],d=!1,h={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return r=t,l=0,s=e,h.n=n,a}};function f(n,o){for(l=n,s=o,t=0;!d&&u&&!i&&t<c.length;t++){var i,r=c[t],f=h.p,y=r[2];n>3?(i=y===o)&&(s=r[(l=r[4])?5:(l=3,3)],r[4]=r[5]=e):r[0]<=f&&((i=n<2&&f<r[1])?(l=0,h.v=o,h.n=r[1]):f<y&&(i=n<3||r[0]>o||o>y)&&(r[4]=n,r[5]=o,h.n=y,l=0))}if(i||n>1)return a;throw d=!0,o}return function(i,c,y){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,y),l=c,s=y;(t=l<2?e:s)||!d;){r||(l?l<3?(l>1&&(h.n=-1),f(l,s)):h.n=s:h.v=s);try{if(u=2,r){if(l||(i="next"),t=r[i]){if(!(t=t.call(r,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=r.return)&&t.call(r),l<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),l=1);r=e}else if((t=(d=h.n<0)?s:n.call(o,h))!==a)break}catch(t){r=e,l=1,s=t}finally{u=1}}return{value:t,done:d}}}(n,i,r),!0),u}var a={};function l(){}function s(){}function u(){}t=Object.getPrototypeOf;var c=[][o]?t(t([][o]())):(m(t={},o,(function(){return this})),t),d=u.prototype=l.prototype=Object.create(c);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,m(e,i,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=u,m(d,"constructor",u),m(u,"constructor",s),s.displayName="GeneratorFunction",m(u,i,"GeneratorFunction"),m(d),m(d,i,"Generator"),m(d,o,(function(){return this})),m(d,"toString",(function(){return"[object Generator]"})),(b=function(){return{w:r,m:h}})()}function m(e,t,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}m=function(e,t,n,o){if(t)i?i(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n;else{var r=function(t,n){m(e,t,(function(e){return this._invoke(t,n,e)}))};r("next",0),r("throw",1),r("return",2)}},m(e,t,n,o)}function k(e,t,n,o,i,r,a){try{var l=e[r](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,i)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var r=e.apply(t,n);function a(e){k(r,o,i,a,l,"next",e)}function l(e){k(r,o,i,a,l,"throw",e)}a(void 0)}))}}function S(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,E(o.key),o)}}function E(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}var w={dark:{body:{color:"#d8dadc",background:"#000","font-size":"medium"}},sepia:{body:{color:"#d8a262",background:"#000","font-size":"medium"}},light:{body:{color:"#000",background:"#fff","font-size":"medium"}}},B=["dark","sepia","light"],T=["x-small","small","medium","large","x-large"],P=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name="Book Player",this.type=f.Q.MediaPlayer,this.id="bookplayer",this.priority=1,this.THEMES=w,d.theme()&&"dark"!==d.theme()?this.theme="light":this.theme="dark",this.fontSize="medium",this.onDialogClosed=this.onDialogClosed.bind(this),this.openTableOfContents=this.openTableOfContents.bind(this),this.rotateTheme=this.rotateTheme.bind(this),this.increaseFontSize=this.increaseFontSize.bind(this),this.decreaseFontSize=this.decreaseFontSize.bind(this),this.previous=this.previous.bind(this),this.next=this.next.bind(this),this.onWindowKeyDown=this.onWindowKeyDown.bind(this),this.addSwipeGestures=this.addSwipeGestures.bind(this)},t=[{key:"play",value:function(e){this.progress=0,this.cancellationToken=!1,this.loaded=!1,o.Ay.show();var t=this.createMediaElement();return this.setCurrentSrc(t,e)}},{key:"stop",value:function(){this.unbindEvents();var e={src:this.item};y.A.trigger(this,"stopped",[e]);var t=this.mediaElement,n=this.tocElement,i=this.rendition;t&&(r.default.close(t),this.mediaElement=null),n&&(n.destroy(),this.tocElement=null),i&&i.destroy(),o.Ay.hide(),this.cancellationToken=!0}},{key:"destroy",value:function(){}},{key:"currentItem",value:function(){return this.item}},{key:"currentTime",value:function(){return 1e3*this.progress}},{key:"duration",value:function(){return 1e3}},{key:"getBufferedRanges",value:function(){return[{start:0,end:1e7}]}},{key:"volume",value:function(){return 100}},{key:"isMuted",value:function(){return!1}},{key:"paused",value:function(){return!1}},{key:"seekable",value:function(){return!0}},{key:"onWindowKeyDown",value:function(e){if(!(e.ctrlKey||e.altKey||e.metaKey||e.shiftKey)){var t=i.Ay.getKeyName(e);if(this.loaded)switch(t){case"l":case"ArrowRight":case"Right":e.preventDefault(),this.next();break;case"j":case"ArrowLeft":case"Left":e.preventDefault(),this.previous();break;case"Escape":e.preventDefault(),this.tocElement?this.tocElement.destroy():this.stop()}}}},{key:"addSwipeGestures",value:function(e){var t=this;this.touchHelper=new h.default(e),y.A.on(this.touchHelper,"swipeleft",(function(){return t.next()})),y.A.on(this.touchHelper,"swiperight",(function(){return t.previous()}))}},{key:"onDialogClosed",value:function(){this.stop()}},{key:"bindMediaElementEvents",value:function(){var e,t,n=this.mediaElement;n.addEventListener("close",this.onDialogClosed,{once:!0}),n.querySelector("#btnBookplayerExit").addEventListener("click",this.onDialogClosed,{once:!0}),n.querySelector("#btnBookplayerToc").addEventListener("click",this.openTableOfContents),n.querySelector("#btnBookplayerFullscreen").addEventListener("click",this.toggleFullscreen),n.querySelector("#btnBookplayerRotateTheme").addEventListener("click",this.rotateTheme),n.querySelector("#btnBookplayerIncreaseFontSize").addEventListener("click",this.increaseFontSize),n.querySelector("#btnBookplayerDecreaseFontSize").addEventListener("click",this.decreaseFontSize),null===(e=n.querySelector("#btnBookplayerPrev"))||void 0===e||e.addEventListener("click",this.previous),null===(t=n.querySelector("#btnBookplayerNext"))||void 0===t||t.addEventListener("click",this.next)}},{key:"bindEvents",value:function(){var e,t=this;if(this.bindMediaElementEvents(),document.addEventListener("keydown",this.onWindowKeyDown),null===(e=this.rendition)||void 0===e||e.on("keydown",this.onWindowKeyDown),c.A.safari){var n=document.getElementById("bookPlayerContainer");this.addSwipeGestures(n)}else{var o;null===(o=this.rendition)||void 0===o||o.on("rendered",(function(e,n){return t.addSwipeGestures(n.document.documentElement)}))}}},{key:"unbindMediaElementEvents",value:function(){var e,t,n=this.mediaElement;n.removeEventListener("close",this.onDialogClosed),n.querySelector("#btnBookplayerExit").removeEventListener("click",this.onDialogClosed),n.querySelector("#btnBookplayerToc").removeEventListener("click",this.openTableOfContents),n.querySelector("#btnBookplayerFullscreen").removeEventListener("click",this.toggleFullscreen),n.querySelector("#btnBookplayerRotateTheme").removeEventListener("click",this.rotateTheme),n.querySelector("#btnBookplayerIncreaseFontSize").removeEventListener("click",this.increaseFontSize),n.querySelector("#btnBookplayerDecreaseFontSize").removeEventListener("click",this.decreaseFontSize),null===(e=n.querySelector("#btnBookplayerPrev"))||void 0===e||e.removeEventListener("click",this.previous),null===(t=n.querySelector("#btnBookplayerNext"))||void 0===t||t.removeEventListener("click",this.next)}},{key:"unbindEvents",value:function(){var e,t,n,o=this;this.mediaElement&&this.unbindMediaElementEvents(),document.removeEventListener("keydown",this.onWindowKeyDown),null===(e=this.rendition)||void 0===e||e.off("keydown",this.onWindowKeyDown),c.A.safari||null===(n=this.rendition)||void 0===n||n.off("rendered",(function(e,t){return o.addSwipeGestures(t.document.documentElement)})),null===(t=this.touchHelper)||void 0===t||t.destroy()}},{key:"openTableOfContents",value:function(){this.loaded&&(this.tocElement=new l.default(this))}},{key:"toggleFullscreen",value:function(){if(a.A.isEnabled){var e=document.querySelector("#btnBookplayerFullscreen .material-icons");e.classList.remove(a.A.isFullscreen?"fullscreen_exit":"fullscreen"),e.classList.add(a.A.isFullscreen?"fullscreen":"fullscreen_exit"),a.A.toggle()}}},{key:"rotateTheme",value:function(){if(this.loaded){var e=B[(B.indexOf(this.theme)+1)%B.length];this.rendition.themes.register("default",w[e]),this.rendition.themes.update("default"),this.theme=e}}},{key:"increaseFontSize",value:function(){if(this.loaded&&this.fontSize!==T[T.length-1]){var e=T[T.indexOf(this.fontSize)+1];this.rendition.themes.fontSize(e),this.fontSize=e}}},{key:"decreaseFontSize",value:function(){if(this.loaded&&this.fontSize!==T[0]){var e=T[T.indexOf(this.fontSize)-1];this.rendition.themes.fontSize(e),this.fontSize=e}}},{key:"previous",value:function(e){null==e||e.preventDefault(),this.rendition&&("rtl"===this.rendition.book.package.metadata.direction?this.rendition.next():this.rendition.prev())}},{key:"next",value:function(e){null==e||e.preventDefault(),this.rendition&&("rtl"===this.rendition.book.package.metadata.direction?this.rendition.prev():this.rendition.next())}},{key:"createMediaElement",value:function(){var e=this.mediaElement;return e||((e=document.getElementById("bookPlayer"))||((e=r.default.createDialog({exitAnimationDuration:400,size:"fullscreen",autoFocus:!1,scrollY:!1,exitAnimation:"fadeout",removeOnClose:!0})).id="bookPlayer",e.innerHTML=(0,s.c1)(v.default),r.default.open(e)),this.mediaElement=e,e)}},{key:"setCurrentSrc",value:function(e,t){var i=this,r=t.items[0];this.item=r,this.streamInfo={started:!0,ended:!1,item:this.item,mediaSource:{Id:r.Id}};var l=r.ServerId,s=u.tF.getApiClient(l);return a.A.isEnabled||(document.getElementById("btnBookplayerFullscreen").display="none"),new Promise((function(e,a){Promise.all([n.e(52590),n.e(55441),n.e(99372),n.e(50857),n.e(98610)]).then(n.bind(n,68352)).then((function(n){var l=n.default,u=s.getItemDownloadUrl(r.Id),c=l(u,{openAs:"epub"}),d=document.body.clientHeight,h=d-.0425*d,f=c.renderTo("bookPlayerContainer",{width:"100%",height:h,flow:"paginated"});return i.currentSrc=u,i.rendition=f,f.themes.register("default",w[i.theme]),f.themes.select("default"),f.display().then((function(){var n=document.querySelector(".epub-container");return n.style.opacity="0",i.bindEvents(),i.rendition.book.locations.generate(1024).then(g(b().m((function r(){var l,s;return b().w((function(r){for(;;)switch(r.n){case 0:if(i.cancellationToken&&a(),0==(l=t.startPositionTicks/1e7)){r.n=1;break}return s=c.locations.cfiFromPercentage(l),r.n=1,f.display(s);case 1:return i.loaded=!0,n.style.opacity="",f.on("relocated",(function(e){i.progress=c.locations.percentageFromCfi(e.start.cfi),y.A.trigger(i,"pause")})),o.Ay.hide(),r.a(2,e())}}),r)}))))}),(function(){return console.error("failed to display epub"),a()}))}))}))}},{key:"canPlayMediaType",value:function(e){return"book"===(e||"").toLowerCase()}},{key:"canPlayItem",value:function(e){var t;return null===(t=e.Path)||void 0===t?void 0:t.endsWith("epub")}}],t&&S(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();t.default=P},19842:function(e,t,n){n.r(t),n(29305),n(32733),n(84701),n(81678),n(44962),n(4754),n(94),n(36947),n(78557),n(83994),n(82367);var o=n(36300),i=n(44797);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,l(o.key),o)}}function l(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}function s(e){return e.changedTouches||e.targetTouches||e.touches}var u=function(){return e=function e(t,n){var r,a,l,u,c,d;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var h=this,f=(n=n||{}).swipeXThreshold||50,y=n.swipeYThreshold||50,v=n.ignoreTagNames||[],p=function(e){var t=s(e)[0];if(r=null,a=0,l=0,u=null,c=null,d=!1,t){var n=t.target;if(o.Ay.parentWithTag(n,v))return;r=n,a=t.clientX,l=t.clientY}},b=function(e){var t="touchmove"===e.type;if(r){var o,v,p,b,m=s(e)[0];m?(p=m.clientX||0,b=m.clientY||0,o=p-(a||0),v=b-(l||0)):(o=0,v=0);var k=null==u?o:o-u,g=null==c?v:v-c;u=o,c=v,o>f&&Math.abs(v)<30?i.A.trigger(h,"swiperight",[r]):o<0-f&&Math.abs(v)<30?i.A.trigger(h,"swipeleft",[r]):(v<0-y||d)&&Math.abs(o)<30?(d=!0,i.A.trigger(h,"swipeup",[r,{deltaY:v,deltaX:o,clientX:p,clientY:b,currentDeltaX:k,currentDeltaY:g}])):(v>y||d)&&Math.abs(o)<30&&(d=!0,i.A.trigger(h,"swipedown",[r,{deltaY:v,deltaX:o,clientX:p,clientY:b,currentDeltaX:k,currentDeltaY:g}])),t&&n.preventDefaultOnMove&&e.preventDefault()}t||(r=null,a=0,l=0,u=null,c=null,d=!1)};this.touchStart=p,this.touchEnd=b,o.Ay.addEventListener(t,"touchstart",p,{passive:!0}),n.triggerOnMove&&o.Ay.addEventListener(t,"touchmove",b,{passive:!n.preventDefaultOnMove}),o.Ay.addEventListener(t,"touchend",b,{passive:!0}),o.Ay.addEventListener(t,"touchcancel",b,{passive:!0})},(t=[{key:"destroy",value:function(){var e=this.elem;if(e){var t=this.touchStart,n=this.touchEnd;o.Ay.removeEventListener(e,"touchstart",t,{passive:!0}),o.Ay.removeEventListener(e,"touchmove",n,{passive:!0}),o.Ay.removeEventListener(e,"touchend",n,{passive:!0}),o.Ay.removeEventListener(e,"touchcancel",n,{passive:!0})}this.touchStart=null,this.touchEnd=null,this.elem=null}}])&&a(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();t.default=u},68104:function(e,t,n){n.r(t),t.default='<div class="topButtons"> <button is="paper-icon-button-light" id="btnBookplayerToc" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon toc" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerPrev" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon navigate_before" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerNext" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon navigate_next" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerExit" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon close" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerRotateTheme" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon remove_red_eye" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerDecreaseFontSize" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon text_decrease" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerIncreaseFontSize" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon text_increase" aria-hidden="true"></span> </button> <button is="paper-icon-button-light" id="btnBookplayerFullscreen" class="autoSize bookplayerButton hide-mouse-idle-tv" tabindex="-1"> <span class="material-icons bookplayerButtonIcon fullscreen" aria-hidden="true"></span> </button> </div> <div id="bookPlayerContainer" class="bookPlayerContainer"></div> '},80245:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}}),n(29305),n(32733),n(84701),n(81678),n(24776),n(44962),n(86584),n(89336),n(4754),n(94),n(36947),n(78557),n(83994),n(64062),n(23630),n(82367);var o=n(22696),i=n.n(o),r=n(79754),a=n(46782);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,u(o.key),o)}}function u(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bookPlayer=t,this.rendition=t.rendition,this.onDialogClosed=this.onDialogClosed.bind(this),this.createMediaElement()},(t=[{key:"destroy",value:function(){var e=this.elem;e&&(this.unbindEvents(),r.default.close(e)),this.bookPlayer.tocElement=null}},{key:"bindEvents",value:function(){var e=this.elem;e.addEventListener("close",this.onDialogClosed,{once:!0}),e.querySelector(".btnBookplayerTocClose").addEventListener("click",this.onDialogClosed,{once:!0})}},{key:"unbindEvents",value:function(){var e=this.elem;e.removeEventListener("close",this.onDialogClosed),e.querySelector(".btnBookplayerTocClose").removeEventListener("click",this.onDialogClosed)}},{key:"onDialogClosed",value:function(){this.destroy()}},{key:"replaceLinks",value:function(e,t){e.querySelectorAll("a[href]").forEach((function(e){var n=e.getAttribute("href");e.onclick=function(){return t(n),!1}}))}},{key:"chapterTocItem",value:function(e,t){var n,o=this,r="<li>",l=t.href.startsWith("../")?t.href.slice(3):t.href;if(r+='<a style="color: '.concat(a.A.mobile?this.bookPlayer.THEMES[this.bookPlayer.theme].body.color:"inherit",'" href="').concat(i()(e.path.directory+l),'">').concat(i()(t.label),"</a>"),null!==(n=t.subitems)&&void 0!==n&&n.length){var s=t.subitems.map((function(t){return o.chapterTocItem(e,t)})).join("");r+="<ul>".concat(s,"</ul>")}return r+"</li>"}},{key:"createMediaElement",value:function(){var e=this,t=this.rendition,n=r.default.createDialog({size:"small",autoFocus:!1,removeOnClose:!0});n.id="dialogToc";var o='<div class="topRightActionButtons">';o+='<button is="paper-icon-button-light" class="autoSize bookplayerButton btnBookplayerTocClose hide-mouse-idle-tv" tabindex="-1"><span class="material-icons bookplayerButtonIcon close" aria-hidden="true"></span></button>',o+="</div>",o+='<ul style="background-color: '.concat(a.A.mobile?this.bookPlayer.THEMES[this.bookPlayer.theme].body.background:"inherit",'" class="toc">'),t.book.navigation.forEach((function(n){o+=e.chapterTocItem(t.book,n)})),o+="</ul>",n.innerHTML=o,this.replaceLinks(n,(function(n){var o=t.book.path.relative(n);t.display(o),e.destroy()})),this.elem=n,this.bindEvents(),r.default.open(n)}}])&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()}}]);