/*! For license information please see 5487.0a249b8fd3f85e83ddb9.bundle.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[5487],{46042:function(t,e){"use strict";function n(t,e){return void 0===e&&(e=Object),e&&"function"==typeof e.freeze?e.freeze(t):t}var i=n({HTML:"text/html",isHTML:function(t){return t===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),r=n({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===r.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});e.freeze=n,e.MIME_TYPE=i,e.NAMESPACE=r},5289:function(t,e,n){var i=n(46042),r=n(77990),o=n(32128),s=n(82394),a=r.DOMImplementation,u=i.NAMESPACE,l=s.ParseError,h=s.XMLReader;function c(t){this.options=t||{locator:{}}}function f(){this.cdata=!1}function d(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function p(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function v(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function m(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}c.prototype.parseFromString=function(t,e){var n=this.options,i=new h,r=n.domBuilder||new f,s=n.errorHandler,a=n.locator,l=n.xmlns||{},c=/\/x?html?$/.test(e),d=c?o.HTML_ENTITIES:o.XML_ENTITIES;return a&&r.setDocumentLocator(a),i.errorHandler=function(t,e,n){if(!t){if(e instanceof f)return e;t=e}var i={},r=t instanceof Function;function o(e){var o=t[e];!o&&r&&(o=2==t.length?function(n){t(e,n)}:t),i[e]=o&&function(t){o("[xmldom "+e+"]\t"+t+p(n))}||function(){}}return n=n||{},o("warning"),o("error"),o("fatalError"),i}(s,r,a),i.domBuilder=n.domBuilder||r,c&&(l[""]=u.HTML),l.xml=l.xml||u.XML,t&&"string"==typeof t?i.parse(t,l,d):i.errorHandler.error("invalid doc source"),r.doc},f.prototype={startDocument:function(){this.doc=(new a).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,n,i){var r=this.doc,o=r.createElementNS(t,n||e),s=i.length;m(this,o),this.currentElement=o,this.locator&&d(this.locator,o);for(var a=0;a<s;a++){t=i.getURI(a);var u=i.getValue(a),l=(n=i.getQName(a),r.createAttributeNS(t,n));this.locator&&d(i.getLocator(a),l),l.value=l.nodeValue=u,o.setAttributeNode(l)}},endElement:function(t,e,n){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.doc.createProcessingInstruction(t,e);this.locator&&d(this.locator,n),m(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=v.apply(this,arguments)){if(this.cdata)var i=this.doc.createCDATASection(t);else i=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(t)&&this.doc.appendChild(i),this.locator&&d(this.locator,i)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=v.apply(this,arguments);var i=this.doc.createComment(t);this.locator&&d(this.locator,i),m(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(t,e,n);this.locator&&d(this.locator,r),m(this,r),this.doc.doctype=r}},warning:function(t){console.warn("[xmldom warning]\t"+t,p(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,p(this.locator))},fatalError:function(t){throw new l(t,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(t){f.prototype[t]=function(){return null}})),e.DOMParser=c,r.DOMImplementation,r.XMLSerializer},77990:function(t,e,n){var i=n(46042).NAMESPACE;function r(t){return""!==t}function o(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function s(t){if(!t)return[];var e=function(t){return t?t.split(/[\t\n\f\r ]+/).filter(r):[]}(t);return Object.keys(e.reduce(o,{}))}function a(t,e){for(var n in t)e[n]=t[n]}function u(t,e){var n=t.prototype;if(!(n instanceof e)){function i(){}i.prototype=e.prototype,a(n,i=new i),t.prototype=n=i}n.constructor!=t&&("function"!=typeof t&&console.error("unknown Class:"+t),n.constructor=t)}var l={},h=l.ELEMENT_NODE=1,c=l.ATTRIBUTE_NODE=2,f=l.TEXT_NODE=3,d=l.CDATA_SECTION_NODE=4,p=l.ENTITY_REFERENCE_NODE=5,v=l.ENTITY_NODE=6,m=l.PROCESSING_INSTRUCTION_NODE=7,g=l.COMMENT_NODE=8,y=l.DOCUMENT_NODE=9,b=l.DOCUMENT_TYPE_NODE=10,w=l.DOCUMENT_FRAGMENT_NODE=11,_=l.NOTATION_NODE=12,k={},x={},S=(k.INDEX_SIZE_ERR=(x[1]="Index size error",1),k.DOMSTRING_SIZE_ERR=(x[2]="DOMString size error",2),k.HIERARCHY_REQUEST_ERR=(x[3]="Hierarchy request error",3)),E=(k.WRONG_DOCUMENT_ERR=(x[4]="Wrong document",4),k.INVALID_CHARACTER_ERR=(x[5]="Invalid character",5),k.NO_DATA_ALLOWED_ERR=(x[6]="No data allowed",6),k.NO_MODIFICATION_ALLOWED_ERR=(x[7]="No modification allowed",7),k.NOT_FOUND_ERR=(x[8]="Not found",8)),C=(k.NOT_SUPPORTED_ERR=(x[9]="Not supported",9),k.INUSE_ATTRIBUTE_ERR=(x[10]="Attribute in use",10));function T(t,e){if(e instanceof Error)var n=e;else n=this,Error.call(this,x[t]),this.message=x[t],Error.captureStackTrace&&Error.captureStackTrace(this,T);return n.code=t,e&&(this.message=this.message+": "+e),n}function N(){}function O(t,e){this._node=t,this._refresh=e,A(this)}function A(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var n=t._refresh(t._node);lt(t,"length",n.length),a(n,t),t._inc=e}}function I(){}function z(t,e){for(var n=t.length;n--;)if(t[n]===e)return n}function R(t,e,n,r){if(r?e[z(e,r)]=n:e[e.length++]=n,t){n.ownerElement=t;var o=t.ownerDocument;o&&(r&&M(o,t,r),function(t,e,n){t&&t._inc++,n.namespaceURI===i.XMLNS&&(e._nsMap[n.prefix?n.localName:""]=n.value)}(o,t,n))}}function P(t,e,n){var i=z(e,n);if(!(i>=0))throw T(E,new Error(t.tagName+"@"+n));for(var r=e.length-1;i<r;)e[i]=e[++i];if(e.length=r,t){var o=t.ownerDocument;o&&(M(o,t,n),n.ownerElement=null)}}function L(){}function j(){}function B(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function D(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(D(t,e))return!0}while(t=t.nextSibling)}function F(){}function M(t,e,n,r){t&&t._inc++,n.namespaceURI===i.XMLNS&&delete e._nsMap[n.prefix?n.localName:""]}function U(t,e,n){if(t&&t._inc){t._inc++;var i=e.childNodes;if(n)i[i.length++]=n;else{for(var r=e.firstChild,o=0;r;)i[o++]=r,r=r.nextSibling;i.length=o}}}function W(t,e){var n=e.previousSibling,i=e.nextSibling;return n?n.nextSibling=i:t.firstChild=i,i?i.previousSibling=n:t.lastChild=n,U(t.ownerDocument,t),e}function q(t,e,n){var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===w){var r=e.firstChild;if(null==r)return e;var o=e.lastChild}else r=o=e;var s=n?n.previousSibling:t.lastChild;r.previousSibling=s,o.nextSibling=n,s?s.nextSibling=r:t.firstChild=r,null==n?t.lastChild=o:n.previousSibling=o;do{r.parentNode=t}while(r!==o&&(r=r.nextSibling));return U(t.ownerDocument||t,t),e.nodeType==w&&(e.firstChild=e.lastChild=null),e}function H(){this._nsMap={}}function X(){}function Z(){}function V(){}function Y(){}function G(){}function K(){}function $(){}function J(){}function Q(){}function tt(){}function et(){}function nt(){}function it(t,e){var n=[],i=9==this.nodeType&&this.documentElement||this,r=i.prefix,o=i.namespaceURI;if(o&&null==r&&null==(r=i.lookupPrefix(o)))var s=[{namespace:o,prefix:null}];return st(this,n,t,e,s),n.join("")}function rt(t,e,n){var r=t.prefix||"",o=t.namespaceURI;if(!o)return!1;if("xml"===r&&o===i.XML||o===i.XMLNS)return!1;for(var s=n.length;s--;){var a=n[s];if(a.prefix===r)return a.namespace!==o}return!0}function ot(t,e,n){t.push(" ",e,'="',n.replace(/[<&"]/g,B),'"')}function st(t,e,n,r,o){if(o||(o=[]),r){if(!(t=r(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case h:var s=t.attributes,a=s.length,u=t.firstChild,l=t.tagName,v=l;if(!(n=i.isHTML(t.namespaceURI)||n)&&!t.prefix&&t.namespaceURI){for(var _,k=0;k<s.length;k++)if("xmlns"===s.item(k).name){_=s.item(k).value;break}if(!_)for(var x=o.length-1;x>=0;x--)if(""===(S=o[x]).prefix&&S.namespace===t.namespaceURI){_=S.namespace;break}if(_!==t.namespaceURI)for(x=o.length-1;x>=0;x--){var S;if((S=o[x]).namespace===t.namespaceURI){S.prefix&&(v=S.prefix+":"+l);break}}}e.push("<",v);for(var E=0;E<a;E++)"xmlns"==(C=s.item(E)).prefix?o.push({prefix:C.localName,namespace:C.value}):"xmlns"==C.nodeName&&o.push({prefix:"",namespace:C.value});for(E=0;E<a;E++){var C,T,N;rt(C=s.item(E),0,o)&&(ot(e,(T=C.prefix||"")?"xmlns:"+T:"xmlns",N=C.namespaceURI),o.push({prefix:T,namespace:N})),st(C,e,n,r,o)}if(l===v&&rt(t,0,o)&&(ot(e,(T=t.prefix||"")?"xmlns:"+T:"xmlns",N=t.namespaceURI),o.push({prefix:T,namespace:N})),u||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(e.push(">"),n&&/^script$/i.test(l))for(;u;)u.data?e.push(u.data):st(u,e,n,r,o.slice()),u=u.nextSibling;else for(;u;)st(u,e,n,r,o.slice()),u=u.nextSibling;e.push("</",v,">")}else e.push("/>");return;case y:case w:for(u=t.firstChild;u;)st(u,e,n,r,o.slice()),u=u.nextSibling;return;case c:return ot(e,t.name,t.value);case f:return e.push(t.data.replace(/[<&]/g,B).replace(/]]>/g,"]]&gt;"));case d:return e.push("<![CDATA[",t.data,"]]>");case g:return e.push("\x3c!--",t.data,"--\x3e");case b:var O=t.publicId,A=t.systemId;if(e.push("<!DOCTYPE ",t.name),O)e.push(" PUBLIC ",O),A&&"."!=A&&e.push(" ",A),e.push(">");else if(A&&"."!=A)e.push(" SYSTEM ",A,">");else{var I=t.internalSubset;I&&e.push(" [",I,"]"),e.push(">")}return;case m:return e.push("<?",t.target," ",t.data,"?>");case p:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function at(t,e,n){var i;switch(e.nodeType){case h:(i=e.cloneNode(!1)).ownerDocument=t;case w:break;case c:n=!0}if(i||(i=e.cloneNode(!1)),i.ownerDocument=t,i.parentNode=null,n)for(var r=e.firstChild;r;)i.appendChild(at(t,r,n)),r=r.nextSibling;return i}function ut(t,e,n){var i=new e.constructor;for(var r in e){var o=e[r];"object"!=typeof o&&o!=i[r]&&(i[r]=o)}switch(e.childNodes&&(i.childNodes=new N),i.ownerDocument=t,i.nodeType){case h:var s=e.attributes,a=i.attributes=new I,u=s.length;a._ownerElement=i;for(var l=0;l<u;l++)i.setAttributeNode(ut(t,s.item(l),!0));break;case c:n=!0}if(n)for(var f=e.firstChild;f;)i.appendChild(ut(t,f,n)),f=f.nextSibling;return i}function lt(t,e,n){t[e]=n}k.INVALID_STATE_ERR=(x[11]="Invalid state",11),k.SYNTAX_ERR=(x[12]="Syntax error",12),k.INVALID_MODIFICATION_ERR=(x[13]="Invalid modification",13),k.NAMESPACE_ERR=(x[14]="Invalid namespace",14),k.INVALID_ACCESS_ERR=(x[15]="Invalid access",15),T.prototype=Error.prototype,a(k,T),N.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var n=[],i=0;i<this.length;i++)st(this[i],n,t,e);return n.join("")}},O.prototype.item=function(t){return A(this),this[t]},u(O,N),I.prototype={length:0,item:N.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var n=this[e];if(n.nodeName==t)return n}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new T(C);var n=this.getNamedItem(t.nodeName);return R(this._ownerElement,this,t,n),n},setNamedItemNS:function(t){var e,n=t.ownerElement;if(n&&n!=this._ownerElement)throw new T(C);return e=this.getNamedItemNS(t.namespaceURI,t.localName),R(this._ownerElement,this,t,e),e},removeNamedItem:function(t){var e=this.getNamedItem(t);return P(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var n=this.getNamedItemNS(t,e);return P(this._ownerElement,this,n),n},getNamedItemNS:function(t,e){for(var n=this.length;n--;){var i=this[n];if(i.localName==e&&i.namespaceURI==t)return i}return null}},L.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,n){var i=new F;if(i.implementation=this,i.childNodes=new N,i.doctype=n||null,n&&i.appendChild(n),e){var r=i.createElementNS(t,e);i.appendChild(r)}return i},createDocumentType:function(t,e,n){var i=new K;return i.name=t,i.nodeName=t,i.publicId=e||"",i.systemId=n||"",i}},j.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return q(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return W(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return ut(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==f&&t.nodeType==f?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var n=e._nsMap;if(n)for(var i in n)if(n[i]==t)return i;e=e.nodeType==c?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var n=e._nsMap;if(n&&t in n)return n[t];e=e.nodeType==c?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)}},a(l,j),a(l,j.prototype),F.prototype={nodeName:"#document",nodeType:y,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==w){for(var n=t.firstChild;n;){var i=n.nextSibling;this.insertBefore(n,e),n=i}return t}return null==this.documentElement&&t.nodeType==h&&(this.documentElement=t),q(this,t,e),t.ownerDocument=this,t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),W(this,t)},importNode:function(t,e){return at(this,t,e)},getElementById:function(t){var e=null;return D(this.documentElement,(function(n){if(n.nodeType==h&&n.getAttribute("id")==t)return e=n,!0})),e},getElementsByClassName:function(t){var e=s(t);return new O(this,(function(n){var i=[];return e.length>0&&D(n.documentElement,(function(r){if(r!==n&&r.nodeType===h){var o=r.getAttribute("class");if(o){var a=t===o;if(!a){var u=s(o);a=e.every((l=u,function(t){return l&&-1!==l.indexOf(t)}))}a&&i.push(r)}}var l})),i}))},createElement:function(t){var e=new H;return e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new N,(e.attributes=new I)._ownerElement=e,e},createDocumentFragment:function(){var t=new tt;return t.ownerDocument=this,t.childNodes=new N,t},createTextNode:function(t){var e=new V;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new Y;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new G;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var n=new et;return n.ownerDocument=this,n.tagName=n.target=t,n.nodeValue=n.data=e,n},createAttribute:function(t){var e=new X;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new Q;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var n=new H,i=e.split(":"),r=n.attributes=new I;return n.childNodes=new N,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=t,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=e,r._ownerElement=n,n},createAttributeNS:function(t,e){var n=new X,i=e.split(":");return n.ownerDocument=this,n.nodeName=e,n.name=e,n.namespaceURI=t,n.specified=!0,2==i.length?(n.prefix=i[0],n.localName=i[1]):n.localName=e,n}},u(F,j),H.prototype={nodeType:h,hasAttribute:function(t){return null!=this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var n=this.ownerDocument.createAttribute(t);n.value=n.nodeValue=""+e,this.setAttributeNode(n)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===w?this.insertBefore(t,null):function(t,e){var n=e.parentNode;if(n){var i=t.lastChild;n.removeChild(e),i=t.lastChild}return i=t.lastChild,e.parentNode=t,e.previousSibling=i,e.nextSibling=null,i?i.nextSibling=e:t.firstChild=e,t.lastChild=e,U(t.ownerDocument,t,e),e}(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);n&&this.removeAttributeNode(n)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var n=this.getAttributeNodeNS(t,e);return n&&n.value||""},setAttributeNS:function(t,e,n){var i=this.ownerDocument.createAttributeNS(t,e);i.value=i.nodeValue=""+n,this.setAttributeNode(i)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new O(this,(function(e){var n=[];return D(e,(function(i){i===e||i.nodeType!=h||"*"!==t&&i.tagName!=t||n.push(i)})),n}))},getElementsByTagNameNS:function(t,e){return new O(this,(function(n){var i=[];return D(n,(function(r){r===n||r.nodeType!==h||"*"!==t&&r.namespaceURI!==t||"*"!==e&&r.localName!=e||i.push(r)})),i}))}},F.prototype.getElementsByTagName=H.prototype.getElementsByTagName,F.prototype.getElementsByTagNameNS=H.prototype.getElementsByTagNameNS,u(H,j),X.prototype.nodeType=c,u(X,j),Z.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(x[S])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,n){n=this.data.substring(0,t)+n+this.data.substring(t+e),this.nodeValue=this.data=n,this.length=n.length}},u(Z,j),V.prototype={nodeName:"#text",nodeType:f,splitText:function(t){var e=this.data,n=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}},u(V,Z),Y.prototype={nodeName:"#comment",nodeType:g},u(Y,Z),G.prototype={nodeName:"#cdata-section",nodeType:d},u(G,Z),K.prototype.nodeType=b,u(K,j),$.prototype.nodeType=_,u($,j),J.prototype.nodeType=v,u(J,j),Q.prototype.nodeType=p,u(Q,j),tt.prototype.nodeName="#document-fragment",tt.prototype.nodeType=w,u(tt,j),et.prototype.nodeType=m,u(et,j),nt.prototype.serializeToString=function(t,e,n){return it.call(t,e,n)},j.prototype.toString=it;try{if(Object.defineProperty){function ht(t){switch(t.nodeType){case h:case w:var e=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&e.push(ht(t)),t=t.nextSibling;return e.join("");default:return t.nodeValue}}Object.defineProperty(O.prototype,"length",{get:function(){return A(this),this.$$length}}),Object.defineProperty(j.prototype,"textContent",{get:function(){return ht(this)},set:function(t){switch(this.nodeType){case h:case w:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),lt=function(t,e,n){t["$$"+e]=n}}}catch(t){}e.DocumentType=K,e.DOMException=T,e.DOMImplementation=L,e.Element=H,e.Node=j,e.NodeList=N,e.XMLSerializer=nt},32128:function(t,e,n){var i=n(46042).freeze;e.XML_ENTITIES=i({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),e.HTML_ENTITIES=i({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}),e.entityMap=e.HTML_ENTITIES},23337:function(t,e,n){var i=n(77990);i.DOMImplementation,i.XMLSerializer,e.DOMParser=n(5289).DOMParser},82394:function(t,e,n){var i=n(46042).NAMESPACE,r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,o=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),s=new RegExp("^"+r.source+o.source+"*(?::"+r.source+o.source+"*)?$");function a(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,a)}function u(){}function l(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function h(t,e,n,r,o,s){function a(t,e,i){n.attributeNames.hasOwnProperty(t)&&s.fatalError("Attribute "+t+" redefined"),n.addValue(t,e,i)}for(var u,l=++e,h=0;;){var c=t.charAt(l);switch(c){case"=":if(1===h)u=t.slice(e,l),h=3;else{if(2!==h)throw new Error("attribute equal must after attrName");h=3}break;case"'":case'"':if(3===h||1===h){if(1===h&&(s.warning('attribute value must after "="'),u=t.slice(e,l)),e=l+1,!((l=t.indexOf(c,e))>0))throw new Error("attribute value no end '"+c+"' match");a(u,f=t.slice(e,l).replace(/&#?\w+;/g,o),e-1),h=5}else{if(4!=h)throw new Error('attribute value must after "="');a(u,f=t.slice(e,l).replace(/&#?\w+;/g,o),e),s.warning('attribute "'+u+'" missed start quot('+c+")!!"),e=l+1,h=5}break;case"/":switch(h){case 0:n.setTagName(t.slice(e,l));case 5:case 6:case 7:h=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),0==h&&n.setTagName(t.slice(e,l)),l;case">":switch(h){case 0:n.setTagName(t.slice(e,l));case 5:case 6:case 7:break;case 4:case 1:"/"===(f=t.slice(e,l)).slice(-1)&&(n.closed=!0,f=f.slice(0,-1));case 2:2===h&&(f=u),4==h?(s.warning('attribute "'+f+'" missed quot(")!'),a(u,f.replace(/&#?\w+;/g,o),e)):(i.isHTML(r[""])&&f.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),a(f,f,e));break;case 3:throw new Error("attribute value missed!!")}return l;case"":c=" ";default:if(c<=" ")switch(h){case 0:n.setTagName(t.slice(e,l)),h=6;break;case 1:u=t.slice(e,l),h=2;break;case 4:var f=t.slice(e,l).replace(/&#?\w+;/g,o);s.warning('attribute "'+f+'" missed quot(")!!'),a(u,f,e);case 5:h=6}else switch(h){case 2:n.tagName,i.isHTML(r[""])&&u.match(/^(?:disabled|checked|selected)$/i)||s.warning('attribute "'+u+'" missed value!! "'+u+'" instead2!!'),a(u,u,e),e=l,h=1;break;case 5:s.warning('attribute space is required"'+u+'"!!');case 6:h=1,e=l;break;case 3:h=4,e=l;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}function c(t,e,n){for(var r=t.tagName,o=null,s=t.length;s--;){var a=t[s],u=a.qName,l=a.value;if((d=u.indexOf(":"))>0)var h=a.prefix=u.slice(0,d),c=u.slice(d+1),f="xmlns"===h&&c;else c=u,h=null,f="xmlns"===u&&"";a.localName=c,!1!==f&&(null==o&&(o={},p(n,n={})),n[f]=o[f]=l,a.uri=i.XMLNS,e.startPrefixMapping(f,l))}for(s=t.length;s--;)(h=(a=t[s]).prefix)&&("xml"===h&&(a.uri=i.XML),"xmlns"!==h&&(a.uri=n[h||""]));var d;(d=r.indexOf(":"))>0?(h=t.prefix=r.slice(0,d),c=t.localName=r.slice(d+1)):(h=null,c=t.localName=r);var v=t.uri=n[h||""];if(e.startElement(v,c,r,t),!t.closed)return t.currentNSMap=n,t.localNSMap=o,!0;if(e.endElement(v,c,r),o)for(h in o)e.endPrefixMapping(h)}function f(t,e,n,i,r){if(/^(?:script|textarea)$/i.test(n)){var o=t.indexOf("</"+n+">",e),s=t.substring(e+1,o);if(/[&<]/.test(s))return/^script$/i.test(n)?(r.characters(s,0,s.length),o):(s=s.replace(/&#?\w+;/g,i),r.characters(s,0,s.length),o)}return e+1}function d(t,e,n,i){var r=i[n];return null==r&&((r=t.lastIndexOf("</"+n+">"))<e&&(r=t.lastIndexOf("</"+n)),i[n]=r),r<e}function p(t,e){for(var n in t)e[n]=t[n]}function v(t,e,n,i){if("-"===t.charAt(e+2))return"-"===t.charAt(e+3)?(r=t.indexOf("--\x3e",e+4))>e?(n.comment(t,e+4,r-e-4),r+3):(i.error("Unclosed comment"),-1):-1;if("CDATA["==t.substr(e+3,6)){var r=t.indexOf("]]>",e+9);return n.startCDATA(),n.characters(t,e+9,r-e-9),n.endCDATA(),r+3}var o=function(t,e){var n,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=e,r.exec(t);n=r.exec(t);)if(i.push(n),n[1])return i}(t,e),s=o.length;if(s>1&&/!doctype/i.test(o[0][0])){var a=o[1][0],u=!1,l=!1;s>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],l=s>4&&o[4][0]):/^system$/i.test(o[2][0])&&(l=o[3][0]));var h=o[s-1];return n.startDTD(a,u,l),n.endDTD(),h.index+h[0].length}return-1}function m(t,e,n){var i=t.indexOf("?>",e);if(i){var r=t.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,n.processingInstruction(r[1],r[2]),i+2):-1}return-1}function g(){this.attributeNames={}}a.prototype=new Error,a.prototype.name=a.name,u.prototype={parse:function(t,e,n){var r=this.domBuilder;r.startDocument(),p(e,e={}),function(t,e,n,r,o){function s(t){var e=t.slice(1,-1);return e in n?n[e]:"#"===e.charAt(0)?function(t){if(t>65535){var e=55296+((t-=65536)>>10),n=56320+(1023&t);return String.fromCharCode(e,n)}return String.fromCharCode(t)}(parseInt(e.substr(1).replace("x","0x"))):(o.error("entity not found:"+t),t)}function u(e){if(e>S){var n=t.substring(S,e).replace(/&#?\w+;/g,s);_&&p(S),r.characters(n,0,e-S),S=e}}function p(e,n){for(;e>=b&&(n=w.exec(t));)y=n.index,b=y+n[0].length,_.lineNumber++;_.columnNumber=e-y+1}for(var y=0,b=0,w=/.*(?:\r\n?|\n)|.*$/g,_=r.locator,k=[{currentNSMap:e}],x={},S=0;;){try{var E=t.indexOf("<",S);if(E<0){if(!t.substr(S).match(/^\s*$/)){var C=r.doc,T=C.createTextNode(t.substr(S));C.appendChild(T),r.currentElement=T}return}switch(E>S&&u(E),t.charAt(E+1)){case"/":var N=t.indexOf(">",E+3),O=t.substring(E+2,N).replace(/[ \t\n\r]+$/g,""),A=k.pop();N<0?(O=t.substring(E+2).replace(/[\s<].*/,""),o.error("end tag name: "+O+" is not complete:"+A.tagName),N=E+1+O.length):O.match(/\s</)&&(O=O.replace(/[\s<].*/,""),o.error("end tag name: "+O+" maybe not complete"),N=E+1+O.length);var I=A.localNSMap,z=A.tagName==O;if(z||A.tagName&&A.tagName.toLowerCase()==O.toLowerCase()){if(r.endElement(A.uri,A.localName,O),I)for(var R in I)r.endPrefixMapping(R);z||o.fatalError("end tag name: "+O+" is not match the current start tagName:"+A.tagName)}else k.push(A);N++;break;case"?":_&&p(E),N=m(t,E,r);break;case"!":_&&p(E),N=v(t,E,r,o);break;default:_&&p(E);var P=new g,L=k[k.length-1].currentNSMap,j=(N=h(t,E,P,L,s,o),P.length);if(!P.closed&&d(t,N,P.tagName,x)&&(P.closed=!0,n.nbsp||o.warning("unclosed xml attribute")),_&&j){for(var B=l(_,{}),D=0;D<j;D++){var F=P[D];p(F.offset),F.locator=l(_,{})}r.locator=B,c(P,r,L)&&k.push(P),r.locator=_}else c(P,r,L)&&k.push(P);i.isHTML(P.uri)&&!P.closed?N=f(t,N,P.tagName,s,r):N++}}catch(t){if(t instanceof a)throw t;o.error("element parse error: "+t),N=-1}N>S?S=N:u(Math.max(E,S)+1)}}(t,e,n,r,this.errorHandler),r.endDocument()}},g.prototype={setTagName:function(t){if(!s.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,n){if(!s.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:n}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},e.XMLReader=u,e.ParseError=a},45487:function(t,e,n){"use strict";n.r(e),n.d(e,{Book:function(){return Si},Contents:function(){return an},EpubCFI:function(){return at},Layout:function(){return He},Rendition:function(){return ti},default:function(){return Ci}});var i={};n.r(i),n.d(i,{RangeObject:function(){return G},blob2base64:function(){return W},borders:function(){return x},bounds:function(){return k},createBase64Url:function(){return R},createBlob:function(){return A},createBlobUrl:function(){return I},defaults:function(){return g},defer:function(){return q},documentHeight:function(){return f},extend:function(){return y},filterChildren:function(){return V},findChildren:function(){return X},getParentByTagName:function(){return Y},indexOfElementNode:function(){return N},indexOfNode:function(){return C},indexOfSorted:function(){return _},indexOfTextNode:function(){return T},insert:function(){return b},isElement:function(){return d},isFloat:function(){return v},isNumber:function(){return p},isXml:function(){return O},locationOf:function(){return w},nodeBounds:function(){return S},parents:function(){return Z},parse:function(){return L},prefixed:function(){return m},qs:function(){return j},qsa:function(){return B},qsp:function(){return D},querySelectorByType:function(){return H},requestAnimationFrame:function(){return l},revokeBlobUrl:function(){return z},sprint:function(){return F},treeWalker:function(){return M},type:function(){return P},uuid:function(){return c},walk:function(){return U},windowBounds:function(){return E}}),n(84925),n(91572),n(63238),n(5769),n(61418),n(17460),n(14078),n(40895),n(27471),n(52077),n(911),n(23938),n(19068),n(87211),n(25901),n(92189),n(95163),n(99785),n(91047);var r=n(58709),o=n.n(r),s=(n(70684),n(68581),n(43512),n(72410),n(55849),n(713),n(20252),n(38217),n(32081),n(98010),n(64844),n(23337));function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===a(r)?r:String(r)),i)}var r}var l="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),h="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function c(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:7&n|8).toString(16)}))}function f(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function d(t){return!(!t||1!=t.nodeType)}function p(t){return!isNaN(parseFloat(t))&&isFinite(t)}function v(t){var e=parseFloat(t);return!1!==p(t)&&("string"==typeof t&&t.indexOf(".")>-1||Math.floor(e)!==e)}function m(t){var e=["-webkit-","-webkit-","-moz-","-o-","-ms-"],n=t.toLowerCase(),i=["Webkit","webkit","Moz","O","ms"].length;if("undefined"==typeof document||void 0!==document.body.style[n])return t;for(var r=0;r<i;r++)if(void 0!==document.body.style[e[r]+n])return e[r]+n;return t}function g(t){for(var e=1,n=arguments.length;e<n;e++){var i=arguments[e];for(var r in i)void 0===t[r]&&(t[r]=i[r])}return t}function y(t){var e=[].slice.call(arguments,1);return e.forEach((function(e){e&&Object.getOwnPropertyNames(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))})),t}function b(t,e,n){var i=w(t,e,n);return e.splice(i,0,t),i}function w(t,e,n,i,r){var o,s=i||0,a=r||e.length,u=parseInt(s+(a-s)/2);return n||(n=function(t,e){return t>e?1:t<e?-1:t==e?0:void 0}),a-s<=0?u:(o=n(e[u],t),a-s==1?o>=0?u:u+1:0===o?u:-1===o?w(t,e,n,u,a):w(t,e,n,s,u))}function _(t,e,n,i,r){var o,s=i||0,a=r||e.length,u=parseInt(s+(a-s)/2);return n||(n=function(t,e){return t>e?1:t<e?-1:t==e?0:void 0}),a-s<=0?-1:(o=n(e[u],t),a-s==1?0===o?u:-1:0===o?u:-1===o?_(t,e,n,u,a):_(t,e,n,s,u))}function k(t){var e=window.getComputedStyle(t),n=0,i=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(t){n+=parseFloat(e[t])||0})),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(t){i+=parseFloat(e[t])||0})),{height:i,width:n}}function x(t){var e=window.getComputedStyle(t),n=0,i=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(t){n+=parseFloat(e[t])||0})),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(t){i+=parseFloat(e[t])||0})),{height:i,width:n}}function S(t){var e,n=t.ownerDocument;if(t.nodeType==Node.TEXT_NODE){var i=n.createRange();i.selectNodeContents(t),e=i.getBoundingClientRect()}else e=t.getBoundingClientRect();return e}function E(){var t=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}function C(t,e){for(var n,i=t.parentNode.childNodes,r=-1,o=0;o<i.length&&((n=i[o]).nodeType===e&&r++,n!=t);o++);return r}function T(t){return C(t,3)}function N(t){return C(t,1)}function O(t){return["xml","opf","ncx"].indexOf(t)>-1}function A(t,e){return new Blob([t],{type:e})}function I(t,e){var n=A(t,e);return h.createObjectURL(n)}function z(t){return h.revokeObjectURL(t)}function R(t,e){if("string"==typeof t)return"data:"+e+";base64,"+btoa(t)}function P(t){return Object.prototype.toString.call(t).slice(8,-1)}function L(t,e,n){var i;return i="undefined"==typeof DOMParser||n?s.DOMParser:DOMParser,65279===t.charCodeAt(0)&&(t=t.slice(1)),(new i).parseFromString(t,e)}function j(t,e){var n;if(!t)throw new Error("No Element Provided");return void 0!==t.querySelector?t.querySelector(e):(n=t.getElementsByTagName(e)).length?n[0]:void 0}function B(t,e){return void 0!==t.querySelector?t.querySelectorAll(e):t.getElementsByTagName(e)}function D(t,e,n){var i,r;if(void 0!==t.querySelector){for(var o in e+="[",n)e+=o+"~='"+n[o]+"'";return e+="]",t.querySelector(e)}if(i=t.getElementsByTagName(e),r=Array.prototype.slice.call(i,0).filter((function(t){for(var e in n)if(t.getAttribute(e)===n[e])return!0;return!1})),r)return r[0]}function F(t,e){void 0!==(t.ownerDocument||t).createTreeWalker?M(t,e,NodeFilter.SHOW_TEXT):U(t,(function(t){t&&3===t.nodeType&&e(t)}))}function M(t,e,n){for(var i,r=document.createTreeWalker(t,n,null,!1);i=r.nextNode();)e(i)}function U(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(U(t,e))return!0;t=t.nextSibling}while(t)}function W(t){return new Promise((function(e,n){var i=new FileReader;i.readAsDataURL(t),i.onloadend=function(){e(i.result)}}))}function q(){var t=this;this.resolve=null,this.reject=null,this.id=c(),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),Object.freeze(this)}function H(t,e,n){var i;if(void 0!==t.querySelector&&(i=t.querySelector("".concat(e,'[*|type="').concat(n,'"]'))),i&&0!==i.length)return i;i=B(t,e);for(var r=0;r<i.length;r++)if(i[r].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||i[r].getAttribute("epub:type")===n)return i[r]}function X(t){for(var e=[],n=t.childNodes,i=0;i<n.length;i++){var r=n[i];1===r.nodeType&&e.push(r)}return e}function Z(t){for(var e=[t];t;t=t.parentNode)e.unshift(t);return e}function V(t,e,n){for(var i=[],r=t.childNodes,o=0;o<r.length;o++){var s=r[o];if(1===s.nodeType&&s.nodeName.toLowerCase()===e){if(n)return s;i.push(s)}}if(!n)return i}function Y(t,e){var n;if(null!==t&&""!==e)for(n=t.parentNode;1===n.nodeType;){if(n.tagName.toLowerCase()===e)return n;n=n.parentNode}}var G=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}var e,n;return e=t,(n=[{key:"setStart",value:function(t,e){this.startContainer=t,this.startOffset=e,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}},{key:"setEnd",value:function(t,e){this.endContainer=t,this.endOffset=e,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}},{key:"collapse",value:function(t){this.collapsed=!0,t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}},{key:"selectNode",value:function(t){var e=t.parentNode,n=Array.prototype.indexOf.call(e.childNodes,t);this.setStart(e,n),this.setEnd(e,n+1)}},{key:"selectNodeContents",value:function(t){t.childNodes[t.childNodes-1];var e=3===t.nodeType?t.textContent.length:parent.childNodes.length;this.setStart(t,0),this.setEnd(t,e)}},{key:"_commonAncestorContainer",value:function(t,e){var n=Z(t||this.startContainer),i=Z(e||this.endContainer);if(n[0]==i[0])for(var r=0;r<n.length;r++)if(n[r]!=i[r])return n[r-1]}},{key:"_checkCollapsed",value:function(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}},{key:"toString",value:function(){}}])&&u(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),K=(n(83526),n(6011)),$=n.n(K);function J(t){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(t)}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==J(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==J(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===J(r)?r:String(r)),i)}var r}var tt=function(){function t(e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e.indexOf("://")>-1&&(e=new URL(e).pathname),n=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=n.dir+"/",this.filename=n.base,this.extension=n.ext.slice(1)}var e,n;return e=t,(n=[{key:"parse",value:function(t){return $().parse(t)}},{key:"isAbsolute",value:function(t){return $().isAbsolute(t||this.path)}},{key:"isDirectory",value:function(t){return"/"===t.charAt(t.length-1)}},{key:"resolve",value:function(t){return $().resolve(this.directory,t)}},{key:"relative",value:function(t){return t&&t.indexOf("://")>-1?t:$().relative(this.directory,t)}},{key:"splitPath",value:function(t){return this.splitPathRe.exec(t).slice(1)}},{key:"toString",value:function(){return this.path}}])&&Q(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==et(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==et(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===et(r)?r:String(r)),i)}var r}var it=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=e.indexOf("://")>-1,r=e;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=n,!i&&!1!==n&&"string"!=typeof n&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,r=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch(t){this.Url=void 0,this.base&&(r=new tt(this.base).resolve(r))}this.Path=new tt(r),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}var e,n;return e=t,(n=[{key:"path",value:function(){return this.Path}},{key:"resolve",value:function(t){var e;return t.indexOf("://")>-1?t:(e=$().resolve(this.directory,t),this.origin+e)}},{key:"relative",value:function(t){return $().relative(t,this.directory)}},{key:"toString",value:function(){return this.href}}])&&nt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function ot(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==rt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==rt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===rt(r)?r:String(r)),i)}var r}n(72482),n(61013),n(1203);var st=function(){function t(e,n,i){var r;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof t))return new t(e,n,i);if("string"==typeof n?this.base=this.parseComponent(n):"object"===rt(n)&&n.steps&&(this.base=n),"string"===(r=this.checkType(e)))return this.str=e,y(this,this.parse(e));if("range"===r)return y(this,this.fromRange(e,this.base,i));if("node"===r)return y(this,this.fromNode(e,this.base,i));if("EpubCFI"===r&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}var e,n;return e=t,n=[{key:"checkType",value:function(e){return this.isCfiString(e)?"string":!e||"object"!==rt(e)||"Range"!==P(e)&&void 0===e.startContainer?e&&"object"===rt(e)&&void 0!==e.nodeType?"node":!!(e&&"object"===rt(e)&&e instanceof t)&&"EpubCFI":"range"}},{key:"parse",value:function(t){var e,n,i,r={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof t?{spinePos:-1}:(0===t.indexOf("epubcfi(")&&")"===t[t.length-1]&&(t=t.slice(8,t.length-1)),(e=this.getChapterComponent(t))?(r.base=this.parseComponent(e),n=this.getPathComponent(t),r.path=this.parseComponent(n),(i=this.getRange(t))&&(r.range=!0,r.start=this.parseComponent(i[0]),r.end=this.parseComponent(i[1])),r.spinePos=r.base.steps[1].index,r):{spinePos:-1})}},{key:"parseComponent",value:function(t){var e,n={steps:[],terminal:{offset:null,assertion:null}},i=t.split(":"),r=i[0].split("/");return i.length>1&&(e=i[1],n.terminal=this.parseTerminal(e)),""===r[0]&&r.shift(),n.steps=r.map(function(t){return this.parseStep(t)}.bind(this)),n}},{key:"parseStep",value:function(t){var e,n,i,r,o;if((r=t.match(/\[(.*)\]/))&&r[1]&&(o=r[1]),n=parseInt(t),!isNaN(n))return n%2==0?(e="element",i=n/2-1):(e="text",i=(n-1)/2),{type:e,index:i,id:o||null}}},{key:"parseTerminal",value:function(t){var e,n,i=t.match(/\[(.*)\]/);return i&&i[1]?(e=parseInt(t.split("[")[0]),n=i[1]):e=parseInt(t),p(e)||(e=null),{offset:e,assertion:n}}},{key:"getChapterComponent",value:function(t){return t.split("!")[0]}},{key:"getPathComponent",value:function(t){var e=t.split("!");if(e[1])return e[1].split(",")[0]}},{key:"getRange",value:function(t){var e=t.split(",");return 3===e.length&&[e[1],e[2]]}},{key:"getCharecterOffsetComponent",value:function(t){return t.split(":")[1]||""}},{key:"joinSteps",value:function(t){return t?t.map((function(t){var e="";return"element"===t.type&&(e+=2*(t.index+1)),"text"===t.type&&(e+=1+2*t.index),t.id&&(e+="["+t.id+"]"),e})).join("/"):""}},{key:"segmentString",value:function(t){var e="/";return e+=this.joinSteps(t.steps),t.terminal&&null!=t.terminal.offset&&(e+=":"+t.terminal.offset),t.terminal&&null!=t.terminal.assertion&&(e+="["+t.terminal.assertion+"]"),e}},{key:"toString",value:function(){var t="epubcfi(";return t+=this.segmentString(this.base),t+="!",t+=this.segmentString(this.path),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end)),t+")"}},{key:"compare",value:function(e,n){var i,r,o,s;if("string"==typeof e&&(e=new t(e)),"string"==typeof n&&(n=new t(n)),e.spinePos>n.spinePos)return 1;if(e.spinePos<n.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),o=e.start.terminal):(i=e.path.steps,o=e.path.terminal),n.range?(r=n.path.steps.concat(n.start.steps),s=n.start.terminal):(r=n.path.steps,s=n.path.terminal);for(var a=0;a<i.length;a++){if(!i[a])return-1;if(!r[a])return 1;if(i[a].index>r[a].index)return 1;if(i[a].index<r[a].index)return-1}return i.length<r.length?-1:o.offset>s.offset?1:o.offset<s.offset?-1:0}},{key:"step",value:function(t){var e=3===t.nodeType?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)}}},{key:"filteredStep",value:function(t,e){var n,i=this.filter(t,e);if(i)return n=3===i.nodeType?"text":"element",{id:i.id,tagName:i.tagName,type:n,index:this.filteredPosition(i,e)}}},{key:"pathTo",value:function(t,e,n){for(var i,r={steps:[],terminal:{offset:null,assertion:null}},o=t;o&&o.parentNode&&9!=o.parentNode.nodeType;)(i=n?this.filteredStep(o,n):this.step(o))&&r.steps.unshift(i),o=o.parentNode;return null!=e&&e>=0&&(r.terminal.offset=e,"text"!=r.steps[r.steps.length-1].type&&r.steps.push({type:"text",index:0})),r}},{key:"equalStep",value:function(t,e){return!(!t||!e)&&t.index===e.index&&t.id===e.id&&t.type===e.type}},{key:"fromRange",value:function(t,e,n){var i={range:!1,base:{},path:{},start:null,end:null},r=t.startContainer,o=t.endContainer,s=t.startOffset,a=t.endOffset,u=!1;if(n&&(u=null!=r.ownerDocument.querySelector("."+n)),"string"==typeof e?(i.base=this.parseComponent(e),i.spinePos=i.base.steps[1].index):"object"===rt(e)&&(i.base=e),t.collapsed)u&&(s=this.patchOffset(r,s,n)),i.path=this.pathTo(r,s,n);else{i.range=!0,u&&(s=this.patchOffset(r,s,n)),i.start=this.pathTo(r,s,n),u&&(a=this.patchOffset(o,a,n)),i.end=this.pathTo(o,a,n),i.path={steps:[],terminal:null};var l,h=i.start.steps.length;for(l=0;l<h&&this.equalStep(i.start.steps[l],i.end.steps[l]);l++)l===h-1?i.start.terminal===i.end.terminal&&(i.path.steps.push(i.start.steps[l]),i.range=!1):i.path.steps.push(i.start.steps[l]);i.start.steps=i.start.steps.slice(i.path.steps.length),i.end.steps=i.end.steps.slice(i.path.steps.length)}return i}},{key:"fromNode",value:function(t,e,n){var i={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof e?(i.base=this.parseComponent(e),i.spinePos=i.base.steps[1].index):"object"===rt(e)&&(i.base=e),i.path=this.pathTo(t,null,n),i}},{key:"filter",value:function(t,e){var n,i,r,o,s,a=!1;return 3===t.nodeType?(a=!0,r=t.parentNode,n=t.parentNode.classList.contains(e)):(a=!1,n=t.classList.contains(e)),n&&a?(o=r.previousSibling,s=r.nextSibling,o&&3===o.nodeType?i=o:s&&3===s.nodeType&&(i=s),i||t):!(n&&!a)&&t}},{key:"patchOffset",value:function(t,e,n){if(3!=t.nodeType)throw new Error("Anchor must be a text node");var i=t,r=e;for(t.parentNode.classList.contains(n)&&(i=t.parentNode);i.previousSibling;){if(1===i.previousSibling.nodeType){if(!i.previousSibling.classList.contains(n))break;r+=i.previousSibling.textContent.length}else r+=i.previousSibling.textContent.length;i=i.previousSibling}return r}},{key:"normalizedMap",value:function(t,e,n){var i,r,o,s={},a=-1,u=t.length;for(i=0;i<u;i++)1===(r=t[i].nodeType)&&t[i].classList.contains(n)&&(r=3),i>0&&3===r&&3===o?s[i]=a:e===r&&(a+=1,s[i]=a),o=r;return s}},{key:"position",value:function(t){var e,n;return 1===t.nodeType?((e=t.parentNode.children)||(e=X(t.parentNode)),n=Array.prototype.indexOf.call(e,t)):n=(e=this.textNodes(t.parentNode)).indexOf(t),n}},{key:"filteredPosition",value:function(t,e){var n,i;return 1===t.nodeType?(n=t.parentNode.children,i=this.normalizedMap(n,1,e)):(n=t.parentNode.childNodes,t.parentNode.classList.contains(e)&&(n=(t=t.parentNode).parentNode.childNodes),i=this.normalizedMap(n,3,e)),i[Array.prototype.indexOf.call(n,t)]}},{key:"stepsToXpath",value:function(t){var e=[".","*"];return t.forEach((function(t){var n=t.index+1;t.id?e.push("*[position()="+n+" and @id='"+t.id+"']"):"text"===t.type?e.push("text()["+n+"]"):e.push("*["+n+"]")})),e.join("/")}},{key:"stepsToQuerySelector",value:function(t){var e=["html"];return t.forEach((function(t){var n=t.index+1;t.id?e.push("#"+t.id):"text"===t.type||e.push("*:nth-child("+n+")")})),e.join(">")}},{key:"textNodes",value:function(t,e){return Array.prototype.slice.call(t.childNodes).filter((function(t){return 3===t.nodeType||!(!e||!t.classList.contains(e))}))}},{key:"walkToNode",value:function(t,e,n){var i,r,o=e||document,s=o.documentElement,a=t.length;for(r=0;r<a&&("element"===(i=t[r]).type?s=i.id?o.getElementById(i.id):(s.children||X(s))[i.index]:"text"===i.type&&(s=this.textNodes(s,n)[i.index]),s);r++);return s}},{key:"findNode",value:function(t,e,n){var i,r,o=e||document;return n||void 0===o.evaluate?i=n?this.walkToNode(t,o,n):this.walkToNode(t,o):(r=this.stepsToXpath(t),i=o.evaluate(r,o,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),i}},{key:"fixMiss",value:function(t,e,n,i){var r,o,s=this.findNode(t.slice(0,-1),n,i),a=s.childNodes,u=this.normalizedMap(a,3,i),l=t[t.length-1].index;for(var h in u){if(!u.hasOwnProperty(h))return;if(u[h]===l){if(!(e>(o=(r=a[h]).textContent.length))){s=1===r.nodeType?r.childNodes[0]:r;break}e-=o}}return{container:s,offset:e}}},{key:"toRange",value:function(t,e){var n,i,r,o,s,a,u,l,h=t||document,c=this,f=!!e&&null!=h.querySelector("."+e);if(n=void 0!==h.createRange?h.createRange():new G,c.range?(i=c.start,a=c.path.steps.concat(i.steps),o=this.findNode(a,h,f?e:null),r=c.end,u=c.path.steps.concat(r.steps),s=this.findNode(u,h,f?e:null)):(i=c.path,a=c.path.steps,o=this.findNode(c.path.steps,h,f?e:null)),!o)return console.log("No startContainer found for",this.toString()),null;try{null!=i.terminal.offset?n.setStart(o,i.terminal.offset):n.setStart(o,0)}catch(t){l=this.fixMiss(a,i.terminal.offset,h,f?e:null),n.setStart(l.container,l.offset)}if(s)try{null!=r.terminal.offset?n.setEnd(s,r.terminal.offset):n.setEnd(s,0)}catch(t){l=this.fixMiss(u,c.end.terminal.offset,h,f?e:null),n.setEnd(l.container,l.offset)}return n}},{key:"isCfiString",value:function(t){return"string"==typeof t&&0===t.indexOf("epubcfi(")&&")"===t[t.length-1]}},{key:"generateChapterComponent",value:function(t,e,n){var i="/"+2*(t+1)+"/";return i+=2*(parseInt(e)+1),n&&(i+="["+n+"]"),i}},{key:"collapse",value:function(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}],n&&ot(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),at=st;function ut(t){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut(t)}function lt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==ut(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==ut(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===ut(r)?r:String(r)),i)}var r}var ht=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e||this,this.hooks=[]}var e,n;return e=t,n=[{key:"register",value:function(){for(var t=0;t<arguments.length;++t)if("function"==typeof arguments[t])this.hooks.push(arguments[t]);else for(var e=0;e<arguments[t].length;++e)this.hooks.push(arguments[t][e])}},{key:"deregister",value:function(t){for(var e=0;e<this.hooks.length;e++)if(this.hooks[e]===t){this.hooks.splice(e,1);break}}},{key:"trigger",value:function(){var t=arguments,e=this.context,n=[];return this.hooks.forEach((function(i){try{var r=i.apply(e,t)}catch(t){console.log(t)}r&&"function"==typeof r.then&&n.push(r)})),Promise.all(n)}},{key:"list",value:function(){return this.hooks}},{key:"clear",value:function(){return this.hooks=[]}}],n&&lt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ct=ht;function ft(t,e){var n,i,r=e.url,o=r.indexOf("://")>-1;t&&(i=j(t,"head"),(n=j(i,"base"))||(n=t.createElement("base"),i.insertBefore(n,i.firstChild)),!o&&window&&window.location&&(r=window.location.origin+r),n.setAttribute("href",r))}function dt(t,e){var n,i,r=e.canonical;t&&(n=j(t,"head"),(i=j(n,"link[rel='canonical']"))?i.setAttribute("href",r):((i=t.createElement("link")).setAttribute("rel","canonical"),i.setAttribute("href",r),n.appendChild(i)))}function pt(t,e){var n,i,r=e.idref;t&&(n=j(t,"head"),(i=j(n,"link[property='dc.identifier']"))?i.setAttribute("content",r):((i=t.createElement("meta")).setAttribute("name","dc.identifier"),i.setAttribute("content",r),n.appendChild(i)))}function vt(t,e,n){return e.forEach((function(e,i){e&&n[i]&&(e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),t=t.replace(new RegExp(e,"g"),n[i]))})),t}n(52327),n(73902),n(82759);var mt=function(t,e,n,i){var r,o="undefined"!=typeof window&&window.URL,s=o?"blob":"arraybuffer",a=new q,u=new XMLHttpRequest,l=XMLHttpRequest.prototype;for(r in"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),n&&(u.withCredentials=!0),u.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var t=!1;if(""!==this.responseType&&"document"!==this.responseType||(t=this.responseXML),200===this.status||0===this.status||t){var n;if(!this.response&&!t)return a.reject({status:this.status,message:"Empty Response",stack:(new Error).stack}),a.promise;if(403===this.status)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack}),a.promise;n=t?this.responseXML:O(e)?L(this.response,"text/xml"):"xhtml"==e?L(this.response,"application/xhtml+xml"):"html"==e||"htm"==e?L(this.response,"text/html"):"json"==e?JSON.parse(this.response):"blob"==e?o?this.response:new Blob([this.response]):this.response,a.resolve(n)}else a.reject({status:this.status,message:this.response,stack:(new Error).stack})}},u.onerror=function(t){a.reject(t)},u.open("GET",t,!0),i)u.setRequestHeader(r,i[r]);return"json"==e&&u.setRequestHeader("Accept","application/json"),e||(e=new tt(t).extension),"blob"==e&&(u.responseType=s),O(e)&&u.overrideMimeType("text/xml"),"binary"==e&&(u.responseType="arraybuffer"),u.send(),a.promise};function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function yt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==gt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==gt(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===gt(r)?r:String(r)),i)}var r}var bt=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.idref=e.idref,this.linear="yes"===e.linear,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,n?this.hooks=n:(this.hooks={},this.hooks.serialize=new ct(this),this.hooks.content=new ct(this)),this.document=void 0,this.contents=void 0,this.output=void 0}var e,n;return e=t,n=[{key:"load",value:function(t){var e=t||this.request||mt,n=new q,i=n.promise;return this.contents?n.resolve(this.contents):e(this.url).then(function(t){return this.document=t,this.contents=t.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){n.resolve(this.contents)}.bind(this)).catch((function(t){n.reject(t)})),i}},{key:"base",value:function(){return ft(this.document,this)}},{key:"render",value:function(t){var e=new q,n=e.promise;return this.output,this.load(t).then(function(t){var e=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0,n=new("undefined"==typeof XMLSerializer||e?s.DOMParser:XMLSerializer);return this.output=n.serializeToString(t),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){e.resolve(this.output)}.bind(this)).catch((function(t){e.reject(t)})),n}},{key:"find",value:function(t){var e=this,n=[],i=t.toLowerCase();return F(e.document,(function(t){!function(t){for(var r,o,s,a=t.textContent.toLowerCase(),u=e.document.createRange(),l=-1;-1!=o;)-1!=(o=a.indexOf(i,l+1))&&((u=e.document.createRange()).setStart(t,o),u.setEnd(t,o+i.length),r=e.cfiFromRange(u),s=t.textContent.length<150?t.textContent:"..."+(s=t.textContent.substring(o-75,o+75))+"...",n.push({cfi:r,excerpt:s})),l=o}(t)})),n}},{key:"search",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(void 0===document.createTreeWalker)return this.find(t);for(var n,i=[],r=150,o=this,s=t.toLowerCase(),a=function(t){var e=t.reduce((function(t,e){return t+e.textContent}),"").toLowerCase().indexOf(s);if(-1!=e){var n=e+s.length,a=0,u=0;if(e<t[0].length){for(var l;a<t.length-1&&!(n<=(u+=t[a].length));)a+=1;var h=t[0],c=t[a],f=o.document.createRange();f.setStart(h,e);var d=t.slice(0,a).reduce((function(t,e){return t+e.textContent.length}),0);f.setEnd(c,d>n?n:n-d),l=o.cfiFromRange(f);var p=t.slice(0,a+1).reduce((function(t,e){return t+e.textContent}),"");p.length>r&&(p="..."+(p=p.substring(e-r/2,e+r/2))+"..."),i.push({cfi:l,excerpt:p})}}},u=document.createTreeWalker(o.document,NodeFilter.SHOW_TEXT,null,!1),l=[];n=u.nextNode();)l.push(n),l.length==e&&(a(l.slice(0,e)),l=l.slice(1,e));return l.length>0&&a(l),i}},{key:"reconcileLayoutSettings",value:function(t){var e={layout:t.layout,spread:t.spread,orientation:t.orientation};return this.properties.forEach((function(t){var n,i,r=t.replace("rendition:",""),o=r.indexOf("-");-1!=o&&(n=r.slice(0,o),i=r.slice(o+1),e[n]=i)})),e}},{key:"cfiFromRange",value:function(t){return new at(t,this.cfiBase).toString()}},{key:"cfiFromElement",value:function(t){return new at(t,this.cfiBase).toString()}},{key:"unload",value:function(){this.document=void 0,this.contents=void 0,this.output=void 0}},{key:"destroy",value:function(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}],n&&yt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),wt=bt;function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function kt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==_t(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==_t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===_t(r)?r:String(r)),i)}var r}var xt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new ct,this.hooks.content=new ct,this.hooks.content.register(ft),this.hooks.content.register(dt),this.hooks.content.register(pt),this.epubcfi=new at,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}var e,n;return e=t,n=[{key:"unpack",value:function(t,e,n){var i=this;this.items=t.spine,this.manifest=t.manifest,this.spineNodeIndex=t.spineNodeIndex,this.baseUrl=t.baseUrl||t.basePath||"",this.length=this.items.length,this.items.forEach((function(t,r){var o,s=i.manifest[t.idref];t.index=r,t.cfiBase=i.epubcfi.generateChapterComponent(i.spineNodeIndex,t.index,t.id),t.href&&(t.url=e(t.href,!0),t.canonical=n(t.href)),s&&(t.href=s.href,t.url=e(t.href,!0),t.canonical=n(t.href),s.properties.length&&t.properties.push.apply(t.properties,s.properties)),"yes"===t.linear?(t.prev=function(){for(var e=t.index;e>0;){var n=this.get(e-1);if(n&&n.linear)return n;e-=1}}.bind(i),t.next=function(){for(var e=t.index;e<this.spineItems.length-1;){var n=this.get(e+1);if(n&&n.linear)return n;e+=1}}.bind(i)):(t.prev=function(){},t.next=function(){}),o=new wt(t,i.hooks),i.append(o)})),this.loaded=!0}},{key:"get",value:function(t){var e=0;if(void 0===t)for(;e<this.spineItems.length;){var n=this.spineItems[e];if(n&&n.linear)break;e+=1}else this.epubcfi.isCfiString(t)?e=new at(t).spinePos:"number"==typeof t||!1===isNaN(t)?e=t:"string"==typeof t&&0===t.indexOf("#")?e=this.spineById[t.substring(1)]:"string"==typeof t&&(t=t.split("#")[0],e=this.spineByHref[t]||this.spineByHref[encodeURI(t)]);return this.spineItems[e]||null}},{key:"append",value:function(t){var e=this.spineItems.length;return t.index=e,this.spineItems.push(t),this.spineByHref[decodeURI(t.href)]=e,this.spineByHref[encodeURI(t.href)]=e,this.spineByHref[t.href]=e,this.spineById[t.idref]=e,e}},{key:"prepend",value:function(t){return this.spineByHref[t.href]=0,this.spineById[t.idref]=0,this.spineItems.forEach((function(t,e){t.index=e})),0}},{key:"remove",value:function(t){var e=this.spineItems.indexOf(t);if(e>-1)return delete this.spineByHref[t.href],delete this.spineById[t.idref],this.spineItems.splice(e,1)}},{key:"each",value:function(){return this.spineItems.forEach.apply(this.spineItems,arguments)}},{key:"first",value:function(){var t=0;do{var e=this.get(t);if(e&&e.linear)return e;t+=1}while(t<this.spineItems.length)}},{key:"last",value:function(){var t=this.spineItems.length-1;do{var e=this.get(t);if(e&&e.linear)return e;t-=1}while(t>=0)}},{key:"destroy",value:function(){this.each((function(t){return t.destroy()})),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}],n&&kt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),St=xt;function Et(t){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Et(t)}function Ct(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Et(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Et(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Et(r)?r:String(r)),i)}var r}n(20266);var Tt=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this._q=[],this.context=e,this.tick=l,this.running=!1,this.paused=!1}return e=t,n=[{key:"enqueue",value:function(){var t,e,n=[].shift.call(arguments),i=arguments;if(!n)throw new Error("No Task Provided");return e="function"==typeof n?{task:n,args:i,deferred:t=new q,promise:t.promise}:{promise:n},this._q.push(e),0!=this.paused||this.running||this.run(),e.promise}},{key:"dequeue",value:function(){var t,e,n;return!this._q.length||this.paused?((t=new q).deferred.resolve(),t.promise):(e=(t=this._q.shift()).task)?(n=e.apply(this.context,t.args))&&"function"==typeof n.then?n.then(function(){t.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){t.deferred.reject.apply(this.context,arguments)}.bind(this)):(t.deferred.resolve.apply(this.context,n),t.promise):t.promise?t.promise:void 0}},{key:"dump",value:function(){for(;this._q.length;)this.dequeue()}},{key:"run",value:function(){var t=this;return this.running||(this.running=!0,this.defered=new q),this.tick.call(window,(function(){t._q.length?t.dequeue().then(function(){this.run()}.bind(t)):(t.defered.resolve(),t.running=void 0)})),1==this.paused&&(this.paused=!1),this.defered.promise}},{key:"flush",value:function(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running):void 0}},{key:"clear",value:function(){this._q=[]}},{key:"length",value:function(){return this._q.length}},{key:"pause",value:function(){this.paused=!0}},{key:"stop",value:function(){this._q=[],this.running=!1,this.paused=!0}}],n&&Ct(e.prototype,n),i&&Ct(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t;var e,n,i}(),Nt=Tt,Ot="0.3",At=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],It="openFailed",zt="expand",Rt="resize",Pt="selected",Lt="selectedRange",jt="linkClicked",Bt="changed",Dt="resize",Ft="resized",Mt="orientationchange",Ut="added",Wt="scroll",qt="scrolled",Ht="removed",Xt="axis",Zt="writingMode",Vt="loaderror",Yt="rendered",Gt="resized",Kt="displayed",$t="shown",Jt="hidden",Qt="markClicked",te="started",ee="attached",ne="displayed",ie="displayerror",re="rendered",oe="removed",se="resized",ae="orientationchange",ue="locationChanged",le="relocated",he="markClicked",ce="selected",fe="layout",de="updated",pe="attach",ve="detach";function me(t){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},me(t)}function ge(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==me(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==me(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===me(r)?r:String(r)),i)}var r}var ye=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.spine=e,this.request=n,this.pause=i||100,this.q=new Nt(this),this.epubcfi=new at,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}var e,n;return e=t,n=[{key:"generate",value:function(t){return t&&(this.break=t),this.q.pause(),this.spine.each(function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}},{key:"createRange",value:function(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}},{key:"process",value:function(t){return t.load(this.request).then(function(e){var n=new q,i=this.parse(e,t.cfiBase);return this._locations=this._locations.concat(i),t.unload(),this.processingTimeout=setTimeout((function(){return n.resolve(i)}),this.pause),n.promise}.bind(this))}},{key:"parse",value:function(t,e,n){var i,r,o=[],s=j(t.ownerDocument,"body"),a=0,u=n||this.break;if(F(s,function(t){var n,s=t.length,l=0;if(0===t.textContent.trim().length)return!1;for(0==a&&((i=this.createRange()).startContainer=t,i.startOffset=0),(n=u-a)>s&&(a+=s,l=s);l<s;)if(n=u-a,0===a&&(l+=1,(i=this.createRange()).startContainer=t,i.startOffset=l),l+n>=s)a+=s-l,l=s;else{l+=n,i.endContainer=t,i.endOffset=l;var h=new at(i,e).toString();o.push(h),a=0}r=t}.bind(this)),i&&i.startContainer&&r){i.endContainer=r,i.endOffset=r.length;var l=new at(i,e).toString();o.push(l),a=0}return o}},{key:"generateFromWords",value:function(t,e,n){var i=t?new at(t):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(t){t.linear&&(i?t.index>=i.spinePos&&this.q.enqueue(this.processWords.bind(this),t,e,i,n):this.q.enqueue(this.processWords.bind(this),t,e,i,n))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}},{key:"processWords",value:function(t,e,n,i){return i&&this._locationsWords.length>=i?Promise.resolve():t.load(this.request).then(function(r){var o=new q,s=this.parseWords(r,t,e,n),a=i-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(s.length>=i?s.slice(0,a):s),t.unload(),this.processingTimeout=setTimeout((function(){return o.resolve(s)}),this.pause),o.promise}.bind(this))}},{key:"countWords",value:function(t){return(t=(t=(t=t.replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\n /,"\n")).split(" ").length}},{key:"parseWords",value:function(t,e,n,i){var r,o=e.cfiBase,s=[],a=j(t.ownerDocument,"body"),u=n,l=!i||i.spinePos!==e.index;return i&&e.index===i.spinePos&&(r=i.findNode(i.range?i.path.steps.concat(i.start.steps):i.path.steps,t.ownerDocument)),F(a,function(t){if(!l){if(t!==r)return!1;l=!0}if(t.textContent.length<10&&0===t.textContent.trim().length)return!1;var e,n=this.countWords(t.textContent),i=0;if(0===n)return!1;for((e=u-this._wordCounter)>n&&(this._wordCounter+=n,i=n);i<n;)if(i+(e=u-this._wordCounter)>=n)this._wordCounter+=n-i,i=n;else{i+=e;var a=new at(t,o);s.push({cfi:a.toString(),wordCount:this._wordCounter}),this._wordCounter=0}}.bind(this)),s}},{key:"locationFromCfi",value:function(t){var e;return at.prototype.isCfiString(t)&&(t=new at(t)),0===this._locations.length?-1:(e=w(t,this._locations,this.epubcfi.compare))>this.total?this.total:e}},{key:"percentageFromCfi",value:function(t){if(0===this._locations.length)return null;var e=this.locationFromCfi(t);return this.percentageFromLocation(e)}},{key:"percentageFromLocation",value:function(t){return t&&this.total?t/this.total:0}},{key:"cfiFromLocation",value:function(t){var e=-1;return"number"!=typeof t&&(t=parseInt(t)),t>=0&&t<this._locations.length&&(e=this._locations[t]),e}},{key:"cfiFromPercentage",value:function(t){var e;if(t>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),t>=1){var n=new at(this._locations[this.total]);return n.collapse(),n.toString()}return e=Math.ceil(this.total*t),this.cfiFromLocation(e)}},{key:"load",value:function(t){return this._locations="string"==typeof t?JSON.parse(t):t,this.total=this._locations.length-1,this._locations}},{key:"save",value:function(){return JSON.stringify(this._locations)}},{key:"getCurrent",value:function(){return this._current}},{key:"setCurrent",value:function(t){var e;if("string"==typeof t)this._currentCfi=t;else{if("number"!=typeof t)return;this._current=t}0!==this._locations.length&&("string"==typeof t?(e=this.locationFromCfi(t),this._current=e):e=t,this.emit(Bt,{percentage:this.percentageFromLocation(e)}))}},{key:"currentLocation",get:function(){return this._current},set:function(t){this.setCurrent(t)}},{key:"length",value:function(){return this._locations.length}},{key:"destroy",value:function(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}],n&&ge(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(ye.prototype);var be=ye;function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function _e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==we(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==we(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===we(r)?r:String(r)),i)}var r}var ke=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}var e,n;return e=t,(n=[{key:"parse",value:function(t){var e;if(!t)throw new Error("Container File Not Found");if(!(e=j(t,"rootfile")))throw new Error("No RootFile Found");this.packagePath=e.getAttribute("full-path"),this.directory=$().dirname(this.packagePath),this.encoding=t.xmlEncoding}},{key:"destroy",value:function(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}])&&_e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Se(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==xe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==xe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===xe(r)?r:String(r)),i)}var r}var Ee=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}var e,n;return e=t,n=[{key:"parse",value:function(t){var e,n,i;if(!t)throw new Error("Package File Not Found");if(!(e=j(t,"metadata")))throw new Error("No Metadata Found");if(!(n=j(t,"manifest")))throw new Error("No Manifest Found");if(!(i=j(t,"spine")))throw new Error("No Spine Found");return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,i),this.coverPath=this.findCoverPath(t),this.spineNodeIndex=N(i),this.spine=this.parseSpine(i,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(t),this.metadata=this.parseMetadata(e),this.metadata.direction=i.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}},{key:"parseMetadata",value:function(t){var e={};return e.title=this.getElementText(t,"title"),e.creator=this.getElementText(t,"creator"),e.description=this.getElementText(t,"description"),e.pubdate=this.getElementText(t,"date"),e.publisher=this.getElementText(t,"publisher"),e.identifier=this.getElementText(t,"identifier"),e.language=this.getElementText(t,"language"),e.rights=this.getElementText(t,"rights"),e.modified_date=this.getPropertyText(t,"dcterms:modified"),e.layout=this.getPropertyText(t,"rendition:layout"),e.orientation=this.getPropertyText(t,"rendition:orientation"),e.flow=this.getPropertyText(t,"rendition:flow"),e.viewport=this.getPropertyText(t,"rendition:viewport"),e.media_active_class=this.getPropertyText(t,"media:active-class"),e.spread=this.getPropertyText(t,"rendition:spread"),e}},{key:"parseManifest",value:function(t){var e={},n=B(t,"item");return Array.prototype.slice.call(n).forEach((function(t){var n=t.getAttribute("id"),i=t.getAttribute("href")||"",r=t.getAttribute("media-type")||"",o=t.getAttribute("media-overlay")||"",s=t.getAttribute("properties")||"";e[n]={href:i,type:r,overlay:o,properties:s.length?s.split(" "):[]}})),e}},{key:"parseSpine",value:function(t,e){var n=[],i=B(t,"itemref");return Array.prototype.slice.call(i).forEach((function(t,e){var i=t.getAttribute("idref"),r=t.getAttribute("properties")||"",o=r.length?r.split(" "):[],s={id:t.getAttribute("id"),idref:i,linear:t.getAttribute("linear")||"yes",properties:o,index:e};n.push(s)})),n}},{key:"findUniqueIdentifier",value:function(t){var e=t.documentElement.getAttribute("unique-identifier");if(!e)return"";var n=t.getElementById(e);return n&&"identifier"===n.localName&&"http://purl.org/dc/elements/1.1/"===n.namespaceURI&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():""}},{key:"findNavPath",value:function(t){var e=D(t,"item",{properties:"nav"});return!!e&&e.getAttribute("href")}},{key:"findNcxPath",value:function(t,e){var n,i=D(t,"item",{"media-type":"application/x-dtbncx+xml"});return i||(n=e.getAttribute("toc"))&&(i=t.querySelector("#".concat(n))),!!i&&i.getAttribute("href")}},{key:"findCoverPath",value:function(t){j(t,"package").getAttribute("version");var e=D(t,"item",{properties:"cover-image"});if(e)return e.getAttribute("href");var n=D(t,"meta",{name:"cover"});if(n){var i=n.getAttribute("content"),r=t.getElementById(i);return r?r.getAttribute("href"):""}return!1}},{key:"getElementText",value:function(t,e){var n,i=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",e);return i&&0!==i.length&&(n=i[0]).childNodes.length?n.childNodes[0].nodeValue:""}},{key:"getPropertyText",value:function(t,e){var n=D(t,"meta",{property:e});return n&&n.childNodes.length?n.childNodes[0].nodeValue:""}},{key:"load",value:function(t){var e=this;this.metadata=t.metadata;var n=t.readingOrder||t.spine;return this.spine=n.map((function(t,e){return t.index=e,t.linear=t.linear||"yes",t})),t.resources.forEach((function(t,n){e.manifest[n]=t,t.rel&&"cover"===t.rel[0]&&(e.coverPath=t.href)})),this.spineNodeIndex=0,this.toc=t.toc.map((function(t,e){return t.label=t.title,t})),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}},{key:"destroy",value:function(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}],n&&Se(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ce=Ee;function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function Ne(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Te(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Te(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Te(r)?r:String(r)),i)}var r}var Oe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}var e,n;return e=t,n=[{key:"parse",value:function(t){var e,n,i=t.nodeType;i&&(e=j(t,"html"),n=j(t,"ncx")),i?e?(this.toc=this.parseNav(t),this.landmarks=this.parseLandmarks(t)):n&&(this.toc=this.parseNcx(t)):this.toc=this.load(t),this.length=0,this.unpack(this.toc)}},{key:"unpack",value:function(t){for(var e,n=0;n<t.length;n++)(e=t[n]).href&&(this.tocByHref[e.href]=n),e.id&&(this.tocById[e.id]=n),this.length++,e.subitems.length&&this.unpack(e.subitems)}},{key:"get",value:function(t){var e;return t?(0===t.indexOf("#")?e=this.tocById[t.substring(1)]:t in this.tocByHref&&(e=this.tocByHref[t]),this.getByIndex(t,e,this.toc)):this.toc}},{key:"getByIndex",value:function(t,e,n){if(0!==n.length){var i=n[e];if(!i||t!==i.id&&t!==i.href){for(var r,o=0;o<n.length&&!(r=this.getByIndex(t,e,n[o].subitems));++o);return r}return i}}},{key:"landmark",value:function(t){var e;return t?(e=this.landmarksByType[t],this.landmarks[e]):this.landmarks}},{key:"parseNav",value:function(t){var e=H(t,"nav","toc"),n=[];if(!e)return n;var i=V(e,"ol",!0);return i?n=this.parseNavList(i):n}},{key:"parseNavList",value:function(t,e){var n=[];if(!t)return n;if(!t.children)return n;for(var i=0;i<t.children.length;i++){var r=this.navItem(t.children[i],e);r&&n.push(r)}return n}},{key:"navItem",value:function(t,e){var n=t.getAttribute("id")||void 0,i=V(t,"a",!0)||V(t,"span",!0);if(i){var r=i.getAttribute("href")||"";n||(n=r);var o=i.textContent||"",s=[],a=V(t,"ol",!0);return a&&(s=this.parseNavList(a,n)),{id:n,href:r,label:o,subitems:s,parent:e}}}},{key:"parseLandmarks",value:function(t){var e,n,i=H(t,"nav","landmarks"),r=i?B(i,"li"):[],o=r.length,s=[];if(!r||0===o)return s;for(e=0;e<o;++e)(n=this.landmarkItem(r[e]))&&(s.push(n),this.landmarksByType[n.type]=e);return s}},{key:"landmarkItem",value:function(t){var e=V(t,"a",!0);if(e){var n=e.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:e.getAttribute("href")||"",label:e.textContent||"",type:n}}}},{key:"parseNcx",value:function(t){var e,n,i=B(t,"navPoint"),r=i.length,o={},s=[];if(!i||0===r)return s;for(e=0;e<r;++e)o[(n=this.ncxItem(i[e])).id]=n,n.parent?o[n.parent].subitems.push(n):s.push(n);return s}},{key:"ncxItem",value:function(t){var e,n=t.getAttribute("id")||!1,i=j(t,"content").getAttribute("src"),r=j(t,"navLabel"),o=r.textContent?r.textContent:"",s=t.parentNode;return!s||"navPoint"!==s.nodeName&&"navPoint"!==s.nodeName.split(":").slice(-1)[0]||(e=s.getAttribute("id")),{id:n,href:i,label:o,subitems:[],parent:e}}},{key:"load",value:function(t){var e=this;return t.map((function(t){return t.label=t.title,t.subitems=t.children?e.load(t.children):[],t}))}},{key:"forEach",value:function(t){return this.toc.forEach(t)}}],n&&Ne(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ae=Oe,Ie=(n(92571),{application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}}),ze=function(){var t,e,n,i,r={};for(t in Ie)if(Ie.hasOwnProperty(t))for(e in Ie[t])if(Ie[t].hasOwnProperty(e))if("string"==typeof(n=Ie[t][e]))r[n]=t+"/"+e;else for(i=0;i<n.length;i++)r[n[i]]=t+"/"+e;return r}(),Re=function(t){return t&&ze[t.split(".").pop().toLowerCase()]||"text/plain"};function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Le(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Pe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Pe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Pe(r)?r:String(r)),i)}var r}var je=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings={replacements:n&&n.replacements||"base64",archive:n&&n.archive,resolver:n&&n.resolver,request:n&&n.request},this.process(e)}var e,n;return e=t,n=[{key:"process",value:function(t){this.manifest=t,this.resources=Object.keys(t).map((function(e){return t[e]})),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}},{key:"split",value:function(){this.html=this.resources.filter((function(t){if("application/xhtml+xml"===t.type||"text/html"===t.type)return!0})),this.assets=this.resources.filter((function(t){if("application/xhtml+xml"!==t.type&&"text/html"!==t.type)return!0})),this.css=this.resources.filter((function(t){if("text/css"===t.type)return!0}))}},{key:"splitUrls",value:function(){this.urls=this.assets.map(function(t){return t.href}.bind(this)),this.cssUrls=this.css.map((function(t){return t.href}))}},{key:"createUrl",value:function(t){var e=new it(t),n=Re(e.filename);return this.settings.archive?this.settings.archive.createUrl(t,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(t,"blob").then((function(t){return W(t)})).then((function(t){return R(t,n)})):this.settings.request(t,"blob").then((function(t){return I(t,n)}))}},{key:"replacements",value:function(){var t=this;if("none"===this.settings.replacements)return new Promise(function(t){t(this.urls)}.bind(this));var e=this.urls.map((function(e){var n=t.settings.resolver(e);return t.createUrl(n).catch((function(t){return console.error(t),null}))}));return Promise.all(e).then((function(e){return t.replacementUrls=e.filter((function(t){return"string"==typeof t})),e}))}},{key:"replaceCss",value:function(t,e){var n=[];return t=t||this.settings.archive,e=e||this.settings.resolver,this.cssUrls.forEach(function(i){var r=this.createCssFile(i,t,e).then(function(t){var e=this.urls.indexOf(i);e>-1&&(this.replacementUrls[e]=t)}.bind(this));n.push(r)}.bind(this)),Promise.all(n)}},{key:"createCssFile",value:function(t){var e=this;if($().isAbsolute(t))return new Promise((function(t){t()}));var n,i=this.settings.resolver(t);n=this.settings.archive?this.settings.archive.getText(i):this.settings.request(i,"text");var r=this.urls.map((function(t){var n=e.settings.resolver(t);return new tt(i).relative(n)}));return n?n.then((function(t){return t=vt(t,r,e.replacementUrls),"base64"===e.settings.replacements?R(t,"text/css"):I(t,"text/css")}),(function(t){return new Promise((function(t){t()}))})):new Promise((function(t){t()}))}},{key:"relativeTo",value:function(t,e){return e=e||this.settings.resolver,this.urls.map(function(n){var i=e(n);return new tt(t).relative(i)}.bind(this))}},{key:"get",value:function(t){var e=this.urls.indexOf(t);if(-1!==e)return this.replacementUrls.length?new Promise(function(t,n){t(this.replacementUrls[e])}.bind(this)):this.createUrl(t)}},{key:"substitute",value:function(t,e){return vt(t,e?this.relativeTo(e):this.urls,this.replacementUrls)}},{key:"destroy",value:function(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}],n&&Le(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Be=je;function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Fe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==De(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==De(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===De(r)?r:String(r)),i)}var r}var Me=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pages=[],this.locations=[],this.epubcfi=new at,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}var e,n;return e=t,(n=[{key:"parse",value:function(t){var e=j(t,"html"),n=j(t,"ncx");return e?this.parseNav(t):n?this.parseNcx(t):void 0}},{key:"parseNav",value:function(t){var e,n,i=H(t,"nav","page-list"),r=i?B(i,"li"):[],o=r.length,s=[];if(!r||0===o)return s;for(e=0;e<o;++e)n=this.item(r[e]),s.push(n);return s}},{key:"parseNcx",value:function(t){var e,n,i,r,o=[],s=0;if(!(n=j(t,"pageList")))return o;if(r=(i=B(n,"pageTarget")).length,!i||0===i.length)return o;for(s=0;s<r;++s)e=this.ncxItem(i[s]),o.push(e);return o}},{key:"ncxItem",value:function(t){var e=j(t,"navLabel"),n=j(e,"text").textContent;return{href:j(t,"content").getAttribute("src"),page:parseInt(n,10)}}},{key:"item",value:function(t){var e,n,i=j(t,"a"),r=i.getAttribute("href")||"",o=i.textContent||"",s=parseInt(o);return-1!=r.indexOf("epubcfi")?(n=(e=r.split("#"))[0],{cfi:e.length>1&&e[1],href:r,packageUrl:n,page:s}):{href:r,page:s}}},{key:"process",value:function(t){t.forEach((function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)}),this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}},{key:"pageFromCfi",value:function(t){var e=-1;if(0===this.locations.length)return-1;var n=_(t,this.locations,this.epubcfi.compare);return-1!=n?e=this.pages[n]:void 0!==(e=(n=w(t,this.locations,this.epubcfi.compare))-1>=0?this.pages[n-1]:this.pages[0])||(e=-1),e}},{key:"cfiFromPage",value:function(t){var e=-1;"number"!=typeof t&&(t=parseInt(t));var n=this.pages.indexOf(t);return-1!=n&&(e=this.locations[n]),e}},{key:"pageFromPercentage",value:function(t){return Math.round(this.totalPages*t)}},{key:"percentageFromPage",value:function(t){var e=(t-this.firstPage)/this.totalPages;return Math.round(1e3*e)/1e3}},{key:"percentageFromCfi",value:function(t){var e=this.pageFromCfi(t);return this.percentageFromPage(e)}},{key:"destroy",value:function(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}])&&Fe(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ue(t){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(t)}function We(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Ue(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Ue(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Ue(r)?r:String(r)),i)}var r}var qe=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e,this.name=e.layout||"reflowable",this._spread="none"!==e.spread,this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,"scrolled"===e.flow||"scrolled-continuous"===e.flow||"scrolled-doc"===e.flow?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}var e,n;return e=t,n=[{key:"flow",value:function(t){return void 0!==t&&(this._flow="scrolled"===t||"scrolled-continuous"===t||"scrolled-doc"===t?"scrolled":"paginated",this.update({flow:this._flow})),this._flow}},{key:"spread",value:function(t,e){return t&&(this._spread="none"!==t,this.update({spread:this._spread})),e>=0&&(this._minSpreadWidth=e),this._spread}},{key:"calculate",value:function(t,e,n){var i,r,o,s,a,u=n||0,l=t,h=e,c=Math.floor(l/12);a=this._spread&&l>=this._minSpreadWidth?2:1,"reflowable"!==this.name||"paginated"!==this._flow||n>=0||(u=c%2==0?c:c-1),"pre-paginated"===this.name&&(u=0),a>1?o=(i=l/a-u)+u:(i=l,o=l),"pre-paginated"===this.name&&a>1&&(l=i),r=i*a+u,s=l,this.width=l,this.height=h,this.spreadWidth=r,this.pageWidth=o,this.delta=s,this.columnWidth=i,this.gap=u,this.divisor=a,this.update({width:l,height:h,spreadWidth:r,pageWidth:o,delta:s,columnWidth:i,gap:u,divisor:a})}},{key:"format",value:function(t,e,n){return"pre-paginated"===this.name?t.fit(this.columnWidth,this.height,e):"paginated"===this._flow?t.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):n&&"horizontal"===n?t.size(null,this.height):t.size(this.width,null)}},{key:"count",value:function(t,e){var n,i;return"pre-paginated"===this.name?(n=1,i=1):"paginated"===this._flow?(e=e||this.delta,i=(n=Math.ceil(t/e))*this.divisor):(e=e||this.height,i=n=Math.ceil(t/e)),{spreads:n,pages:i}}},{key:"update",value:function(t){var e=this;if(Object.keys(t).forEach((function(n){e.props[n]===t[n]&&delete t[n]})),Object.keys(t).length>0){var n=y(this.props,t);this.emit(de,n,t)}}}],n&&We(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(qe.prototype);var He=qe;function Xe(t){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xe(t)}function Ze(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Xe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Xe(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Xe(r)?r:String(r)),i)}var r}var Ve=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}var e,n;return e=t,n=[{key:"register",value:function(){if(0!==arguments.length)return 1===arguments.length&&"object"===Xe(arguments[0])?this.registerThemes(arguments[0]):1===arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2===arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2===arguments.length&&"object"===Xe(arguments[1])?this.registerRules(arguments[0],arguments[1]):void 0}},{key:"default",value:function(t){if(t)return"string"==typeof t?this.registerUrl("default",t):"object"===Xe(t)?this.registerRules("default",t):void 0}},{key:"registerThemes",value:function(t){for(var e in t)t.hasOwnProperty(e)&&("string"==typeof t[e]?this.registerUrl(e,t[e]):this.registerRules(e,t[e]))}},{key:"registerCss",value:function(t,e){this._themes[t]={serialized:e},(this._injected[t]||"default"==t)&&this.update(t)}},{key:"registerUrl",value:function(t,e){var n=new it(e);this._themes[t]={url:n.toString()},(this._injected[t]||"default"==t)&&this.update(t)}},{key:"registerRules",value:function(t,e){this._themes[t]={rules:e},(this._injected[t]||"default"==t)&&this.update(t)}},{key:"select",value:function(t){var e=this._current;this._current=t,this.update(t),this.rendition.getContents().forEach((function(n){n.removeClass(e),n.addClass(t)}))}},{key:"update",value:function(t){var e=this;this.rendition.getContents().forEach((function(n){e.add(t,n)}))}},{key:"inject",value:function(t){var e,n=[],i=this._themes;for(var r in i)!i.hasOwnProperty(r)||r!==this._current&&"default"!==r||(((e=i[r]).rules&&Object.keys(e.rules).length>0||e.url&&-1===n.indexOf(e.url))&&this.add(r,t),this._injected.push(r));"default"!=this._current&&t.addClass(this._current)}},{key:"add",value:function(t,e){var n=this._themes[t];n&&e&&(n.url?e.addStylesheet(n.url):n.serialized?(e.addStylesheetCss(n.serialized,t),n.injected=!0):n.rules&&(e.addStylesheetRules(n.rules,t),n.injected=!0))}},{key:"override",value:function(t,e,n){var i=this,r=this.rendition.getContents();this._overrides[t]={value:e,priority:!0===n},r.forEach((function(e){e.css(t,i._overrides[t].value,i._overrides[t].priority)}))}},{key:"removeOverride",value:function(t){var e=this.rendition.getContents();delete this._overrides[t],e.forEach((function(e){e.css(t)}))}},{key:"overrides",value:function(t){var e=this._overrides;for(var n in e)e.hasOwnProperty(n)&&t.css(n,e[n].value,e[n].priority)}},{key:"fontSize",value:function(t){this.override("font-size",t)}},{key:"font",value:function(t){this.override("font-family",t,!0)}},{key:"destroy",value:function(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}],n&&Ze(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ye=Ve;function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function Ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Ge(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Ge(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Ge(r)?r:String(r)),i)}var r}n(95623),n(61514);var Je=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Ke(this,t),this.layout=e,this.horizontal="horizontal"===i,this.direction=n||"ltr",this._dev=r}var e,n;return e=t,n=[{key:"section",value:function(t){var e=this.findRanges(t);return this.rangeListToCfiList(t.section.cfiBase,e)}},{key:"page",value:function(t,e,n,i){var r,o=!(!t||!t.document)&&t.document.body;if(o){if(r=this.rangePairToCfiPair(e,{start:this.findStart(o,n,i),end:this.findEnd(o,n,i)}),!0===this._dev){var s=t.document,a=new at(r.start).toRange(s),u=new at(r.end).toRange(s),l=s.defaultView.getSelection(),h=s.createRange();l.removeAllRanges(),h.setStart(a.startContainer,a.startOffset),h.setEnd(u.endContainer,u.endOffset),l.addRange(h)}return r}}},{key:"walk",value:function(t,e){if(!t||t.nodeType!==Node.TEXT_NODE){var n=function(t){return t.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},i=n;i.acceptNode=n;for(var r,o,s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,i,!1);(r=s.nextNode())&&!(o=e(r)););return o}}},{key:"findRanges",value:function(t){for(var e,n,i=[],r=t.contents.scrollWidth(),o=Math.ceil(r/this.layout.spreadWidth)*this.layout.divisor,s=this.layout.columnWidth,a=this.layout.gap,u=0;u<o.pages;u++)e=(s+a)*u,n=s*(u+1)+a*u,i.push({start:this.findStart(t.document.body,e,n),end:this.findEnd(t.document.body,e,n)});return i}},{key:"findStart",value:function(t,e,n){for(var i,r,o=this,s=[t],a=t;s.length;)if(i=s.shift(),r=this.walk(i,(function(t){var i,r,u,l,h;if(h=S(t),o.horizontal&&"ltr"===o.direction){if(i=o.horizontal?h.left:h.top,r=o.horizontal?h.right:h.bottom,i>=e&&i<=n)return t;if(r>e)return t;a=t,s.push(t)}else if(o.horizontal&&"rtl"===o.direction){if(i=h.left,(r=h.right)<=n&&r>=e)return t;if(i<n)return t;a=t,s.push(t)}else{if(u=h.top,l=h.bottom,u>=e&&u<=n)return t;if(l>e)return t;a=t,s.push(t)}})))return this.findTextStartRange(r,e,n);return this.findTextStartRange(a,e,n)}},{key:"findEnd",value:function(t,e,n){for(var i,r,o=this,s=[t],a=t;s.length;)if(i=s.shift(),r=this.walk(i,(function(t){var i,r,u,l,h;if(h=S(t),o.horizontal&&"ltr"===o.direction){if(i=Math.round(h.left),r=Math.round(h.right),i>n&&a)return a;if(r>n)return t;a=t,s.push(t)}else if(o.horizontal&&"rtl"===o.direction){if(i=Math.round(o.horizontal?h.left:h.top),(r=Math.round(o.horizontal?h.right:h.bottom))<e&&a)return a;if(i<e)return t;a=t,s.push(t)}else{if(u=Math.round(h.top),l=Math.round(h.bottom),u>n&&a)return a;if(l>n)return t;a=t,s.push(t)}})))return this.findTextEndRange(r,e,n);return this.findTextEndRange(a,e,n)}},{key:"findTextStartRange",value:function(t,e,n){for(var i,r,o=this.splitTextNodeIntoRanges(t),s=0;s<o.length;s++)if(r=(i=o[s]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(r.left>=e)return i}else if(this.horizontal&&"rtl"===this.direction){if(r.right<=n)return i}else if(r.top>=e)return i;return o[0]}},{key:"findTextEndRange",value:function(t,e,n){for(var i,r,o,s,a,u,l,h=this.splitTextNodeIntoRanges(t),c=0;c<h.length;c++){if(o=(r=h[c]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(s=o.left,a=o.right,s>n&&i)return i;if(a>n)return r}else if(this.horizontal&&"rtl"===this.direction){if(s=o.left,(a=o.right)<e&&i)return i;if(s<e)return r}else{if(u=o.top,l=o.bottom,u>n&&i)return i;if(l>n)return r}i=r}return h[h.length-1]}},{key:"splitTextNodeIntoRanges",value:function(t,e){var n,i=[],r=(t.textContent||"").trim(),o=t.ownerDocument,s=e||" ",a=r.indexOf(s);if(-1===a||t.nodeType!=Node.TEXT_NODE)return(n=o.createRange()).selectNodeContents(t),[n];for((n=o.createRange()).setStart(t,0),n.setEnd(t,a),i.push(n),n=!1;-1!=a;)(a=r.indexOf(s,a+1))>0&&(n&&(n.setEnd(t,a),i.push(n)),(n=o.createRange()).setStart(t,a+1));return n&&(n.setEnd(t,r.length),i.push(n)),i}},{key:"rangePairToCfiPair",value:function(t,e){var n=e.start,i=e.end;return n.collapse(!0),i.collapse(!1),{start:new at(n,t).toString(),end:new at(i,t).toString()}}},{key:"rangeListToCfiList",value:function(t,e){for(var n,i=[],r=0;r<e.length;r++)n=this.rangePairToCfiPair(t,e[r]),i.push(n);return i}},{key:"axis",value:function(t){return t&&(this.horizontal="horizontal"===t),this.horizontal}}],n&&$e(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Qe=Je;function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==tn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==tn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===tn(r)?r:String(r)),i)}var r}var nn="undefined"!=typeof navigator,rn=nn&&/Chrome/.test(navigator.userAgent),on=nn&&!rn&&/AppleWebKit/.test(navigator.userAgent),sn=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.epubcfi=new at,this.document=e,this.documentElement=this.document.documentElement,this.content=n||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=r||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",Ot),this.called=0,this.active=!0,this.listeners()}var e,n,i;return e=t,n=[{key:"width",value:function(t){var e=this.content;return t&&p(t)&&(t+="px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}},{key:"height",value:function(t){var e=this.content;return t&&p(t)&&(t+="px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}},{key:"contentWidth",value:function(t){var e=this.content||this.document.body;return t&&p(t)&&(t+="px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}},{key:"contentHeight",value:function(t){var e=this.content||this.document.body;return t&&p(t)&&(t+="px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}},{key:"textWidth",value:function(){var t,e=this.document.createRange(),n=this.content||this.document.body,i=x(n);return e.selectNodeContents(n),t=e.getBoundingClientRect().width,i&&i.width&&(t+=i.width),Math.round(t)}},{key:"textHeight",value:function(){var t,e=this.document.createRange(),n=this.content||this.document.body;return e.selectNodeContents(n),t=e.getBoundingClientRect().bottom,Math.round(t)}},{key:"scrollWidth",value:function(){return this.documentElement.scrollWidth}},{key:"scrollHeight",value:function(){return this.documentElement.scrollHeight}},{key:"overflow",value:function(t){return t&&(this.documentElement.style.overflow=t),this.window.getComputedStyle(this.documentElement).overflow}},{key:"overflowX",value:function(t){return t&&(this.documentElement.style.overflowX=t),this.window.getComputedStyle(this.documentElement).overflowX}},{key:"overflowY",value:function(t){return t&&(this.documentElement.style.overflowY=t),this.window.getComputedStyle(this.documentElement).overflowY}},{key:"css",value:function(t,e,n){var i=this.content||this.document.body;return e?i.style.setProperty(t,e,n?"important":""):i.style.removeProperty(t),this.window.getComputedStyle(i)[t]}},{key:"viewport",value:function(t){var e,n=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},r=[];if(n&&n.hasAttribute("content")){var o=n.getAttribute("content"),s=o.match(/width\s*=\s*([^,]*)/),a=o.match(/height\s*=\s*([^,]*)/),u=o.match(/initial-scale\s*=\s*([^,]*)/),l=o.match(/minimum-scale\s*=\s*([^,]*)/),h=o.match(/maximum-scale\s*=\s*([^,]*)/),c=o.match(/user-scalable\s*=\s*([^,]*)/);s&&s.length&&void 0!==s[1]&&(i.width=s[1]),a&&a.length&&void 0!==a[1]&&(i.height=a[1]),u&&u.length&&void 0!==u[1]&&(i.scale=u[1]),l&&l.length&&void 0!==l[1]&&(i.minimum=l[1]),h&&h.length&&void 0!==h[1]&&(i.maximum=h[1]),c&&c.length&&void 0!==c[1]&&(i.scalable=c[1])}return e=g(t||{},i),t&&(e.width&&r.push("width="+e.width),e.height&&r.push("height="+e.height),e.scale&&r.push("initial-scale="+e.scale),"no"===e.scalable?(r.push("minimum-scale="+e.scale),r.push("maximum-scale="+e.scale),r.push("user-scalable="+e.scalable)):(e.scalable&&r.push("user-scalable="+e.scalable),e.minimum&&r.push("minimum-scale="+e.minimum),e.maximum&&r.push("minimum-scale="+e.maximum)),n||((n=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild(n)),n.setAttribute("content",r.join(", ")),this.window.scrollTo(0,0)),e}},{key:"expand",value:function(){this.emit(zt)}},{key:"listeners",value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),"undefined"==typeof ResizeObserver?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}},{key:"removeListeners",value:function(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}},{key:"resizeCheck",value:function(){var t=this.textWidth(),e=this.textHeight();t==this._size.width&&e==this._size.height||(this._size={width:t,height:e},this.onResize&&this.onResize(this._size),this.emit(Rt,this._size))}},{key:"resizeListeners",value:function(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:"visibilityListeners",value:function(){var t=this;document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&!1===t.active?(t.active=!0,t.resizeListeners()):(t.active=!1,clearTimeout(t.expanding))}))}},{key:"transitionListeners",value:function(){var t=this.content;t.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",t.style.transitionDuration="0.001ms",t.style.transitionTimingFunction="linear",t.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}},{key:"mediaQueryListeners",value:function(){for(var t=this.document.styleSheets,e=function(t){t.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),n=0;n<t.length;n+=1){var i;try{i=t[n].cssRules}catch(t){return}if(!i)return;for(var r=0;r<i.length;r+=1)i[r].media&&this.window.matchMedia(i[r].media.mediaText).addListener(e)}}},{key:"resizeObservers",value:function(){var t=this;this.observer=new ResizeObserver((function(e){requestAnimationFrame(t.resizeCheck.bind(t))})),this.observer.observe(this.document.documentElement)}},{key:"mutationObservers",value:function(){var t=this;this.observer=new MutationObserver((function(e){t.resizeCheck()})),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}},{key:"imageLoadListeners",value:function(){for(var t,e=this.document.querySelectorAll("img"),n=0;n<e.length;n++)void 0!==(t=e[n]).naturalWidth&&0===t.naturalWidth&&(t.onload=this.expand.bind(this))}},{key:"fontLoadListeners",value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}},{key:"root",value:function(){return this.document?this.document.documentElement:null}},{key:"locationOf",value:function(t,e){var n,i={left:0,top:0};if(!this.document)return i;if(this.epubcfi.isCfiString(t)){var r=new at(t).toRange(this.document,e);if(r){try{if(!r.endContainer||r.startContainer==r.endContainer&&r.startOffset==r.endOffset){var o=r.startContainer.textContent.indexOf(" ",r.startOffset);-1==o&&(o=r.startContainer.textContent.length),r.setEnd(r.startContainer,o)}}catch(t){console.error("setting end offset to start container length failed",t)}if(r.startContainer.nodeType===Node.ELEMENT_NODE)n=r.startContainer.getBoundingClientRect(),i.left=n.left,i.top=n.top;else if(on){var s=r.startContainer,a=new Range;try{1===s.nodeType?n=s.getBoundingClientRect():r.startOffset+2<s.length?(a.setStart(s,r.startOffset),a.setEnd(s,r.startOffset+2),n=a.getBoundingClientRect()):r.startOffset-2>0?(a.setStart(s,r.startOffset-2),a.setEnd(s,r.startOffset),n=a.getBoundingClientRect()):n=s.parentNode.getBoundingClientRect()}catch(t){console.error(t,t.stack)}}else n=r.getBoundingClientRect()}}else if("string"==typeof t&&t.indexOf("#")>-1){var u=t.substring(t.indexOf("#")+1),l=this.document.getElementById(u);if(l)if(on){var h=new Range;h.selectNode(l),n=h.getBoundingClientRect()}else n=l.getBoundingClientRect()}return n&&(i.left=n.left,i.top=n.top),i}},{key:"addStylesheet",value:function(t){return new Promise(function(e,n){var i,r=!1;this.document?(i=this.document.querySelector("link[href='"+t+"']"))?e(!0):((i=this.document.createElement("link")).type="text/css",i.rel="stylesheet",i.href=t,i.onload=i.onreadystatechange=function(){r||this.readyState&&"complete"!=this.readyState||(r=!0,setTimeout((function(){e(!0)}),1))},this.document.head.appendChild(i)):e(!1)}.bind(this))}},{key:"_getStylesheetNode",value:function(t){var e;return t="epubjs-inserted-css-"+(t||""),!!this.document&&((e=this.document.getElementById(t))||((e=this.document.createElement("style")).id=t,this.document.head.appendChild(e)),e)}},{key:"addStylesheetCss",value:function(t,e){return!(!this.document||!t||(this._getStylesheetNode(e).innerHTML=t,0))}},{key:"addStylesheetRules",value:function(t,e){var n;if(this.document&&t&&0!==t.length)if(n=this._getStylesheetNode(e).sheet,"[object Array]"===Object.prototype.toString.call(t))for(var i=0,r=t.length;i<r;i++){var o=1,s=t[i],a=t[i][0],u="";"[object Array]"===Object.prototype.toString.call(s[1][0])&&(s=s[1],o=0);for(var l=s.length;o<l;o++){var h=s[o];u+=h[0]+":"+h[1]+(h[2]?" !important":"")+";\n"}n.insertRule(a+"{"+u+"}",n.cssRules.length)}else Object.keys(t).forEach((function(e){var i=t[e];if(Array.isArray(i))i.forEach((function(t){var i=Object.keys(t).map((function(e){return"".concat(e,":").concat(t[e])})).join(";");n.insertRule("".concat(e,"{").concat(i,"}"),n.cssRules.length)}));else{var r=Object.keys(i).map((function(t){return"".concat(t,":").concat(i[t])})).join(";");n.insertRule("".concat(e,"{").concat(r,"}"),n.cssRules.length)}}))}},{key:"addScript",value:function(t){return new Promise(function(e,n){var i,r=!1;this.document?((i=this.document.createElement("script")).type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){r||this.readyState&&"complete"!=this.readyState||(r=!0,setTimeout((function(){e(!0)}),1))},this.document.head.appendChild(i)):e(!1)}.bind(this))}},{key:"addClass",value:function(t){var e;this.document&&(e=this.content||this.document.body)&&e.classList.add(t)}},{key:"removeClass",value:function(t){var e;this.document&&(e=this.content||this.document.body)&&e.classList.remove(t)}},{key:"addEventListeners",value:function(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),At.forEach((function(t){this.document.addEventListener(t,this._triggerEvent,{passive:!0})}),this))}},{key:"removeEventListeners",value:function(){this.document&&(At.forEach((function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:!0})}),this),this._triggerEvent=void 0)}},{key:"triggerEvent",value:function(t){this.emit(t.type,t)}},{key:"addSelectionListeners",value:function(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}},{key:"removeSelectionListeners",value:function(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}},{key:"onSelectionChange",value:function(t){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)}},{key:"triggerSelectedEvent",value:function(t){var e,n;t&&t.rangeCount>0&&((e=t.getRangeAt(0)).collapsed||(n=new at(e,this.cfiBase).toString(),this.emit(Pt,n),this.emit(Lt,e)))}},{key:"range",value:function(t,e){return new at(t).toRange(this.document,e)}},{key:"cfiFromRange",value:function(t,e){return new at(t,this.cfiBase,e).toString()}},{key:"cfiFromNode",value:function(t,e){return new at(t,this.cfiBase,e).toString()}},{key:"map",value:function(t){return new Qe(t).section()}},{key:"size",value:function(t,e){var n={scale:1,scalable:"no"};this.layoutStyle("scrolling"),t>=0&&(this.width(t),n.width=t,this.css("padding","0 "+t/12+"px")),e>=0&&(this.height(e),n.height=e),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(n)}},{key:"columns",value:function(t,e,n,i,r){var o=m("column-axis"),s=m("column-gap"),a=m("column-width"),u=m("column-fill"),l=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===r&&"horizontal"===l&&this.direction(r),this.width(t),this.height(e),this.viewport({width:t,height:e,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===l?(this.css("padding-top",i/2+"px",!0),this.css("padding-bottom",i/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(o,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",i/2+"px",!0),this.css("padding-right",i/2+"px",!0),this.css(o,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(s,i+"px"),this.css(a,n+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}},{key:"scaler",value:function(t,e,n){var i="scale("+t+")",r="";this.css("transform-origin","top left"),(e>=0||n>=0)&&(r=" translate("+(e||0)+"px, "+(n||0)+"px )"),this.css("transform",i+r)}},{key:"fit",value:function(t,e,n){var i=this.viewport(),r=parseInt(i.width),o=parseInt(i.height),s=t/r,a=e/o,u=s<a?s:a;if(this.layoutStyle("paginated"),this.width(r),this.height(o),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",r*u+"px "+o*u+"px"),this.css("background-color","transparent"),n&&n.properties.includes("page-spread-left")){var l=t-r*u;this.css("margin-left",l+"px")}}},{key:"direction",value:function(t){this.documentElement&&(this.documentElement.style.direction=t)}},{key:"mapPage",value:function(t,e,n,i,r){return new Qe(e,r).page(this,t,n,i)}},{key:"linksHandler",value:function(){var t=this;!function(t,e){var n=t.querySelectorAll("a[href]");if(n.length)for(var i=j(t.ownerDocument,"base"),r=i?i.getAttribute("href"):void 0,o=function(t){var n=t.getAttribute("href");if(0!==n.indexOf("mailto:"))if(n.indexOf("://")>-1)t.setAttribute("target","_blank");else{var i;try{i=new it(n,r)}catch(t){}t.onclick=function(){return i&&i.hash?e(i.Path.path+i.hash):e(i?i.Path.path:n),!1}}}.bind(this),s=0;s<n.length;s++)o(n[s])}(this.content,(function(e){t.emit(jt,e)}))}},{key:"writingMode",value:function(t){var e=m("writing-mode");return t&&this.documentElement&&(this.documentElement.style[e]=t),this.window.getComputedStyle(this.documentElement)[e]||""}},{key:"layoutStyle",value:function(t){return t&&(this._layoutStyle=t,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}},{key:"epubReadingSystem",value:function(t,e){return navigator.epubReadingSystem={name:t,version:e,layoutStyle:this.layoutStyle(),hasFeature:function(t){switch(t){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;default:return!1}}},navigator.epubReadingSystem}},{key:"destroy",value:function(){this.removeListeners()}}],i=[{key:"listenedEvents",get:function(){return At}}],n&&en(e.prototype,n),i&&en(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(sn.prototype);var an=sn;function un(t){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},un(t)}function ln(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==un(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==un(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===un(r)?r:String(r)),i)}var r}function cn(t,e,n){return e&&hn(t.prototype,e),n&&hn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var fn=function(){function t(e){ln(this,t),this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}return cn(t,[{key:"add",value:function(t,e,n,i,r,o){var s=encodeURI(e+t),a=new at(e).spinePos,u=new dn({type:t,cfiRange:e,data:n,sectionIndex:a,cb:i,className:r,styles:o});return this._annotations[s]=u,a in this._annotationsBySectionIndex?this._annotationsBySectionIndex[a].push(s):this._annotationsBySectionIndex[a]=[s],this.rendition.views().forEach((function(t){u.sectionIndex===t.index&&u.attach(t)})),u}},{key:"remove",value:function(t,e){var n=this,i=encodeURI(t+e);if(i in this._annotations){var r=this._annotations[i];if(e&&r.type!==e)return;this.rendition.views().forEach((function(t){n._removeFromAnnotationBySectionIndex(r.sectionIndex,i),r.sectionIndex===t.index&&r.detach(t)})),delete this._annotations[i]}}},{key:"_removeFromAnnotationBySectionIndex",value:function(t,e){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter((function(t){return t!==e}))}},{key:"_annotationsAt",value:function(t){return this._annotationsBySectionIndex[t]}},{key:"highlight",value:function(t,e,n,i,r){return this.add("highlight",t,e,n,i,r)}},{key:"underline",value:function(t,e,n,i,r){return this.add("underline",t,e,n,i,r)}},{key:"mark",value:function(t,e,n){return this.add("mark",t,e,n)}},{key:"each",value:function(){return this._annotations.forEach.apply(this._annotations,arguments)}},{key:"inject",value:function(t){var e=this,n=t.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach((function(n){e._annotations[n].attach(t)}))}},{key:"clear",value:function(t){var e=this,n=t.index;n in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[n].forEach((function(n){e._annotations[n].detach(t)}))}},{key:"show",value:function(){}},{key:"hide",value:function(){}}]),t}(),dn=function(){function t(e){var n=e.type,i=e.cfiRange,r=e.data,o=e.sectionIndex,s=e.cb,a=e.className,u=e.styles;ln(this,t),this.type=n,this.cfiRange=i,this.data=r,this.sectionIndex=o,this.mark=void 0,this.cb=s,this.className=a,this.styles=u}return cn(t,[{key:"update",value:function(t){this.data=t}},{key:"attach",value:function(t){var e,n=this.cfiRange,i=this.data,r=this.type,o=(this.mark,this.cb),s=this.className,a=this.styles;return"highlight"===r?e=t.highlight(n,i,o,s,a):"underline"===r?e=t.underline(n,i,o,s,a):"mark"===r&&(e=t.mark(n,i,o)),this.mark=e,this.emit(pe,e),e}},{key:"detach",value:function(t){var e,n=this.cfiRange,i=this.type;return t&&("highlight"===i?e=t.unhighlight(n):"underline"===i?e=t.ununderline(n):"mark"===i&&(e=t.unmark(n))),this.mark=void 0,this.emit(ve,e),e}},{key:"text",value:function(){}}]),t}();o()(dn.prototype);var pn=fn,vn=(n(48410),n(74661));function mn(t){return mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mn(t)}function gn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==mn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==mn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===mn(r)?r:String(r)),i)}var r}var yn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=y({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},n||{}),this.id="epubjs-view-"+c(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new at,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}var e,n;return e=t,n=[{key:"container",value:function(t){var e=document.createElement("div");return e.classList.add("epub-view"),e.style.height="0px",e.style.width="0px",e.style.overflow="hidden",e.style.position="relative",e.style.display="block",e.style.flex=t&&"horizontal"==t?"none":"initial",e}},{key:"create",value:function(){return this.iframe||(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=k(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write")),this.iframe}},{key:"render",value:function(t,e){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(t)),this.sectionRender.then(function(t){return this.load(t)}.bind(this)).then(function(){var t,e=this,n=this.contents.writingMode();return t="scrolled"===this.settings.flow?0===n.indexOf("vertical")?"horizontal":"vertical":0===n.indexOf("vertical")?"vertical":"horizontal",0===n.indexOf("vertical")&&"paginated"===this.settings.flow&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit(Xt,t),this.setWritingMode(n),this.emit(Zt,n),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((function(t,n){e.expand(),e.settings.forceRight&&(e.element.style.marginLeft=e.width()+"px"),t()}))}.bind(this),function(t){return this.emit(Vt,t),new Promise((function(e,n){n(t)}))}.bind(this)).then(function(){this.emit(Yt,this.section)}.bind(this))}},{key:"reset",value:function(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}},{key:"size",value:function(t,e){var n=t||this.settings.width,i=e||this.settings.height;"pre-paginated"===this.layout.name?this.lock("both",n,i):"horizontal"===this.settings.axis?this.lock("height",n,i):this.lock("width",n,i),this.settings.width=n,this.settings.height=i}},{key:"lock",value:function(t,e,n){var i,r=x(this.element);i=this.iframe?x(this.iframe):{width:0,height:0},"width"==t&&p(e)&&(this.lockedWidth=e-r.width-i.width),"height"==t&&p(n)&&(this.lockedHeight=n-r.height-i.height),"both"===t&&p(e)&&p(n)&&(this.lockedWidth=e-r.width-i.width,this.lockedHeight=n-r.height-i.height),this.displayed&&this.iframe&&this.expand()}},{key:"expand",value:function(t){var e,n=this.lockedWidth,i=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(n=this.layout.columnWidth,i=this.layout.height):"horizontal"===this.settings.axis?((n=this.contents.textWidth())%this.layout.pageWidth>0&&(n=Math.ceil(n/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(e=n/this.layout.pageWidth,this.layout.divisor>1&&"reflowable"===this.layout.name&&e%2>0&&(n+=this.layout.pageWidth))):"vertical"===this.settings.axis&&(i=this.contents.textHeight(),"paginated"===this.settings.flow&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||n!=this._width||i!=this._height)&&this.reframe(n,i),this._expanding=!1)}},{key:"reframe",value:function(t,e){var n,i=this;p(t)&&(this.element.style.width=t+"px",this.iframe.style.width=t+"px",this._width=t),p(e)&&(this.element.style.height=e+"px",this.iframe.style.height=e+"px",this._height=e),n={width:t,height:e,widthDelta:this.prevBounds?t-this.prevBounds.width:t,heightDelta:this.prevBounds?e-this.prevBounds.height:e},this.pane&&this.pane.render(),requestAnimationFrame((function(){var t;for(var e in i.marks)i.marks.hasOwnProperty(e)&&(t=i.marks[e],i.placeMark(t.element,t.range))})),this.onResize(this,n),this.emit(Gt,n),this.prevBounds=n,this.elementBounds=k(this.element)}},{key:"load",value:function(t){var e=new q,n=e.promise;if(!this.iframe)return e.reject(new Error("No Iframe Available")),n;if(this.iframe.onload=function(t){this.onLoad(t,e)}.bind(this),"blobUrl"===this.settings.method)this.blobUrl=I(t,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=t,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return e.reject(new Error("No Document Available")),n;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var i=this;MSApp.execUnsafeLocalFunction((function(){i.iframe.contentDocument.write(t)}))}else this.iframe.contentDocument.write(t);this.iframe.contentDocument.close()}return n}},{key:"onLoad",value:function(t,e){var n=this;this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new an(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):((i=this.document.createElement("link")).setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(zt,(function(){n.displayed&&n.iframe&&(n.expand(),n.contents&&n.layout.format(n.contents))})),this.contents.on(Rt,(function(t){n.displayed&&n.iframe&&(n.expand(),n.contents&&n.layout.format(n.contents))})),e.resolve(this.contents)}},{key:"setLayout",value:function(t){this.layout=t,this.contents&&(this.layout.format(this.contents),this.expand())}},{key:"setAxis",value:function(t){this.settings.axis=t,this.element.style.flex="horizontal"==t?"none":"initial",this.size()}},{key:"setWritingMode",value:function(t){this.writingMode=t}},{key:"addListeners",value:function(){}},{key:"removeListeners",value:function(t){}},{key:"display",value:function(t){var e=new q;return this.displayed?e.resolve(this):this.render(t).then(function(){this.emit(Kt,this),this.onDisplayed(this),this.displayed=!0,e.resolve(this)}.bind(this),(function(t){e.reject(t,this)})),e.promise}},{key:"show",value:function(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit($t,this)}},{key:"hide",value:function(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(Jt,this)}},{key:"offset",value:function(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}},{key:"width",value:function(){return this._width}},{key:"height",value:function(){return this._height}},{key:"position",value:function(){return this.element.getBoundingClientRect()}},{key:"locationOf",value:function(t){this.iframe.getBoundingClientRect();var e=this.contents.locationOf(t,this.settings.ignoreClass);return{left:e.left,top:e.top}}},{key:"onDisplayed",value:function(t){}},{key:"onResize",value:function(t,e){}},{key:"bounds",value:function(t){return!t&&this.elementBounds||(this.elementBounds=k(this.element)),this.elementBounds}},{key:"highlight",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"epubjs-hl",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.contents){var s=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},o),a=this.contents.range(t),u=function(){e.emit(Qt,t,n)};n.epubcfi=t,this.pane||(this.pane=new vn.X6(this.iframe,this.element));var l=new vn.y$(a,r,n,s),h=this.pane.addMark(l);return this.highlights[t]={mark:h,element:h.element,listeners:[u,i]},h.element.setAttribute("ref",r),h.element.addEventListener("click",u),h.element.addEventListener("touchstart",u),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}}},{key:"underline",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"epubjs-ul",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.contents){var s=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},o),a=this.contents.range(t),u=function(){e.emit(Qt,t,n)};n.epubcfi=t,this.pane||(this.pane=new vn.X6(this.iframe,this.element));var l=new vn.v6(a,r,n,s),h=this.pane.addMark(l);return this.underlines[t]={mark:h,element:h.element,listeners:[u,i]},h.element.setAttribute("ref",r),h.element.addEventListener("click",u),h.element.addEventListener("touchstart",u),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}}},{key:"mark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if(this.contents){if(t in this.marks){var r=this.marks[t];return r}var o=this.contents.range(t);if(o){var s=o.commonAncestorContainer,a=1===s.nodeType?s:s.parentNode,u=function(i){e.emit(Qt,t,n)};o.collapsed&&1===s.nodeType?(o=new Range).selectNodeContents(s):o.collapsed&&(o=new Range).selectNodeContents(a);var l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=t,n&&Object.keys(n).forEach((function(t){l.dataset[t]=n[t]})),i&&(l.addEventListener("click",i),l.addEventListener("touchstart",i)),l.addEventListener("click",u),l.addEventListener("touchstart",u),this.placeMark(l,o),this.element.appendChild(l),this.marks[t]={element:l,range:o,listeners:[u,i]},a}}}},{key:"placeMark",value:function(t,e){var n,i,r;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){var o=e.getBoundingClientRect();n=o.top,i=o.right}else for(var s,a=e.getClientRects(),u=0;u!=a.length;u++)s=a[u],(!r||s.left<r)&&(r=s.left,i=Math.ceil(r/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,n=s.top);t.style.top="".concat(n,"px"),t.style.left="".concat(i,"px")}},{key:"unhighlight",value:function(t){var e;t in this.highlights&&(e=this.highlights[t],this.pane.removeMark(e.mark),e.listeners.forEach((function(t){t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t))})),delete this.highlights[t])}},{key:"ununderline",value:function(t){var e;t in this.underlines&&(e=this.underlines[t],this.pane.removeMark(e.mark),e.listeners.forEach((function(t){t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t))})),delete this.underlines[t])}},{key:"unmark",value:function(t){var e;t in this.marks&&(e=this.marks[t],this.element.removeChild(e.element),e.listeners.forEach((function(t){t&&(e.element.removeEventListener("click",t),e.element.removeEventListener("touchstart",t))})),delete this.marks[t])}},{key:"destroy",value:function(){for(var t in this.highlights)this.unhighlight(t);for(var e in this.underlines)this.ununderline(e);for(var n in this.marks)this.unmark(n);this.blobUrl&&z(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}],n&&gn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(yn.prototype);var bn=yn;var wn=n(19783),_n=n.n(wn);function kn(t){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn(t)}function xn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==kn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==kn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===kn(r)?r:String(r)),i)}var r}var Sn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=e||{},this.id="epubjs-container-"+c(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}var e,n;return e=t,n=[{key:"create",value:function(t){var e=t.height,n=t.width,i=t.overflow||!1,r=t.axis||"vertical",o=t.direction;y(this.settings,t),t.height&&p(t.height)&&(e=t.height+"px"),t.width&&p(t.width)&&(n=t.width+"px");var s=document.createElement("div");return s.id=this.id,s.classList.add("epub-container"),s.style.wordSpacing="0",s.style.lineHeight="0",s.style.verticalAlign="top",s.style.position="relative","horizontal"===r&&(s.style.display="flex",s.style.flexDirection="row",s.style.flexWrap="nowrap"),n&&(s.style.width=n),e&&(s.style.height=e),i&&("scroll"===i&&"vertical"===r?(s.style["overflow-y"]=i,s.style["overflow-x"]="hidden"):"scroll"===i&&"horizontal"===r?(s.style["overflow-y"]="hidden",s.style["overflow-x"]=i):s.style.overflow=i),o&&(s.dir=o,s.style.direction=o),o&&this.settings.fullsize&&(document.body.style.direction=o),s}},{key:"wrap",value:function(t){var e=document.createElement("div");return e.style.visibility="hidden",e.style.overflow="hidden",e.style.width="0",e.style.height="0",e.appendChild(t),e}},{key:"getElement",value:function(t){var e;if(d(t)?e=t:"string"==typeof t&&(e=document.getElementById(t)),!e)throw new Error("Not an Element");return e}},{key:"attachTo",value:function(t){var e,n=this.getElement(t);if(n)return e=this.settings.hidden?this.wrapper:this.container,n.appendChild(e),this.element=n,n}},{key:"getContainer",value:function(){return this.container}},{key:"onResize",value:function(t){p(this.settings.width)&&p(this.settings.height)||(this.resizeFunc=_n()(t,50),window.addEventListener("resize",this.resizeFunc,!1))}},{key:"onOrientationChange",value:function(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}},{key:"size",value:function(t,e){var n,i=t||this.settings.width,r=e||this.settings.height;null===t?(n=this.element.getBoundingClientRect()).width&&(t=Math.floor(n.width),this.container.style.width=t+"px"):p(t)?this.container.style.width=t+"px":this.container.style.width=t,null===e?(n=n||this.element.getBoundingClientRect()).height&&(e=n.height,this.container.style.height=e+"px"):p(e)?this.container.style.height=e+"px":this.container.style.height=e,p(t)||(t=this.container.clientWidth),p(e)||(e=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};var o=E(),s=window.getComputedStyle(document.body),a=parseFloat(s["padding-left"])||0,u=parseFloat(s["padding-right"])||0,l=parseFloat(s["padding-top"])||0,h=parseFloat(s["padding-bottom"])||0;return i||(t=o.width-a-u),(this.settings.fullsize&&!r||!r)&&(e=o.height-l-h),{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom}}},{key:"bounds",value:function(){var t;return"visible"!==this.container.style.overflow&&(t=this.container&&this.container.getBoundingClientRect()),t&&t.width&&t.height?t:E()}},{key:"getSheet",value:function(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}},{key:"addStyleRules",value:function(t,e){var n="#"+this.id+" ",i="";this.sheet||(this.sheet=this.getSheet()),e.forEach((function(t){for(var e in t)t.hasOwnProperty(e)&&(i+=e+":"+t[e]+";")})),this.sheet.insertRule(n+t+" {"+i+"}",0)}},{key:"axis",value:function(t){"horizontal"===t?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t}},{key:"direction",value:function(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t}},{key:"overflow",value:function(t){this.container&&("scroll"===t&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):"scroll"===t&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t}},{key:"destroy",value:function(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}],n&&xn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),En=Sn;function Cn(t){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cn(t)}function Tn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Cn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Cn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Cn(r)?r:String(r)),i)}var r}var Nn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=e,this._views=[],this.length=0,this.hidden=!1}var e,n;return e=t,n=[{key:"all",value:function(){return this._views}},{key:"first",value:function(){return this._views[0]}},{key:"last",value:function(){return this._views[this._views.length-1]}},{key:"indexOf",value:function(t){return this._views.indexOf(t)}},{key:"slice",value:function(){return this._views.slice.apply(this._views,arguments)}},{key:"get",value:function(t){return this._views[t]}},{key:"append",value:function(t){return this._views.push(t),this.container&&this.container.appendChild(t.element),this.length++,t}},{key:"prepend",value:function(t){return this._views.unshift(t),this.container&&this.container.insertBefore(t.element,this.container.firstChild),this.length++,t}},{key:"insert",value:function(t,e){return this._views.splice(e,0,t),this.container&&(e<this.container.children.length?this.container.insertBefore(t.element,this.container.children[e]):this.container.appendChild(t.element)),this.length++,t}},{key:"remove",value:function(t){var e=this._views.indexOf(t);e>-1&&this._views.splice(e,1),this.destroy(t),this.length--}},{key:"destroy",value:function(t){t.displayed&&t.destroy(),this.container&&this.container.removeChild(t.element),t=null}},{key:"forEach",value:function(){return this._views.forEach.apply(this._views,arguments)}},{key:"clear",value:function(){var t,e=this.length;if(this.length){for(var n=0;n<e;n++)t=this._views[n],this.destroy(t);this._views=[],this.length=0}}},{key:"find",value:function(t){for(var e,n=this.length,i=0;i<n;i++)if((e=this._views[i]).displayed&&e.section.index==t.index)return e}},{key:"displayed",value:function(){for(var t,e=[],n=this.length,i=0;i<n;i++)(t=this._views[i]).displayed&&e.push(t);return e}},{key:"show",value:function(){for(var t,e=this.length,n=0;n<e;n++)(t=this._views[n]).displayed&&t.show();this.hidden=!1}},{key:"hide",value:function(){for(var t,e=this.length,n=0;n<e;n++)(t=this._views[n]).displayed&&t.hide();this.hidden=!0}}],n&&Tn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),On=Nn;function An(t){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},An(t)}function In(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==An(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==An(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===An(r)?r:String(r)),i)}var r}var zn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new Nt(this),this.settings=y(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),y(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}var e,n;return e=t,n=[{key:"render",value:function(t,e){var n=t.tagName;void 0!==this.settings.fullsize||!n||"body"!=n.toLowerCase()&&"html"!=n.toLowerCase()||(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=e,this.settings.rtlScrollType=function(){var t="reverse",e=function(){var t=document.createElement("div");t.dir="rtl",t.style.position="fixed",t.style.width="1px",t.style.height="1px",t.style.top="0px",t.style.left="0px",t.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var n=document.createElement("span");n.style.width="1px",n.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(n),e.appendChild(i),t.appendChild(e),t}();return document.body.appendChild(e),e.scrollLeft>0?t="default":"undefined"!=typeof Element&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(t="negative")):(e.scrollLeft=1,0===e.scrollLeft&&(t="negative")),document.body.removeChild(e),t}(),this.stage=new En({width:e.width,height:e.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(t),this.container=this.stage.getContainer(),this.views=new On(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}},{key:"addEventListeners",value:function(){var t;window.addEventListener("unload",function(t){this.destroy()}.bind(this)),t=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll)}},{key:"removeEventListeners",value:function(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}},{key:"destroy",value:function(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}},{key:"onOrientationChange",value:function(t){var e=window.orientation;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(Mt,e)}.bind(this),500)}},{key:"onResized",value:function(t){this.resize()}},{key:"resize",value:function(t,e,n){var i=this.stage.size(t,e);this.winBounds=E(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height?this._stageSize=void 0:this._stageSize&&this._stageSize.width===i.width&&this._stageSize.height===i.height||(this._stageSize=i,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(Ft,{width:this._stageSize.width,height:this._stageSize.height},n))}},{key:"createView",value:function(t,e){return new this.View(t,y(this.viewSettings,{forceRight:e}))}},{key:"handleNextPrePaginated",value:function(t,e,n){var i;if("pre-paginated"===this.layout.name&&this.layout.divisor>1){if(t||0===e.index)return;if((i=e.next())&&!i.properties.includes("page-spread-left"))return n.call(this,i)}}},{key:"display",value:function(t,e){var n=new q,i=n.promise;(e===t.href||p(e))&&(e=void 0);var r=this.views.find(t);if(r&&t&&"pre-paginated"!==this.layout.name){var o=r.offset();if("ltr"===this.settings.direction)this.scrollTo(o.left,o.top,!0);else{var s=r.width();this.scrollTo(o.left+s,o.top,!0)}if(e){var a=r.locationOf(e),u=r.width();this.moveTo(a,u)}return n.resolve(),i}this.clear();var l=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&t.properties.includes("page-spread-right")&&(l=!0),this.add(t,l).then(function(t){if(e){var n=t.locationOf(e),i=t.width();this.moveTo(n,i)}}.bind(this),(function(t){n.reject(t)})).then(function(){return this.handleNextPrePaginated(l,t,this.add)}.bind(this)).then(function(){this.views.show(),n.resolve()}.bind(this)),i}},{key:"afterDisplayed",value:function(t){this.emit(Ut,t)}},{key:"afterResized",value:function(t){this.emit(Dt,t.section)}},{key:"moveTo",value:function(t,e){var n=0,i=0;this.isPaginated?((n=Math.floor(t.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(n=this.container.scrollWidth-this.layout.delta),(i=Math.floor(t.top/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollHeight&&(i=this.container.scrollHeight-this.layout.delta)):i=t.top,"rtl"===this.settings.direction&&(n+=this.layout.delta,n-=e),this.scrollTo(n,i,!0)}},{key:"add",value:function(t,e){var n=this,i=this.createView(t,e);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Xt,(function(t){n.updateAxis(t)})),i.on(Zt,(function(t){n.updateWritingMode(t)})),i.display(this.request)}},{key:"append",value:function(t,e){var n=this,i=this.createView(t,e);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Xt,(function(t){n.updateAxis(t)})),i.on(Zt,(function(t){n.updateWritingMode(t)})),i.display(this.request)}},{key:"prepend",value:function(t,e){var n=this,i=this.createView(t,e);return i.on(Gt,(function(t){n.counter(t)})),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Xt,(function(t){n.updateAxis(t)})),i.on(Zt,(function(t){n.updateWritingMode(t)})),i.display(this.request)}},{key:"counter",value:function(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}},{key:"next",value:function(){var t,e=this.settings.direction;if(this.views.length&&(!this.isPaginated||"horizontal"!==this.settings.axis||e&&"ltr"!==e?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===e?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next():this.container.scrollLeft+-1*this.layout.delta>-1*this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):t=this.views.last().section.next()):t=this.views.last().section.next():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()),t)){this.clear(),this.updateLayout();var n=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&t.properties.includes("page-spread-right")&&(n=!0),this.append(t,n).then(function(){return this.handleNextPrePaginated(n,t,this.append)}.bind(this),(function(t){return t})).then(function(){this.isPaginated||"horizontal"!==this.settings.axis||"rtl"!==this.settings.direction||"default"!==this.settings.rtlScrollType||this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}},{key:"prev",value:function(){var t,e=this.settings.direction;if(this.views.length&&(!this.isPaginated||"horizontal"!==this.settings.axis||e&&"ltr"!==e?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===e?(this.scrollLeft=this.container.scrollLeft,"default"===this.settings.rtlScrollType?this.container.scrollLeft+this.container.offsetWidth<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev():this.container.scrollLeft<0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):t=this.views.first().section.prev()):t=this.views.first().section.prev():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()),t)){this.clear(),this.updateLayout();var n=!1;return"pre-paginated"===this.layout.name&&2===this.layout.divisor&&"object"!==An(t.prev())&&(n=!0),this.prepend(t,n).then(function(){var e;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(e=t.prev()))return this.prepend(e)}.bind(this),(function(t){return t})).then(function(){this.isPaginated&&"horizontal"===this.settings.axis&&("rtl"===this.settings.direction?"default"===this.settings.rtlScrollType?this.scrollTo(0,0,!0):this.scrollTo(-1*this.container.scrollWidth+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}},{key:"current",value:function(){var t=this.visible();return t.length?t[t.length-1]:null}},{key:"clear",value:function(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}},{key:"currentLocation",value:function(){return this.updateLayout(),this.isPaginated&&"horizontal"===this.settings.axis?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}},{key:"scrolledLocation",value:function(){var t=this,e=this.visible(),n=this.container.getBoundingClientRect(),i=n.height<window.innerHeight?n.height:window.innerHeight,r=n.width<window.innerWidth?n.width:window.innerWidth,o="vertical"===this.settings.axis,s=(this.settings.direction,0);return this.settings.fullsize&&(s=o?window.scrollY:window.scrollX),e.map((function(e){var a,u,l,h,c=e.section,f=c.index,d=c.href,p=e.position(),v=e.width(),m=e.height();o?(u=(a=s+n.top-p.top+0)+i-0,h=t.layout.count(m,i).pages,l=i):(u=(a=s+n.left-p.left+0)+r-0,h=t.layout.count(v,r).pages,l=r);var g=Math.ceil(a/l),y=[],b=Math.ceil(u/l);if("rtl"===t.settings.direction&&!o){var w=g;g=h-b,b=h-w}y=[];for(var _=g;_<=b;_++){var k=_+1;y.push(k)}return{index:f,href:d,pages:y,totalPages:h,mapping:t.mapping.page(e.contents,e.section.cfiBase,a,u)}}))}},{key:"paginatedLocation",value:function(){var t=this,e=this.visible(),n=this.container.getBoundingClientRect(),i=0,r=0;return this.settings.fullsize&&(i=window.scrollX),e.map((function(e){var o,s,a,u,l=e.section,h=l.index,c=l.href,f=e.position(),d=e.width();"rtl"===t.settings.direction?(o=n.right-i,u=Math.min(Math.abs(o-f.left),t.layout.width)-r,s=(a=f.width-(f.right-o)-r)-u):(o=n.left+i,u=Math.min(f.right-o,t.layout.width)-r,a=(s=o-f.left+r)+u),r+=u;var p=t.mapping.page(e.contents,e.section.cfiBase,s,a),v=t.layout.count(d).pages,m=Math.floor(s/t.layout.pageWidth),g=[],y=Math.floor(a/t.layout.pageWidth);if(m<0&&(m=0,y+=1),"rtl"===t.settings.direction){var b=m;m=v-y,y=v-b}for(var w=m+1;w<=y;w++){var _=w;g.push(_)}return{index:h,href:c,pages:g,totalPages:v,mapping:p}}))}},{key:"isVisible",value:function(t,e,n,i){var r=t.position(),o=i||this.bounds();return"horizontal"===this.settings.axis&&r.right>o.left-e&&r.left<o.right+n||"vertical"===this.settings.axis&&r.bottom>o.top-e&&r.top<o.bottom+n}},{key:"visible",value:function(){for(var t,e=this.bounds(),n=this.views.displayed(),i=n.length,r=[],o=0;o<i;o++)t=n[o],!0===this.isVisible(t,0,0,e)&&r.push(t);return r}},{key:"scrollBy",value:function(t,e,n){var i="rtl"===this.settings.direction?-1:1;n&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(t*i,e*i):(t&&(this.container.scrollLeft+=t*i),e&&(this.container.scrollTop+=e)),this.scrolled=!0}},{key:"scrollTo",value:function(t,e,n){n&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(t,e):(this.container.scrollLeft=t,this.container.scrollTop=e),this.scrolled=!0}},{key:"onScroll",value:function(){var t,e;this.settings.fullsize?(t=window.scrollY,e=window.scrollX):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:(this.emit(Wt,{top:t,left:e}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(qt,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}},{key:"bounds",value:function(){return this.stage.bounds()}},{key:"applyLayout",value:function(t){this.layout=t,this.updateLayout(),this.views&&this.views.length>0&&"pre-paginated"===this.layout.name&&this.display(this.views.first().section)}},{key:"updateLayout",value:function(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}},{key:"setLayout",value:function(t){this.viewSettings.layout=t,this.mapping=new Qe(t.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach((function(e){e&&e.setLayout(t)}))}},{key:"updateWritingMode",value:function(t){this.writingMode=t}},{key:"updateAxis",value:function(t,e){(e||t!==this.settings.axis)&&(this.settings.axis=t,this.stage&&this.stage.axis(t),this.viewSettings.axis=t,this.mapping&&(this.mapping=new Qe(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&("vertical"===t?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}},{key:"updateFlow",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",n="paginated"===t||"auto"===t;this.isPaginated=n,"scrolled-doc"===t||"scrolled-continuous"===t||"scrolled"===t?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=t,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=n?"hidden":e,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}},{key:"getContents",value:function(){var t=[];return this.views?(this.views.forEach((function(e){var n=e&&e.contents;n&&t.push(n)})),t):t}},{key:"direction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ltr";this.settings.direction=t,this.stage&&this.stage.direction(t),this.viewSettings.direction=t,this.updateLayout()}},{key:"isRendered",value:function(){return this.rendered}}],n&&In(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(zn.prototype);var Rn=zn;function Pn(t){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pn(t)}function Ln(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Pn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Pn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Pn(r)?r:String(r)),i)}var r}n(53984),n(50987),n(12274),n(3214),n(83011);var jn=Math.PI/2,Bn={easeOutSine:function(t){return Math.sin(t*jn)},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInCubic:function(t){return Math.pow(t,3)}},Dn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=y({duration:80,minVelocity:.2,minDistance:10,easing:Bn.easeInCubic},n||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}var e,n;return e=t,n=[{key:"setup",value:function(t){this.manager=t,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}},{key:"supportsTouch",value:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}},{key:"disableScroll",value:function(){this.element.style.overflow="hidden"}},{key:"enableScroll",value:function(){this.element.style.overflow=""}},{key:"addListeners",value:function(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(Ut,this._afterDisplayed)}},{key:"removeListeners",value:function(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(Ut,this._afterDisplayed),this._afterDisplayed=void 0}},{key:"afterDisplayed",value:function(t){var e=this,n=t.contents;["touchstart","touchmove","touchend"].forEach((function(t){n.on(t,(function(t){return e.triggerViewEvent(t,n)}))}))}},{key:"triggerViewEvent",value:function(t,e){this.emit(t.type,t,e)}},{key:"onScroll",value:function(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}},{key:"onResize",value:function(t){this.resizeCanceler=!0}},{key:"onTouchStart",value:function(t){var e=t.touches[0],n=e.screenX,i=e.screenY;this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=n,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=n,this.endTouchY=i,this.endTime=this.now()}},{key:"onTouchMove",value:function(t){var e=t.touches[0],n=e.screenX,i=e.screenY,r=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&r<10&&(this.element.scrollLeft-=n-this.endTouchX),this.endTouchX=n,this.endTouchY=i,this.endTime=this.now()}},{key:"onTouchEnd",value:function(t){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;var e=this.wasSwiped();0!==e?this.snap(e):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}},{key:"wasSwiped",value:function(){var t=this.layout.pageWidth*this.layout.divisor,e=this.endTouchX-this.startTouchX,n=Math.abs(e),i=e/(this.endTime-this.startTime),r=this.settings.minVelocity;return n<=this.settings.minDistance||n>=t?0:i>r?-1:i<-r?1:void 0}},{key:"needsSnap",value:function(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!=0}},{key:"snap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor,i=Math.round(e/n)*n;return t&&(i+=t*n),this.smoothScrollTo(i)}},{key:"smoothScrollTo",value:function(t){var e=new q,n=this.scrollLeft,i=this.now(),r=this.settings.duration,o=this.settings.easing;return this.snapping=!0,function s(){var a=this.now(),u=Math.min(1,(a-i)/r);if(o(u),this.touchCanceler||this.resizeCanceler)return this.resizeCanceler=!1,this.snapping=!1,void e.resolve();u<1?(window.requestAnimationFrame(s.bind(this)),this.scrollTo(n+(t-n)*u,0)):(this.scrollTo(t,0),this.snapping=!1,e.resolve())}.call(this),e.promise}},{key:"scrollTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fullsize?window.scroll(t,e):(this.scroller.scrollLeft=t,this.scroller.scrollTop=e)}},{key:"now",value:function(){return"now"in window.performance?performance.now():(new Date).getTime()}},{key:"destroy",value:function(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}],n&&Ln(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(Dn.prototype);var Fn=Dn,Mn=n(66726),Un=n.n(Mn);function Wn(t){return Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wn(t)}function qn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Wn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==Wn(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===Wn(r)?r:String(r)),i)}var r}function Hn(){return Hn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Xn(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Hn.apply(this,arguments)}function Xn(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yn(t)););return t}function Zn(t,e){return Zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zn(t,e)}function Vn(t,e){if(e&&("object"===Wn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Yn(t){return Yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yn(t)}var Gn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zn(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yn(i);if(r){var n=Yn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Vn(this,t)});function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=o.call(this,t)).name="continuous",e.settings=y(e.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),y(e.settings,t.settings||{}),"undefined"!=t.settings.gap&&0===t.settings.gap&&(e.settings.gap=t.settings.gap),e.viewSettings={ignoreClass:e.settings.ignoreClass,axis:e.settings.axis,flow:e.settings.flow,layout:e.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:e.settings.allowScriptedContent,allowPopups:e.settings.allowPopups},e.scrollTop=0,e.scrollLeft=0,e}return e=s,n=[{key:"display",value:function(t,e){return Rn.prototype.display.call(this,t,e).then(function(){return this.fill()}.bind(this))}},{key:"fill",value:function(t){var e=this,n=t||new q;return this.q.enqueue((function(){return e.check()})).then((function(t){t?e.fill(n):n.resolve()})),n.promise}},{key:"moveTo",value:function(t){var e=0,n=0;this.isPaginated?(e=Math.floor(t.left/this.layout.delta)*this.layout.delta,this.settings.offsetDelta):(n=t.top,t.top,this.settings.offsetDelta),(e>0||n>0)&&this.scrollBy(e,n,!0)}},{key:"afterResized",value:function(t){this.emit(Dt,t.section)}},{key:"removeShownListeners",value:function(t){t.onDisplayed=function(){}}},{key:"add",value:function(t){var e=this,n=this.createView(t);return this.views.append(n),n.on(Gt,(function(t){n.expanded=!0})),n.on(Xt,(function(t){e.updateAxis(t)})),n.on(Zt,(function(t){e.updateWritingMode(t)})),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.display(this.request)}},{key:"append",value:function(t){var e=this,n=this.createView(t);return n.on(Gt,(function(t){n.expanded=!0})),n.on(Xt,(function(t){e.updateAxis(t)})),n.on(Zt,(function(t){e.updateWritingMode(t)})),this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n}},{key:"prepend",value:function(t){var e=this,n=this.createView(t);return n.on(Gt,(function(t){e.counter(t),n.expanded=!0})),n.on(Xt,(function(t){e.updateAxis(t)})),n.on(Zt,(function(t){e.updateWritingMode(t)})),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n}},{key:"counter",value:function(t){"vertical"===this.settings.axis?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}},{key:"update",value:function(t){for(var e,n=this.bounds(),i=this.views.all(),r=i.length,o=[],s=void 0!==t?t:this.settings.offset||0,a=new q,u=[],l=0;l<r;l++)if(e=i[l],!0===this.isVisible(e,s,s,n)){if(e.displayed)e.show();else{var h=e.display(this.request).then((function(t){t.show()}),(function(t){e.hide()}));u.push(h)}o.push(e)}else this.q.enqueue(e.destroy.bind(e)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return u.length?Promise.all(u).catch((function(t){a.reject(t)})):(a.resolve(),a.promise)}},{key:"check",value:function(t,e){var n=this,i=new q,r=[],o="horizontal"===this.settings.axis,s=this.settings.offset||0;t&&o&&(s=t),e&&!o&&(s=e);var a=this._bounds,u=o?this.scrollLeft:this.scrollTop,l=o?Math.floor(a.width):a.height,h=o?this.container.scrollWidth:this.container.scrollHeight,c=this.writingMode&&0===this.writingMode.indexOf("vertical")?"vertical":"horizontal",f=this.settings.rtlScrollType,d="rtl"===this.settings.direction;this.settings.fullsize?(o&&d&&"negative"===f||!o&&d&&"default"===f)&&(u*=-1):(d&&"default"===f&&"horizontal"===c&&(u=h-l-u),d&&"negative"===f&&"horizontal"===c&&(u*=-1));var p,v,m,g,y=u-s;u+l+s>=h&&((v=(p=n.views.last())&&p.section.next())&&r.push(n.append(v))),y<0&&((g=(m=n.views.first())&&m.section.prev())&&r.push(n.prepend(g)));var b=r.map((function(t){return t.display(n.request)}));return r.length?Promise.all(b).then((function(){return n.check()})).then((function(){return n.update(s)}),(function(t){return t})):(this.q.enqueue(function(){this.update()}.bind(this)),i.resolve(!1),i.promise)}},{key:"trim",value:function(){for(var t=new q,e=this.views.displayed(),n=e[0],i=e[e.length-1],r=this.views.indexOf(n),o=this.views.indexOf(i),s=this.views.slice(0,r),a=this.views.slice(o+1),u=0;u<s.length-1;u++)this.erase(s[u],s);for(var l=1;l<a.length;l++)this.erase(a[l]);return t.resolve(),t.promise}},{key:"erase",value:function(t,e){var n,i;this.settings.fullsize?(n=window.scrollY,i=window.scrollX):(n=this.container.scrollTop,i=this.container.scrollLeft);var r=t.bounds();this.views.remove(t),e&&("vertical"===this.settings.axis?this.scrollTo(0,n-r.height,!0):"rtl"===this.settings.direction?this.settings.fullsize?this.scrollTo(i+Math.floor(r.width),0,!0):this.scrollTo(i,0,!0):this.scrollTo(i-Math.floor(r.width),0,!0))}},{key:"addEventListeners",value:function(t){window.addEventListener("unload",function(t){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new Fn(this,this.settings.snap&&"object"===Wn(this.settings.snap)&&this.settings.snap))}},{key:"addScrollListeners",value:function(){var t;this.tick=l;var e="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(t=window,this.scrollTop=window.scrollY*e,this.scrollLeft=window.scrollX*e):(t=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll),this._scrolled=Un()(this.scrolled.bind(this),30),this.didScroll=!1}},{key:"removeEventListeners",value:function(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}},{key:"onScroll",value:function(){var t,e,n="rtl"===this.settings.direction&&"default"===this.settings.rtlScrollType?-1:1;this.settings.fullsize?(t=window.scrollY*n,e=window.scrollX*n):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(e-this.prevScrollLeft),this.prevScrollTop=t,this.prevScrollLeft=e,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}},{key:"scrolled",value:function(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(Wt,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(qt,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}},{key:"next",value:function(){var t="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(t,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}},{key:"prev",value:function(){var t="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-t,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}},{key:"updateFlow",value:function(t){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),Hn(Yn(s.prototype),"updateFlow",this).call(this,t,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new Fn(this,this.settings.snap&&"object"===Wn(this.settings.snap)&&this.settings.snap))}},{key:"destroy",value:function(){Hn(Yn(s.prototype),"destroy",this).call(this),this.snapper&&this.snapper.destroy()}}],n&&qn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(Rn),Kn=Gn;function $n(t){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$n(t)}function Jn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==$n(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==$n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===$n(r)?r:String(r)),i)}var r}var Qn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=y(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),y(this.settings,n),"object"===$n(this.settings.manager)&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new ct(this),this.hooks.serialize=new ct(this),this.hooks.content=new ct(this),this.hooks.unloaded=new ct(this),this.hooks.layout=new ct(this),this.hooks.render=new ct(this),this.hooks.show=new ct(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new Ye(this),this.annotations=new pn(this),this.epubcfi=new at,this.q=new Nt(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new q,this.started=this.starting.promise,this.q.enqueue(this.start)}var e,n;return e=t,n=[{key:"setManager",value:function(t){this.manager=t}},{key:"requireManager",value:function(t){return"string"==typeof t&&"default"===t?Rn:"string"==typeof t&&"continuous"===t?Kn:t}},{key:"requireView",value:function(t){return"string"==typeof t&&"iframe"===t?bn:t}},{key:"start",value:function(){switch(this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Ut,this.afterDisplayed.bind(this)),this.manager.on(Ht,this.afterRemoved.bind(this)),this.manager.on(Ft,this.onResized.bind(this)),this.manager.on(Mt,this.onOrientationChange.bind(this)),this.manager.on(qt,this.reportLocation.bind(this)),this.emit(te),this.starting.resolve()}},{key:"attachTo",value:function(t){return this.q.enqueue(function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height}),this.emit(ee)}.bind(this))}},{key:"display",value:function(t){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,t)}},{key:"_display",value:function(t){var e=this;if(this.book){this.epubcfi.isCfiString(t);var n,i=new q,r=i.promise;return this.displaying=i,this.book.locations.length()&&v(t)&&(t=this.book.locations.cfiFromPercentage(parseFloat(t))),(n=this.book.spine.get(t))?(this.manager.display(n,t).then((function(){i.resolve(n),e.displaying=void 0,e.emit(ne,n),e.reportLocation()}),(function(t){e.emit(ie,t)})),r):(i.reject(new Error("No Section Found")),r)}}},{key:"afterDisplayed",value:function(t){var e=this;t.on(Qt,(function(n,i){return e.triggerMarkEvent(n,i,t.contents)})),this.hooks.render.trigger(t,this).then((function(){t.contents?e.hooks.content.trigger(t.contents,e).then((function(){e.emit(re,t.section,t)})):e.emit(re,t.section,t)}))}},{key:"afterRemoved",value:function(t){var e=this;this.hooks.unloaded.trigger(t,this).then((function(){e.emit(oe,t.section,t)}))}},{key:"onResized",value:function(t,e){this.emit(se,{width:t.width,height:t.height},e),this.location&&this.location.start&&this.display(e||this.location.start.cfi)}},{key:"onOrientationChange",value:function(t){this.emit(ae,t)}},{key:"moveTo",value:function(t){this.manager.moveTo(t)}},{key:"resize",value:function(t,e,n){t&&(this.settings.width=t),e&&(this.settings.height=e),this.manager.resize(t,e,n)}},{key:"clear",value:function(){this.manager.clear()}},{key:"next",value:function(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}},{key:"prev",value:function(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}},{key:"determineLayoutProperties",value:function(t){var e=this.settings.layout||t.layout||"reflowable",n=this.settings.spread||t.spread||"auto",i=this.settings.orientation||t.orientation||"auto",r=this.settings.flow||t.flow||"auto",o=t.viewport||"",s=this.settings.minSpreadWidth||t.minSpreadWidth||800,a=this.settings.direction||t.direction||"ltr";return(0===this.settings.width||this.settings.width>0)&&(0===this.settings.height||this.settings.height),{layout:e,spread:n,orientation:i,flow:r,viewport:o,minSpreadWidth:s,direction:a}}},{key:"flow",value:function(t){var e=t;"scrolled"!==t&&"scrolled-doc"!==t&&"scrolled-continuous"!==t||(e="scrolled"),"auto"!==t&&"paginated"!==t||(e="paginated"),this.settings.flow=t,this._layout&&this._layout.flow(e),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(e),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}},{key:"layout",value:function(t){var e=this;return t&&(this._layout=new He(t),this._layout.spread(t.spread,this.settings.minSpreadWidth),this._layout.on(de,(function(t,n){e.emit(fe,t,n)}))),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}},{key:"spread",value:function(t,e){this.settings.spread=t,e&&(this.settings.minSpreadWidth=e),this._layout&&this._layout.spread(t,e),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}},{key:"direction",value:function(t){this.settings.direction=t||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}},{key:"reportLocation",value:function(){return this.q.enqueue(function(){requestAnimationFrame(function(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then(function(t){var e=this.located(t);e&&e.start&&e.end&&(this.location=e,this.emit(ue,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(le,this.location))}.bind(this));else if(t){var e=this.located(t);if(!e||!e.start||!e.end)return;this.location=e,this.emit(ue,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(le,this.location)}}.bind(this))}.bind(this))}},{key:"currentLocation",value:function(){var t=this.manager.currentLocation();if(t&&t.then&&"function"==typeof t.then)t.then(function(t){return this.located(t)}.bind(this));else if(t)return this.located(t)}},{key:"located",value:function(t){if(!t.length)return{};var e=t[0],n=t[t.length-1],i={start:{index:e.index,href:e.href,cfi:e.mapping.start,displayed:{page:e.pages[0]||1,total:e.totalPages}},end:{index:n.index,href:n.href,cfi:n.mapping.end,displayed:{page:n.pages[n.pages.length-1]||1,total:n.totalPages}}},r=this.book.locations.locationFromCfi(e.mapping.start),o=this.book.locations.locationFromCfi(n.mapping.end);null!=r&&(i.start.location=r,i.start.percentage=this.book.locations.percentageFromLocation(r)),null!=o&&(i.end.location=o,i.end.percentage=this.book.locations.percentageFromLocation(o));var s=this.book.pageList.pageFromCfi(e.mapping.start),a=this.book.pageList.pageFromCfi(n.mapping.end);return-1!=s&&(i.start.page=s),-1!=a&&(i.end.page=a),n.index===this.book.spine.last().index&&i.end.displayed.page>=i.end.displayed.total&&(i.atEnd=!0),e.index===this.book.spine.first().index&&1===i.start.displayed.page&&(i.atStart=!0),i}},{key:"destroy",value:function(){this.manager&&this.manager.destroy(),this.book=void 0}},{key:"passEvents",value:function(t){var e=this;At.forEach((function(n){t.on(n,(function(n){return e.triggerViewEvent(n,t)}))})),t.on(Pt,(function(n){return e.triggerSelectedEvent(n,t)}))}},{key:"triggerViewEvent",value:function(t,e){this.emit(t.type,t,e)}},{key:"triggerSelectedEvent",value:function(t,e){this.emit(ce,t,e)}},{key:"triggerMarkEvent",value:function(t,e,n){this.emit(he,t,e,n)}},{key:"getRange",value:function(t,e){var n=new at(t),i=this.manager.visible().filter((function(t){if(n.spinePos===t.index)return!0}));if(i.length)return i[0].contents.range(n,e)}},{key:"adjustImages",value:function(t){if("pre-paginated"===this._layout.name)return new Promise((function(t){t()}));var e=t.window.getComputedStyle(t.content,null),n=.95*(t.content.offsetHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom))),i=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-i+"px":"100%")+"!important","max-height":n+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise((function(t,e){setTimeout((function(){t()}),1)}))}},{key:"getContents",value:function(){return this.manager?this.manager.getContents():[]}},{key:"views",value:function(){return(this.manager?this.manager.views:void 0)||[]}},{key:"handleLinks",value:function(t){var e=this;t&&t.on(jt,(function(t){var n=e.book.path.relative(t);e.display(n)}))}},{key:"injectStylesheet",value:function(t,e){var n=t.createElement("link");n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),n.setAttribute("href",this.settings.stylesheet),t.getElementsByTagName("head")[0].appendChild(n)}},{key:"injectScript",value:function(t,e){var n=t.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",this.settings.script),n.textContent=" ",t.getElementsByTagName("head")[0].appendChild(n)}},{key:"injectIdentifier",value:function(t,e){var n=this.book.packaging.metadata.identifier,i=t.createElement("meta");i.setAttribute("name","dc.relation.ispartof"),n&&i.setAttribute("content",n),t.getElementsByTagName("head")[0].appendChild(i)}}],n&&Jn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(Qn.prototype);var ti=Qn,ei=n(82156),ni=n.n(ei);function ii(t){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(t)}function ri(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==ii(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==ii(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===ii(r)?r:String(r)),i)}var r}var oi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.zip=void 0,this.urlCache={},this.checkRequirements()}var e,n;return e=t,n=[{key:"checkRequirements",value:function(){try{this.zip=new(ni())}catch(t){throw new Error("JSZip lib not loaded")}}},{key:"open",value:function(t,e){return this.zip.loadAsync(t,{base64:e})}},{key:"openUrl",value:function(t,e){return mt(t,"binary").then(function(t){return this.zip.loadAsync(t,{base64:e})}.bind(this))}},{key:"request",value:function(t,e){var n,i=new q,r=new tt(t);return e||(e=r.extension),(n="blob"==e?this.getBlob(t):this.getText(t))?n.then(function(t){var n=this.handleResponse(t,e);i.resolve(n)}.bind(this)):i.reject({message:"File not found in the epub: "+t,stack:(new Error).stack}),i.promise}},{key:"handleResponse",value:function(t,e){return"json"==e?JSON.parse(t):O(e)?L(t,"text/xml"):"xhtml"==e?L(t,"application/xhtml+xml"):"html"==e||"htm"==e?L(t,"text/html"):t}},{key:"getBlob",value:function(t,e){var n=window.decodeURIComponent(t.substr(1)),i=this.zip.file(n);if(i)return e=e||Re(i.name),i.async("uint8array").then((function(t){return new Blob([t],{type:e})}))}},{key:"getText",value:function(t,e){var n=window.decodeURIComponent(t.substr(1)),i=this.zip.file(n);if(i)return i.async("string").then((function(t){return t}))}},{key:"getBase64",value:function(t,e){var n=window.decodeURIComponent(t.substr(1)),i=this.zip.file(n);if(i)return e=e||Re(i.name),i.async("base64").then((function(t){return"data:"+e+";base64,"+t}))}},{key:"createUrl",value:function(t,e){var n,i,r=new q,o=window.URL||window.webkitURL||window.mozURL,s=e&&e.base64;return t in this.urlCache?(r.resolve(this.urlCache[t]),r.promise):(s?(i=this.getBase64(t))&&i.then(function(e){this.urlCache[t]=e,r.resolve(e)}.bind(this)):(i=this.getBlob(t))&&i.then(function(e){n=o.createObjectURL(e),this.urlCache[t]=n,r.resolve(n)}.bind(this)),i||r.reject({message:"File not found in the epub: "+t,stack:(new Error).stack}),r.promise)}},{key:"revokeUrl",value:function(t){var e=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[t];n&&e.revokeObjectURL(n)}},{key:"destroy",value:function(){var t=window.URL||window.webkitURL||window.mozURL;for(var e in this.urlCache)t.revokeObjectURL(e);this.zip=void 0,this.urlCache={}}}],n&&ri(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),si=oi,ai=n(20927),ui=n.n(ai);function li(t){return li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},li(t)}function hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==li(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==li(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===li(r)?r:String(r)),i)}var r}var ci=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.urlCache={},this.storage=void 0,this.name=e,this.requester=n||mt,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}var e,n;return e=t,n=[{key:"checkRequirements",value:function(){try{var t;void 0===ui()&&(t=ui()),this.storage=t.createInstance({name:this.name})}catch(t){throw new Error("localForage lib not loaded")}}},{key:"addListeners",value:function(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}},{key:"removeListeners",value:function(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}},{key:"status",value:function(t){var e=navigator.onLine;this.online=e,e?this.emit("online",this):this.emit("offline",this)}},{key:"add",value:function(t,e){var n=this,i=t.resources.map((function(t){var i=t.href,r=n.resolver(i),o=window.encodeURIComponent(r);return n.storage.getItem(o).then((function(t){return!t||e?n.requester(r,"binary").then((function(t){return n.storage.setItem(o,t)})):t}))}));return Promise.all(i)}},{key:"put",value:function(t,e,n){var i=this,r=window.encodeURIComponent(t);return this.storage.getItem(r).then((function(o){return o||i.requester(t,"binary",e,n).then((function(t){return i.storage.setItem(r,t)}))}))}},{key:"request",value:function(t,e,n,i){var r=this;return this.online?this.requester(t,e,n,i).then((function(e){return r.put(t),e})):this.retrieve(t,e)}},{key:"retrieve",value:function(t,e){var n=this,i=(new q,new tt(t));return e||(e=i.extension),("blob"==e?this.getBlob(t):this.getText(t)).then((function(i){var r,o=new q;return i?(r=n.handleResponse(i,e),o.resolve(r)):o.reject({message:"File not found in storage: "+t,stack:(new Error).stack}),o.promise}))}},{key:"handleResponse",value:function(t,e){return"json"==e?JSON.parse(t):O(e)?L(t,"text/xml"):"xhtml"==e?L(t,"application/xhtml+xml"):"html"==e||"htm"==e?L(t,"text/html"):t}},{key:"getBlob",value:function(t,e){var n=window.encodeURIComponent(t);return this.storage.getItem(n).then((function(n){if(n)return e=e||Re(t),new Blob([n],{type:e})}))}},{key:"getText",value:function(t,e){var n=window.encodeURIComponent(t);return e=e||Re(t),this.storage.getItem(n).then((function(t){var n,i=new q,r=new FileReader;if(t)return n=new Blob([t],{type:e}),r.addEventListener("loadend",(function(){i.resolve(r.result)})),r.readAsText(n,e),i.promise}))}},{key:"getBase64",value:function(t,e){var n=window.encodeURIComponent(t);return e=e||Re(t),this.storage.getItem(n).then((function(t){var n,i=new q,r=new FileReader;if(t)return n=new Blob([t],{type:e}),r.addEventListener("loadend",(function(){i.resolve(r.result)})),r.readAsDataURL(n,e),i.promise}))}},{key:"createUrl",value:function(t,e){var n,i,r=new q,o=window.URL||window.webkitURL||window.mozURL,s=e&&e.base64;return t in this.urlCache?(r.resolve(this.urlCache[t]),r.promise):(s?(i=this.getBase64(t))&&i.then(function(e){this.urlCache[t]=e,r.resolve(e)}.bind(this)):(i=this.getBlob(t))&&i.then(function(e){n=o.createObjectURL(e),this.urlCache[t]=n,r.resolve(n)}.bind(this)),i||r.reject({message:"File not found in storage: "+t,stack:(new Error).stack}),r.promise)}},{key:"revokeUrl",value:function(t){var e=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[t];n&&e.revokeObjectURL(n)}},{key:"destroy",value:function(){var t=window.URL||window.webkitURL||window.mozURL;for(var e in this.urlCache)t.revokeObjectURL(e);this.urlCache={},this.removeListeners()}}],n&&hi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(ci.prototype);var fi=ci;function di(t){return di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},di(t)}function pi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==di(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==di(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===di(r)?r:String(r)),i)}var r}var vi=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}var e,n;return e=t,(n=[{key:"parse",value:function(t){var e=this;if(!t)return this;var n=j(t,"display_options");return n?(B(n,"option").forEach((function(t){var n="";switch(t.childNodes.length&&(n=t.childNodes[0].nodeValue),t.attributes.name.value){case"interactive":e.interactive=n;break;case"fixed-layout":e.fixedLayout=n;break;case"open-to-spread":e.openToSpread=n;break;case"orientation-lock":e.orientationLock=n}})),this):this}},{key:"destroy",value:function(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}])&&pi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function mi(t){return mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mi(t)}function gi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==mi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!==mi(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key,"string"),"symbol"===mi(r)?r:String(r)),i)}var r}var yi="META-INF/container.xml",bi="binary",wi="base64",_i="epub",ki="json",xi=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===n&&"string"!=typeof e&&e instanceof Blob==0&&e instanceof ArrayBuffer==0&&(n=e,e=void 0),this.settings=y(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),y(this.settings,n),this.opening=new q,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new q,spine:new q,metadata:new q,cover:new q,navigation:new q,pageList:new q,resources:new q,displayOptions:new q},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||mt,this.spine=new St,this.locations=new be(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch((function(t){var n=new Error("Cannot load book at "+e);i.emit(It,n)}))}var e,n;return e=t,n=[{key:"open",value:function(t,e){var n,i=e||this.determineType(t);return i===bi?(this.archived=!0,this.url=new it("/",""),n=this.openEpub(t)):i===wi?(this.archived=!0,this.url=new it("/",""),n=this.openEpub(t,i)):i===_i?(this.archived=!0,this.url=new it("/",""),n=this.request(t,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):"opf"==i?(this.url=new it(t),n=this.openPackaging(this.url.Path.toString())):i==ki?(this.url=new it(t),n=this.openManifest(this.url.Path.toString())):(this.url=new it(t),n=this.openContainer(yi).then(this.openPackaging.bind(this))),n}},{key:"openEpub",value:function(t,e){var n=this;return this.unarchive(t,e||this.settings.encoding).then((function(){return n.openContainer(yi)})).then((function(t){return n.openPackaging(t)}))}},{key:"openContainer",value:function(t){var e=this;return this.load(t).then((function(t){return e.container=new ke(t),e.resolve(e.container.packagePath)}))}},{key:"openPackaging",value:function(t){var e=this;return this.path=new tt(t),this.load(t).then((function(t){return e.packaging=new Ce(t),e.unpack(e.packaging)}))}},{key:"openManifest",value:function(t){var e=this;return this.path=new tt(t),this.load(t).then((function(t){return e.packaging=new Ce,e.packaging.load(t),e.unpack(e.packaging)}))}},{key:"load",value:function(t){var e=this.resolve(t);return this.archived?this.archive.request(e):this.request(e,null,this.settings.requestCredentials,this.settings.requestHeaders)}},{key:"resolve",value:function(t,e){if(t){var n=t;return t.indexOf("://")>-1?t:(this.path&&(n=this.path.resolve(t)),0!=e&&this.url&&(n=this.url.resolve(n)),n)}}},{key:"canonical",value:function(t){return t?this.settings.canonical?this.settings.canonical(t):this.resolve(t,!0):""}},{key:"determineType",value:function(t){var e;return"base64"===this.settings.encoding?wi:"string"!=typeof t?bi:((e=new it(t).path().extension)&&(e=e.replace(/\?.*$/,"")),e?"epub"===e?_i:"opf"===e?"opf":"json"===e?ki:void 0:"directory")}},{key:"unpack",value:function(t){var e=this;this.package=t,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then((function(t){e.displayOptions=new vi(t),e.loading.displayOptions.resolve(e.displayOptions)})).catch((function(t){e.displayOptions=new vi,e.loading.displayOptions.resolve(e.displayOptions)})):(this.displayOptions=new vi,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new Be(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then((function(){e.loading.navigation.resolve(e.navigation)})),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then((function(){e.loaded.displayOptions.then((function(){e.opening.resolve(e)}))})).catch((function(t){console.error(t)})):this.loaded.displayOptions.then((function(){e.opening.resolve(e)}))}},{key:"loadNavigation",value:function(t){var e=this,n=t.navPath||t.ncxPath,i=t.toc;return i?new Promise((function(n,r){e.navigation=new Ae(i),t.pageList&&(e.pageList=new Me(t.pageList)),n(e.navigation)})):n?this.load(n,"xml").then((function(t){return e.navigation=new Ae(t),e.pageList=new Me(t),e.navigation})):new Promise((function(t,n){e.navigation=new Ae,e.pageList=new Me,t(e.navigation)}))}},{key:"section",value:function(t){return this.spine.get(t)}},{key:"renderTo",value:function(t,e){return this.rendition=new ti(this,e),this.rendition.attachTo(t),this.rendition}},{key:"setRequestCredentials",value:function(t){this.settings.requestCredentials=t}},{key:"setRequestHeaders",value:function(t){this.settings.requestHeaders=t}},{key:"unarchive",value:function(t,e){return this.archive=new si,this.archive.open(t,e)}},{key:"store",value:function(t){var e=this,n=this.settings.replacements&&"none"!==this.settings.replacements,i=this.url,r=this.settings.requestMethod||mt.bind(this);return this.storage=new fi(t,r,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then((function(){e.archived&&(e.storage.requester=e.archive.request.bind(e.archive));var t=function(t,n){n.output=e.resources.substitute(t,n.url)};e.resources.settings.replacements=n||"blobUrl",e.resources.replacements().then((function(){return e.resources.replaceCss()})),e.storage.on("offline",(function(){e.url=new it("/",""),e.spine.hooks.serialize.register(t)})),e.storage.on("online",(function(){e.url=i,e.spine.hooks.serialize.deregister(t)}))})),this.storage}},{key:"coverUrl",value:function(){var t=this;return this.loaded.cover.then((function(){return t.cover?t.archived?t.archive.createUrl(t.cover):t.cover:null}))}},{key:"replacements",value:function(){var t=this;return this.spine.hooks.serialize.register((function(e,n){n.output=t.resources.substitute(e,n.url)})),this.resources.replacements().then((function(){return t.resources.replaceCss()}))}},{key:"getRange",value:function(t){var e=new at(t),n=this.spine.get(e.spinePos),i=this.load.bind(this);return n?n.load(i).then((function(t){return e.toRange(n.document)})):new Promise((function(t,e){e("CFI could not be found")}))}},{key:"key",value:function(t){var e=t||this.packaging.metadata.identifier||this.url.filename;return"epubjs:".concat(Ot,":").concat(e)}},{key:"destroy",value:function(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}],n&&gi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();o()(xi.prototype);var Si=xi;function Ei(t,e){return new Si(t,e)}Ei.VERSION=Ot,void 0!==n.g&&(n.g.EPUBJS_VERSION=Ot),Ei.Book=Si,Ei.Rendition=ti,Ei.Contents=an,Ei.CFI=at,Ei.utils=i;var Ci=Ei},87296:function(t,e,n){"use strict";var i=n(51102),r=n(42307),o=n(34339),s=n(83957),a=n(83246),u=t.exports=function(t,e){var n,r,u,l,h;return arguments.length<2||"string"!=typeof t?(l=e,e=t,t=null):l=arguments[2],i(t)?(n=a.call(t,"c"),r=a.call(t,"e"),u=a.call(t,"w")):(n=u=!0,r=!1),h={value:e,configurable:n,enumerable:r,writable:u},l?o(s(l),h):h};u.gs=function(t,e,n){var u,l,h,c;return"string"!=typeof t?(h=n,n=e,e=t,t=null):h=arguments[3],i(e)?r(e)?i(n)?r(n)||(h=n,n=void 0):n=void 0:(h=e,e=n=void 0):e=void 0,i(t)?(u=a.call(t,"c"),l=a.call(t,"e")):(u=!0,l=!1),c={get:e,set:n,configurable:u,enumerable:l},h?o(s(h),c):c}},20817:function(t){"use strict";t.exports=function(){}},34339:function(t,e,n){"use strict";t.exports=n(41994)()?Object.assign:n(30963)},41994:function(t){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(e(t={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},30963:function(t,e,n){"use strict";var i=n(53450),r=n(1836),o=Math.max;t.exports=function(t,e){var n,s,a,u=o(arguments.length,2);for(t=Object(r(t)),a=function(i){try{t[i]=e[i]}catch(t){n||(n=t)}},s=1;s<u;++s)i(e=arguments[s]).forEach(a);if(void 0!==n)throw n;return t}},58349:function(t,e,n){"use strict";var i=n(20817)();t.exports=function(t){return t!==i&&null!==t}},53450:function(t,e,n){"use strict";t.exports=n(33446)()?Object.keys:n(19177)},33446:function(t){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},19177:function(t,e,n){"use strict";var i=n(58349),r=Object.keys;t.exports=function(t){return r(i(t)?Object(t):t)}},83957:function(t,e,n){"use strict";var i=n(58349),r=Array.prototype.forEach,o=Object.create,s=function(t,e){var n;for(n in t)e[n]=t[n]};t.exports=function(t){var e=o(null);return r.call(arguments,(function(t){i(t)&&s(Object(t),e)})),e}},79:function(t){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},1836:function(t,e,n){"use strict";var i=n(58349);t.exports=function(t){if(!i(t))throw new TypeError("Cannot use null or undefined");return t}},83246:function(t,e,n){"use strict";t.exports=n(68711)()?String.prototype.contains:n(12370)},68711:function(t){"use strict";var e="razdwatrzy";t.exports=function(){return"function"==typeof e.contains&&!0===e.contains("dwa")&&!1===e.contains("foo")}},12370:function(t){"use strict";var e=String.prototype.indexOf;t.exports=function(t){return e.call(this,t,arguments[1])>-1}},58709:function(t,e,n){"use strict";var i,r,o,s,a,u,l,h=n(87296),c=n(79),f=Function.prototype.apply,d=Function.prototype.call,p=Object.create,v=Object.defineProperty,m=Object.defineProperties,g=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};r=function(t,e){var n,r;return c(e),r=this,i.call(this,t,n=function(){o.call(r,t,n),f.call(e,this,arguments)}),n.__eeOnceListener__=e,this},s=function(t){var e,n,i,r,o;if(g.call(this,"__ee__")&&(r=this.__ee__[t]))if("object"==typeof r){for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];for(r=r.slice(),e=0;i=r[e];++e)f.call(i,this,o)}else switch(arguments.length){case 1:d.call(r,this);break;case 2:d.call(r,this,arguments[1]);break;case 3:d.call(r,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),e=1;e<n;++e)o[e-1]=arguments[e];f.call(r,this,o)}},a={on:i=function(t,e){var n;return c(e),g.call(this,"__ee__")?n=this.__ee__:(n=y.value=p(null),v(this,"__ee__",y),y.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},once:r,off:o=function(t,e){var n,i,r,o;if(c(e),!g.call(this,"__ee__"))return this;if(!(n=this.__ee__)[t])return this;if("object"==typeof(i=n[t]))for(o=0;r=i[o];++o)r!==e&&r.__eeOnceListener__!==e||(2===i.length?n[t]=i[o?0:1]:i.splice(o,1));else i!==e&&i.__eeOnceListener__!==e||delete n[t];return this},emit:s},u={on:h(i),once:h(r),off:h(o),emit:h(s)},l=m({},u),t.exports=e=function(t){return null==t?p(l):m(Object(t),u)},e.methods=a},82156:function(t,e,n){t.exports=function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,(function(t){return r(e[s][1][t]||t)}),l,l.exports,t,e,n,i)}return n[s].exports}for(var o=void 0,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){"use strict";var i=t("./utils"),r=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t){for(var e,n,r,s,a,u,l,h=[],c=0,f=t.length,d=f,p="string"!==i.getTypeOf(t);c<t.length;)d=f-c,p?(e=t[c++],n=c<f?t[c++]:0,r=c<f?t[c++]:0):(e=t.charCodeAt(c++),n=c<f?t.charCodeAt(c++):0,r=c<f?t.charCodeAt(c++):0),s=e>>2,a=(3&e)<<4|n>>4,u=d>1?(15&n)<<2|r>>6:64,l=d>2?63&r:64,h.push(o.charAt(s)+o.charAt(a)+o.charAt(u)+o.charAt(l));return h.join("")},n.decode=function(t){var e,n,i,s,a,u,l=0,h=0,c="data:";if(t.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var f,d=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===o.charAt(64)&&d--,t.charAt(t.length-2)===o.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(f=r.uint8array?new Uint8Array(0|d):new Array(0|d);l<t.length;)e=o.indexOf(t.charAt(l++))<<2|(s=o.indexOf(t.charAt(l++)))>>4,n=(15&s)<<4|(a=o.indexOf(t.charAt(l++)))>>2,i=(3&a)<<6|(u=o.indexOf(t.charAt(l++))),f[h++]=e,64!==a&&(f[h++]=n),64!==u&&(f[h++]=i);return f}},{"./support":30,"./utils":32}],2:[function(t,e,n){"use strict";var i=t("./external"),r=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),s=t("./stream/DataLengthProbe");function a(t,e,n,i,r){this.compressedSize=t,this.uncompressedSize=e,this.crc32=n,this.compression=i,this.compressedContent=r}a.prototype={getContentWorker:function(){var t=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(t,e,n){return t.pipe(new o).pipe(new s("uncompressedSize")).pipe(e.compressWorker(n)).pipe(new s("compressedSize")).withStreamInfo("compression",e)},e.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,n){"use strict";var i=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(t){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,n){"use strict";var i=t("./utils");var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==i.getTypeOf(t)?function(t,e,n,i){var o=r,s=i+n;t^=-1;for(var a=i;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}(0|e,t,t.length,0):function(t,e,n,i){var o=r,s=i+n;t^=-1;for(var a=i;a<s;a++)t=t>>>8^o[255&(t^e.charCodeAt(a))];return-1^t}(0|e,t,t.length,0):0}},{"./utils":32}],5:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,e,n){"use strict";var i;i="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=t("pako"),o=t("./utils"),s=t("./stream/GenericWorker"),a=i?"uint8array":"array";function u(t,e){s.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}n.magic="\b\0",o.inherits(u,s),u.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(a,t.data),!1)},u.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},n.compressWorker=function(t){return new u("Deflate",t)},n.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,n){"use strict";var i=t("../utils"),r=t("../stream/GenericWorker"),o=t("../utf8"),s=t("../crc32"),a=t("../signature"),u=function(t,e){var n,i="";for(n=0;n<e;n++)i+=String.fromCharCode(255&t),t>>>=8;return i},l=function(t,e,n,r,l,h){var c,f,d=t.file,p=t.compression,v=h!==o.utf8encode,m=i.transformTo("string",h(d.name)),g=i.transformTo("string",o.utf8encode(d.name)),y=d.comment,b=i.transformTo("string",h(y)),w=i.transformTo("string",o.utf8encode(y)),_=g.length!==d.name.length,k=w.length!==y.length,x="",S="",E="",C=d.dir,T=d.date,N={crc32:0,compressedSize:0,uncompressedSize:0};e&&!n||(N.crc32=t.crc32,N.compressedSize=t.compressedSize,N.uncompressedSize=t.uncompressedSize);var O=0;e&&(O|=8),v||!_&&!k||(O|=2048);var A,I,z,R=0,P=0;C&&(R|=16),"UNIX"===l?(P=798,R|=(A=d.unixPermissions,I=C,z=A,A||(z=I?16893:33204),(65535&z)<<16)):(P=20,R|=63&(d.dosPermissions||0)),c=T.getUTCHours(),c<<=6,c|=T.getUTCMinutes(),c<<=5,c|=T.getUTCSeconds()/2,f=T.getUTCFullYear()-1980,f<<=4,f|=T.getUTCMonth()+1,f<<=5,f|=T.getUTCDate(),_&&(S=u(1,1)+u(s(m),4)+g,x+="up"+u(S.length,2)+S),k&&(E=u(1,1)+u(s(b),4)+w,x+="uc"+u(E.length,2)+E);var L="";return L+="\n\0",L+=u(O,2),L+=p.magic,L+=u(c,2),L+=u(f,2),L+=u(N.crc32,4),L+=u(N.compressedSize,4),L+=u(N.uncompressedSize,4),L+=u(m.length,2),L+=u(x.length,2),{fileRecord:a.LOCAL_FILE_HEADER+L+m+x,dirRecord:a.CENTRAL_FILE_HEADER+u(P,2)+L+u(b.length,2)+"\0\0\0\0"+u(R,4)+u(r,4)+m+x+b}},h=function(t){return a.DATA_DESCRIPTOR+u(t.crc32,4)+u(t.compressedSize,4)+u(t.uncompressedSize,4)};function c(t,e,n,i){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(c,r),c.prototype.push=function(t){var e=t.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,r.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:n?(e+100*(n-i-1))/n:100}}))},c.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var n=l(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,n=l(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),e)this.push({data:h(t),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var n=this.bytesWritten-t,r=function(t,e,n,r,o){var s=i.transformTo("string",o(r));return a.CENTRAL_DIRECTORY_END+"\0\0\0\0"+u(t,2)+u(t,2)+u(e,4)+u(n,4)+u(s.length,2)+s}(this.dirRecords.length,n,t,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},c.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(t){var e=this._sources;if(!r.prototype.error.call(this,t))return!1;for(var n=0;n<e.length;n++)try{e[n].error(t)}catch(t){}return!0},c.prototype.lock=function(){r.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,n){"use strict";var i=t("../compressions"),r=t("./ZipFileWorker");n.generateWorker=function(t,e,n){var o=new r(e.streamFiles,n,e.platform,e.encodeFileName),s=0;try{t.forEach((function(t,n){s++;var r=function(t,e){var n=t||e,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r}(n.options.compression,e.compression),a=n.options.compressionOptions||e.compressionOptions||{},u=n.dir,l=n.date;n._compressWorker(r,a).withStreamInfo("file",{name:t,dir:u,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=s}catch(t){o.error(t)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}i.prototype=t("./object"),i.prototype.loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.7.1",i.loadAsync=function(t,e){return(new i).loadAsync(t,e)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,n){"use strict";var i=t("./utils"),r=t("./external"),o=t("./utf8"),s=t("./zipEntries"),a=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function l(t){return new r.Promise((function(e,n){var i=t.decompressed.getContentWorker().pipe(new a);i.on("error",(function(t){n(t)})).on("end",(function(){i.streamInfo.crc32!==t.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var n=this;return e=i.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(t)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var n=new s(e);return n.load(t),n})).then((function(t){var n=[r.Promise.resolve(t)],i=t.files;if(e.checkCRC32)for(var o=0;o<i.length;o++)n.push(l(i[o]));return r.Promise.all(n)})).then((function(t){for(var i=t.shift(),r=i.files,o=0;o<r.length;o++){var s=r[o];n.file(s.fileNameStr,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:e.createFolders})}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,n){"use strict";var i=t("../utils"),r=t("../stream/GenericWorker");function o(t,e){r.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}i.inherits(o,r),o.prototype._bindStream=function(t){var e=this;this._stream=t,t.pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},o.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,n){"use strict";var i=t("readable-stream").Readable;function r(t,e,n){i.call(this,e),this._helper=t;var r=this;t.on("data",(function(t,e){r.push(t)||r._helper.pause(),n&&n(e)})).on("error",(function(t){r.emit("error",t)})).on("end",(function(){r.push(null)}))}t("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},e.exports=r},{"../utils":32,"readable-stream":16}],14:[function(t,e,n){"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,n){"use strict";var i=t("./utf8"),r=t("./utils"),o=t("./stream/GenericWorker"),s=t("./stream/StreamHelper"),a=t("./defaults"),u=t("./compressedObject"),l=t("./zipObject"),h=t("./generate"),c=t("./nodejsUtils"),f=t("./nodejs/NodejsStreamInputAdapter"),d=function(t,e,n){var i,s=r.getTypeOf(e),h=r.extend(n||{},a);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),"string"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(t=v(t)),h.createFolders&&(i=p(t))&&m.call(this,i,!0);var d="string"===s&&!1===h.binary&&!1===h.base64;n&&void 0!==n.binary||(h.binary=!d),(e instanceof u&&0===e.uncompressedSize||h.dir||!e||0===e.length)&&(h.base64=!1,h.binary=!0,e="",h.compression="STORE",s="string");var g;g=e instanceof u||e instanceof o?e:c.isNode&&c.isStream(e)?new f(t,e):r.prepareContent(t,e,h.binary,h.optimizedBinaryString,h.base64);var y=new l(t,g,h);this.files[t]=y},p=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},v=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},m=function(t,e){return e=void 0!==e?e:a.createFolders,t=v(t),this.files[t]||d.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function g(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,n,i;for(e in this.files)i=this.files[e],(n=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(n,i)},filter:function(t){var e=[];return this.forEach((function(n,i){t(n,i)&&e.push(i)})),e},file:function(t,e,n){if(1===arguments.length){if(g(t)){var i=t;return this.filter((function(t,e){return!e.dir&&i.test(t)}))}var r=this.files[this.root+t];return r&&!r.dir?r:null}return t=this.root+t,d.call(this,t,e,n),this},folder:function(t){if(!t)return this;if(g(t))return this.filter((function(e,n){return n.dir&&t.test(e)}));var e=this.root+t,n=m.call(this,e),i=this.clone();return i.root=n.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter((function(e,n){return n.name.slice(0,t.length)===t})),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,n={};try{if((n=r.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");r.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var a=n.comment||this.comment||"";e=h.generateWorker(this,n,a)}catch(t){(e=new o("error")).error(t)}return new s(e,n.type||"string",n.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,n){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,n){"use strict";var i=t("./DataReader");function r(t){i.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(r,i),r.prototype.byteAt=function(t){return this.data[this.zero+t]},r.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===i&&this.data[o+3]===r)return o-this.zero;return-1},r.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),r=t.charCodeAt(3),o=this.readData(4);return e===o[0]&&n===o[1]&&i===o[2]&&r===o[3]},r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./DataReader":18}],18:[function(t,e,n){"use strict";var i=t("../utils");function r(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=r},{"../utils":32}],19:[function(t,e,n){"use strict";var i=t("./Uint8ArrayReader");function r(t){i.call(this,t)}t("../utils").inherits(r,i),r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,n){"use strict";var i=t("./DataReader");function r(t){i.call(this,t)}t("../utils").inherits(r,i),r.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},r.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},r.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},r.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./DataReader":18}],21:[function(t,e,n){"use strict";var i=t("./ArrayReader");function r(t){i.call(this,t)}t("../utils").inherits(r,i),r.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,n){"use strict";var i=t("../utils"),r=t("../support"),o=t("./ArrayReader"),s=t("./StringReader"),a=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");e.exports=function(t){var e=i.getTypeOf(t);return i.checkSupport(e),"string"!==e||r.uint8array?"nodebuffer"===e?new a(t):r.uint8array?new u(i.transformTo("uint8array",t)):new o(i.transformTo("array",t)):new s(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,n){"use strict";var i=t("./GenericWorker"),r=t("../utils");function o(t){i.call(this,"ConvertWorker to "+t),this.destType=t}r.inherits(o,i),o.prototype.processChunk=function(t){this.push({data:r.transformTo(this.destType,t.data),meta:t.meta})},e.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,n){"use strict";var i=t("./GenericWorker"),r=t("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,i),o.prototype.processChunk=function(t){this.streamInfo.crc32=r(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,n){"use strict";var i=t("../utils"),r=t("./GenericWorker");function o(t){r.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}i.inherits(o,r),o.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}r.prototype.processChunk.call(this,t)},e.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,n){"use strict";var i=t("../utils"),r=t("./GenericWorker");function o(t){r.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=i.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}i.inherits(o,r),o.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,n){"use strict";function i(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var n=0;n<this._listeners[t].length;n++)this._listeners[t][n].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=i},{}],29:[function(t,e,n){"use strict";var i=t("../utils"),r=t("./ConvertWorker"),o=t("./GenericWorker"),s=t("../base64"),a=t("../support"),u=t("../external"),l=null;if(a.nodestream)try{l=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function h(t,e){return new u.Promise((function(n,r){var o=[],a=t._internalType,u=t._outputType,l=t._mimeType;t.on("data",(function(t,n){o.push(t),e&&e(n)})).on("error",(function(t){o=[],r(t)})).on("end",(function(){try{var t=function(t,e,n){switch(t){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),n);case"base64":return s.encode(e);default:return i.transformTo(t,e)}}(u,function(t,e){var n,i=0,r=null,o=0;for(n=0;n<e.length;n++)o+=e[n].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(r=new Uint8Array(o),n=0;n<e.length;n++)r.set(e[n],i),i+=e[n].length;return r;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(a,o),l);n(t)}catch(t){r(t)}o=[]})).resume()}))}function c(t,e,n){var s=e;switch(e){case"blob":case"arraybuffer":s="uint8array";break;case"base64":s="string"}try{this._internalType=s,this._outputType=e,this._mimeType=n,i.checkSupport(s),this._worker=t.pipe(new r(s)),t.lock()}catch(t){this._worker=new o("error"),this._worker.error(t)}}c.prototype={accumulate:function(t){return h(this,t)},on:function(t,e){var n=this;return"data"===t?this._worker.on(t,(function(t){e.call(n,t.data,t.meta)})):this._worker.on(t,(function(){i.delay(e,arguments,n)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(t){n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch(t){n.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,n){"use strict";for(var i=t("./utils"),r=t("./support"),o=t("./nodejsUtils"),s=t("./stream/GenericWorker"),a=new Array(256),u=0;u<256;u++)a[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;a[254]=a[254]=1;function l(){s.call(this,"utf-8 decode"),this.leftOver=null}function h(){s.call(this,"utf-8 encode")}n.utf8encode=function(t){return r.nodebuffer?o.newBufferFrom(t,"utf-8"):function(t){var e,n,i,o,s,a=t.length,u=0;for(o=0;o<a;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),u+=n<128?1:n<2048?2:n<65536?3:4;for(e=r.uint8array?new Uint8Array(u):new Array(u),s=0,o=0;s<u;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e}(t)},n.utf8decode=function(t){return r.nodebuffer?i.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,n,r,o,s=t.length,u=new Array(2*s);for(n=0,e=0;e<s;)if((r=t[e++])<128)u[n++]=r;else if((o=a[r])>4)u[n++]=65533,e+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&e<s;)r=r<<6|63&t[e++],o--;o>1?u[n++]=65533:r<65536?u[n++]=r:(r-=65536,u[n++]=55296|r>>10&1023,u[n++]=56320|1023&r)}return u.length!==n&&(u.subarray?u=u.subarray(0,n):u.length=n),i.applyFromCharCode(u)}(t=i.transformTo(r.uint8array?"uint8array":"array",t))},i.inherits(l,s),l.prototype.processChunk=function(t){var e=i.transformTo(r.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var o=e;(e=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),e.set(o,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var s=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+a[t[n]]>e?n:e}(e),u=e;s!==e.length&&(r.uint8array?(u=e.subarray(0,s),this.leftOver=e.subarray(s,e.length)):(u=e.slice(0,s),this.leftOver=e.slice(s,e.length))),this.push({data:n.utf8decode(u),meta:t.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=l,i.inherits(h,s),h.prototype.processChunk=function(t){this.push({data:n.utf8encode(t.data),meta:t.meta})},n.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,n){"use strict";var i=t("./support"),r=t("./base64"),o=t("./nodejsUtils"),s=t("set-immediate-shim"),a=t("./external");function u(t){return t}function l(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}n.newBlob=function(t,e){n.checkSupport("blob");try{return new Blob([t],{type:e})}catch(n){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(t),i.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(t,e,n){var i=[],r=0,o=t.length;if(o<=n)return String.fromCharCode.apply(null,t);for(;r<o;)"array"===e||"nodebuffer"===e?i.push(String.fromCharCode.apply(null,t.slice(r,Math.min(r+n,o)))):i.push(String.fromCharCode.apply(null,t.subarray(r,Math.min(r+n,o)))),r+=n;return i.join("")},stringifyByChar:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(t){return!1}}()}};function c(t){var e=65536,i=n.getTypeOf(t),r=!0;if("uint8array"===i?r=h.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=h.applyCanBeUsed.nodebuffer),r)for(;e>1;)try{return h.stringifyByChunk(t,i,e)}catch(t){e=Math.floor(e/2)}return h.stringifyByChar(t)}function f(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}n.applyFromCharCode=c;var d={};d.string={string:u,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return d.string.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:function(t){return l(t,o.allocBuffer(t.length))}},d.array={string:c,array:u,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return o.newBufferFrom(t)}},d.arraybuffer={string:function(t){return c(new Uint8Array(t))},array:function(t){return f(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:u,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return o.newBufferFrom(new Uint8Array(t))}},d.uint8array={string:c,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:u,nodebuffer:function(t){return o.newBufferFrom(t)}},d.nodebuffer={string:c,array:function(t){return f(t,new Array(t.length))},arraybuffer:function(t){return d.nodebuffer.uint8array(t).buffer},uint8array:function(t){return f(t,new Uint8Array(t.length))},nodebuffer:u},n.transformTo=function(t,e){if(e||(e=""),!t)return e;n.checkSupport(t);var i=n.getTypeOf(e);return d[i][t](e)},n.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":i.nodebuffer&&o.isBuffer(t)?"nodebuffer":i.uint8array&&t instanceof Uint8Array?"uint8array":i.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(t){if(!i[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(t){var e,n,i="";for(n=0;n<(t||"").length;n++)i+="\\x"+((e=t.charCodeAt(n))<16?"0":"")+e.toString(16).toUpperCase();return i},n.delay=function(t,e,n){s((function(){t.apply(n||null,e||[])}))},n.inherits=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n},n.extend=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===n[e]&&(n[e]=arguments[t][e]);return n},n.prepareContent=function(t,e,o,s,u){return a.Promise.resolve(e).then((function(t){return i.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new a.Promise((function(e,n){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(t){n(t.target.error)},i.readAsArrayBuffer(t)})):t})).then((function(e){var h,c=n.getTypeOf(e);return c?("arraybuffer"===c?e=n.transformTo("uint8array",e):"string"===c&&(u?e=r.decode(e):o&&!0!==s&&(e=l(h=e,i.uint8array?new Uint8Array(h.length):new Array(h.length)))),e):a.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,n){"use strict";var i=t("./reader/readerFor"),r=t("./utils"),o=t("./signature"),s=t("./zipEntry"),a=(t("./utf8"),t("./support"));function u(t){this.files=[],this.loadOptions=t}u.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(e)+", expected "+r.pretty(t)+")")}},isSignature:function(t,e){var n=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=a.uint8array?"uint8array":"array",n=r.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(t=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=e-n;if(i>0)this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){this.reader=i(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,n){"use strict";var i=t("./reader/readerFor"),r=t("./utils"),o=t("./compressedObject"),s=t("./crc32"),a=t("./utf8"),u=t("./compressions"),l=t("./support");function h(t,e){this.options=t,this.loadOptions=e}h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,n;if(t.skip(22),this.fileNameLength=t.readInt(2),n=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in u)if(u.hasOwnProperty(e)&&u[e].magic===t)return u[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,n,i,r=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<r;)e=t.readInt(2),n=t.readInt(2),i=t.readData(n),this.extraFields[e]={id:e,length:n,value:i};t.setIndex(r)},handleUTF8:function(){var t=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var n=r.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var o=r.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=i(t.value);return 1!==e.readInt(1)||s(this.fileName)!==e.readInt(4)?null:a.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=i(t.value);return 1!==e.readInt(1)||s(this.fileComment)!==e.readInt(4)?null:a.utf8decode(e.readData(t.length-5))}return null}},e.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,n){"use strict";var i=t("./stream/StreamHelper"),r=t("./stream/DataWorker"),o=t("./utf8"),s=t("./compressedObject"),a=t("./stream/GenericWorker"),u=function(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};u.prototype={internalStream:function(t){var e=null,n="string";try{if(!t)throw new Error("No output type specified.");var r="string"===(n=t.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),e=this._decompressWorker();var s=!this._dataBinary;s&&!r&&(e=e.pipe(new o.Utf8EncodeWorker)),!s&&r&&(e=e.pipe(new o.Utf8DecodeWorker))}catch(t){(e=new a("error")).error(t)}return new i(e,n,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof s&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(n,t,e)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof a?this._data:new r(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<l.length;c++)u.prototype[l[c]]=h;e.exports=u},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,i){(function(t){"use strict";var n,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var o=0,s=new r(h),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var u=new t.MessageChannel;u.port1.onmessage=h,n=function(){u.port2.postMessage(0)}}var l=[];function h(){var t,e;i=!0;for(var n=l.length;n;){for(e=l,l=[],t=-1;++t<n;)e[t]();n=l.length}i=!1}e.exports=function(t){1!==l.push(t)||i||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,n){"use strict";var i=t("immediate");function r(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function l(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==r&&d(this,t)}function h(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function c(t,e,n){i((function(){var i;try{i=e(n)}catch(e){return o.reject(t,e)}i===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,i)}))}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var n=!1;function i(e){n||(n=!0,o.reject(t,e))}function r(e){n||(n=!0,o.resolve(t,e))}var s=p((function(){e(r,i)}));"error"===s.status&&i(s.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=l,l.prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))}))},l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var n=new this.constructor(r);return this.state!==u?c(n,this.state===a?t:e,this.outcome):this.queue.push(new h(n,t,e)),n},h.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){c(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){o.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){c(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=p(f,e);if("error"===n.status)return o.reject(t,n.value);var i=n.value;if(i)d(t,i);else{t.state=a,t.outcome=e;for(var r=-1,s=t.queue.length;++r<s;)t.queue[r].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},l.resolve=function(t){return t instanceof this?t:o.resolve(new this(r),t)},l.reject=function(t){var e=new this(r);return o.reject(e,t)},l.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,l=new this(r);++u<n;)h(t[u],u);return l;function h(t,r){e.resolve(t).then((function(t){s[r]=t,++a!==n||i||(i=!0,o.resolve(l,s))}),(function(t){i||(i=!0,o.reject(l,t))}))}},l.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n,i=t.length,s=!1;if(!i)return this.resolve([]);for(var a=-1,u=new this(r);++a<i;)n=t[a],e.resolve(n).then((function(t){s||(s=!0,o.resolve(u,t))}),(function(t){s||(s=!0,o.reject(u,t))}));return u}},{immediate:36}],38:[function(t,e,n){"use strict";var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,n){"use strict";var i=t("./zlib/deflate"),r=t("./utils/common"),o=t("./utils/strings"),s=t("./zlib/messages"),a=t("./zlib/zstream"),u=Object.prototype.toString;function l(t){if(!(this instanceof l))return new l(t);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(s[n]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var h;if(h="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=i.deflateSetDictionary(this.strm,h)))throw new Error(s[n]);this._dict_set=!0}}function h(t,e){var n=new l(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}l.prototype.push=function(t,e){var n,s,a=this.strm,l=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?a.input=o.string2buf(t):"[object ArrayBuffer]"===u.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new r.Buf8(l),a.next_out=0,a.avail_out=l),1!==(n=i.deflate(a,s))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==a.avail_out&&(0!==a.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(o.buf2binstring(r.shrinkBuf(a.output,a.next_out))):this.onData(r.shrinkBuf(a.output,a.next_out)))}while((a.avail_in>0||0===a.avail_out)&&1!==n);return 4===s?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),a.avail_out=0,!0)},l.prototype.onData=function(t){this.chunks.push(t)},l.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=l,n.deflate=h,n.deflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},n.gzip=function(t,e){return(e=e||{}).gzip=!0,h(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,n){"use strict";var i=t("./zlib/inflate"),r=t("./utils/common"),o=t("./utils/strings"),s=t("./zlib/constants"),a=t("./zlib/messages"),u=t("./zlib/zstream"),l=t("./zlib/gzheader"),h=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,e.windowBits);if(n!==s.Z_OK)throw new Error(a[n]);this.header=new l,i.inflateGetHeader(this.strm,this.header)}function f(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(t,e){var n,a,u,l,c,f,d=this.strm,p=this.options.chunkSize,v=this.options.dictionary,m=!1;if(this.ended)return!1;a=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?d.input=o.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new r.Buf8(p),d.next_out=0,d.avail_out=p),(n=i.inflate(d,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&v&&(f="string"==typeof v?o.string2buf(v):"[object ArrayBuffer]"===h.call(v)?new Uint8Array(v):v,n=i.inflateSetDictionary(this.strm,f)),n===s.Z_BUF_ERROR&&!0===m&&(n=s.Z_OK,m=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==s.Z_STREAM_END&&(0!==d.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(u=o.utf8border(d.output,d.next_out),l=d.next_out-u,c=o.buf2string(d.output,u),d.next_out=l,d.avail_out=p-l,l&&r.arraySet(d.output,d.output,u,l,0),this.onData(c)):this.onData(r.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),d.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=c,n.inflate=f,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,f(t,e)},n.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,n,i,r){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),r);else for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){var e,n,i,r,o,s;for(i=0,e=0,n=t.length;e<n;e++)i+=t[e].length;for(s=new Uint8Array(i),r=0,e=0,n=t.length;e<n;e++)o=t[e],s.set(o,r),r+=o.length;return s}},o={arraySet:function(t,e,n,i,r){for(var o=0;o<i;o++)t[r+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],42:[function(t,e,n){"use strict";var i=t("./common"),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var s=new i.Buf8(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function u(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var n="",s=0;s<e;s++)n+=String.fromCharCode(t[s]);return n}s[254]=s[254]=1,n.string2buf=function(t){var e,n,r,o,s,a=t.length,u=0;for(o=0;o<a;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(r=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),u+=n<128?1:n<2048?2:n<65536?3:4;for(e=new i.Buf8(u),s=0,o=0;s<u;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(r=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},n.buf2binstring=function(t){return u(t,t.length)},n.binstring2buf=function(t){for(var e=new i.Buf8(t.length),n=0,r=e.length;n<r;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,i,r,o,a=e||t.length,l=new Array(2*a);for(i=0,n=0;n<a;)if((r=t[n++])<128)l[i++]=r;else if((o=s[r])>4)l[i++]=65533,n+=o-1;else{for(r&=2===o?31:3===o?15:7;o>1&&n<a;)r=r<<6|63&t[n++],o--;o>1?l[i++]=65533:r<65536?l[i++]=r:(r-=65536,l[i++]=55296|r>>10&1023,l[i++]=56320|1023&r)}return u(l,i)},n.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+s[t[n]]>e?n:e}},{"./common":41}],43:[function(t,e,n){"use strict";e.exports=function(t,e,n,i){for(var r=65535&t|0,o=t>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{o=o+(r=r+e[i++]|0)|0}while(--s);r%=65521,o%=65521}return r|o<<16|0}},{}],44:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,n){"use strict";var i=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e,n,r){var o=i,s=r+n;t^=-1;for(var a=r;a<s;a++)t=t>>>8^o[255&(t^e[a])];return-1^t}},{}],46:[function(t,e,n){"use strict";var i,r=t("../utils/common"),o=t("./trees"),s=t("./adler32"),a=t("./crc32"),u=t("./messages"),l=-2,h=258,c=262,f=103,d=113,p=666;function v(t,e){return t.msg=u[e],e}function m(t){return(t<<1)-(t>4?9:0)}function g(t){for(var e=t.length;--e>=0;)t[e]=0}function y(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(r.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function b(t,e){o._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,y(t.strm)}function w(t,e){t.pending_buf[t.pending++]=e}function _(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function k(t,e){var n,i,r=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match,u=t.strstart>t.w_size-c?t.strstart-(t.w_size-c):0,l=t.window,f=t.w_mask,d=t.prev,p=t.strstart+h,v=l[o+s-1],m=l[o+s];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(l[(n=e)+s]===m&&l[n+s-1]===v&&l[n]===l[o]&&l[++n]===l[o+1]){o+=2,n++;do{}while(l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&l[++o]===l[++n]&&o<p);if(i=h-(p-o),o=p-h,i>s){if(t.match_start=e,s=i,i>=a)break;v=l[o+s-1],m=l[o+s]}}}while((e=d[e&f])>u&&0!=--r);return s<=t.lookahead?s:t.lookahead}function x(t){var e,n,i,o,u,l,h,f,d,p,v=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=v+(v-c)){r.arraySet(t.window,t.window,v,v,0),t.match_start-=v,t.strstart-=v,t.block_start-=v,e=n=t.hash_size;do{i=t.head[--e],t.head[e]=i>=v?i-v:0}while(--n);e=n=v;do{i=t.prev[--e],t.prev[e]=i>=v?i-v:0}while(--n);o+=v}if(0===t.strm.avail_in)break;if(l=t.strm,h=t.window,f=t.strstart+t.lookahead,d=o,p=void 0,(p=l.avail_in)>d&&(p=d),n=0===p?0:(l.avail_in-=p,r.arraySet(h,l.input,l.next_in,p,f),1===l.state.wrap?l.adler=s(l.adler,h,p,f):2===l.state.wrap&&(l.adler=a(l.adler,h,p,f)),l.next_in+=p,l.total_in+=p,p),t.lookahead+=n,t.lookahead+t.insert>=3)for(u=t.strstart-t.insert,t.ins_h=t.window[u],t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+3-1])&t.hash_mask,t.prev[u&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=u,u++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<c&&0!==t.strm.avail_in)}function S(t,e){for(var n,i;;){if(t.lookahead<c){if(x(t),t.lookahead<c&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-c&&(t.match_length=k(t,n)),t.match_length>=3)if(i=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}function E(t,e){for(var n,i,r;;){if(t.lookahead<c){if(x(t),t.lookahead<c&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-c&&(t.match_length=k(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(b(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=o._tr_tally(t,0,t.window[t.strstart-1]))&&b(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}function C(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}function T(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function N(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:d,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):v(t,l)}function O(t){var e,n=N(t);return 0===n&&((e=t.state).window_size=2*e.w_size,g(e.head),e.max_lazy_match=i[e.level].max_lazy,e.good_match=i[e.level].good_length,e.nice_match=i[e.level].nice_length,e.max_chain_length=i[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),n}function A(t,e,n,i,o,s){if(!t)return l;var a=1;if(-1===e&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),o<1||o>9||8!==n||i<8||i>15||e<0||e>9||s<0||s>4)return v(t,l);8===i&&(i=9);var u=new T;return t.state=u,u.strm=t,u.wrap=a,u.gzhead=null,u.w_bits=i,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new r.Buf8(2*u.w_size),u.head=new r.Buf16(u.hash_size),u.prev=new r.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new r.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=s,u.method=n,O(t)}i=[new C(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(x(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,b(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-c&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(b(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(b(t,!1),t.strm.avail_out),1)})),new C(4,4,8,4,S),new C(4,5,16,8,S),new C(4,6,32,32,S),new C(4,4,16,16,E),new C(8,16,32,32,E),new C(8,16,128,128,E),new C(8,32,128,256,E),new C(32,128,258,1024,E),new C(32,258,258,4096,E)],n.deflateInit=function(t,e){return A(t,e,8,15,8,0)},n.deflateInit2=A,n.deflateReset=O,n.deflateResetKeep=N,n.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?l:(t.state.gzhead=e,0):l},n.deflate=function(t,e){var n,r,s,u;if(!t||!t.state||e>5||e<0)return t?v(t,l):l;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===p&&4!==e)return v(t,0===t.avail_out?-5:l);if(r.strm=t,n=r.last_flush,r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,w(r,31),w(r,139),w(r,8),r.gzhead?(w(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),w(r,255&r.gzhead.time),w(r,r.gzhead.time>>8&255),w(r,r.gzhead.time>>16&255),w(r,r.gzhead.time>>24&255),w(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),w(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(w(r,255&r.gzhead.extra.length),w(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=a(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(w(r,0),w(r,0),w(r,0),w(r,0),w(r,0),w(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),w(r,3),r.status=d);else{var c=8+(r.w_bits-8<<4)<<8;c|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(c|=32),c+=31-c%31,r.status=d,_(r,c),0!==r.strstart&&(_(r,t.adler>>>16),_(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(s=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),y(t),s=r.pending,r.pending!==r.pending_buf_size));)w(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),y(t),s=r.pending,r.pending===r.pending_buf_size)){u=1;break}u=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,w(r,u)}while(0!==u);r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),0===u&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){s=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),y(t),s=r.pending,r.pending===r.pending_buf_size)){u=1;break}u=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,w(r,u)}while(0!==u);r.gzhead.hcrc&&r.pending>s&&(t.adler=a(t.adler,r.pending_buf,r.pending-s,s)),0===u&&(r.status=f)}else r.status=f;if(r.status===f&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&y(t),r.pending+2<=r.pending_buf_size&&(w(r,255&t.adler),w(r,t.adler>>8&255),t.adler=0,r.status=d)):r.status=d),0!==r.pending){if(y(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&m(e)<=m(n)&&4!==e)return v(t,-5);if(r.status===p&&0!==t.avail_in)return v(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&r.status!==p){var k=2===r.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(x(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var n,i,r,s,a=t.window;;){if(t.lookahead<=h){if(x(t),t.lookahead<=h&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=a[r=t.strstart-1])===a[++r]&&i===a[++r]&&i===a[++r]){s=t.strstart+h;do{}while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<s);t.match_length=h-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}(r,e):i[r.level].func(r,e);if(3!==k&&4!==k||(r.status=p),1===k||3===k)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===k&&(1===e?o._tr_align(r):5!==e&&(o._tr_stored_block(r,0,0,!1),3===e&&(g(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),y(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(w(r,255&t.adler),w(r,t.adler>>8&255),w(r,t.adler>>16&255),w(r,t.adler>>24&255),w(r,255&t.total_in),w(r,t.total_in>>8&255),w(r,t.total_in>>16&255),w(r,t.total_in>>24&255)):(_(r,t.adler>>>16),_(r,65535&t.adler)),y(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},n.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&e!==f&&e!==d&&e!==p?v(t,l):(t.state=null,e===d?v(t,-3):0):l},n.deflateSetDictionary=function(t,e){var n,i,o,a,u,h,c,f,d=e.length;if(!t||!t.state)return l;if(2===(a=(n=t.state).wrap)||1===a&&42!==n.status||n.lookahead)return l;for(1===a&&(t.adler=s(t.adler,e,d,0)),n.wrap=0,d>=n.w_size&&(0===a&&(g(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new r.Buf8(n.w_size),r.arraySet(f,e,d-n.w_size,n.w_size,0),e=f,d=n.w_size),u=t.avail_in,h=t.next_in,c=t.input,t.avail_in=d,t.next_in=0,t.input=e,x(n);n.lookahead>=3;){i=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--o);n.strstart=i,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=h,t.input=c,t.avail_in=u,n.wrap=a,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,n){"use strict";e.exports=function(t,e){var n,i,r,o,s,a,u,l,h,c,f,d,p,v,m,g,y,b,w,_,k,x,S,E,C;n=t.state,i=t.next_in,E=t.input,r=i+(t.avail_in-5),o=t.next_out,C=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),u=n.dmax,l=n.wsize,h=n.whave,c=n.wnext,f=n.window,d=n.hold,p=n.bits,v=n.lencode,m=n.distcode,g=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{p<15&&(d+=E[i++]<<p,p+=8,d+=E[i++]<<p,p+=8),b=v[d&g];e:for(;;){if(d>>>=w=b>>>24,p-=w,0==(w=b>>>16&255))C[o++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=v[(65535&b)+(d&(1<<w)-1)];continue e}if(32&w){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}_=65535&b,(w&=15)&&(p<w&&(d+=E[i++]<<p,p+=8),_+=d&(1<<w)-1,d>>>=w,p-=w),p<15&&(d+=E[i++]<<p,p+=8,d+=E[i++]<<p,p+=8),b=m[d&y];n:for(;;){if(d>>>=w=b>>>24,p-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=m[(65535&b)+(d&(1<<w)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(k=65535&b,p<(w&=15)&&(d+=E[i++]<<p,(p+=8)<w&&(d+=E[i++]<<p,p+=8)),(k+=d&(1<<w)-1)>u){t.msg="invalid distance too far back",n.mode=30;break t}if(d>>>=w,p-=w,k>(w=o-s)){if((w=k-w)>h&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(x=0,S=f,0===c){if(x+=l-w,w<_){_-=w;do{C[o++]=f[x++]}while(--w);x=o-k,S=C}}else if(c<w){if(x+=l+c-w,(w-=c)<_){_-=w;do{C[o++]=f[x++]}while(--w);if(x=0,c<_){_-=w=c;do{C[o++]=f[x++]}while(--w);x=o-k,S=C}}}else if(x+=c-w,w<_){_-=w;do{C[o++]=f[x++]}while(--w);x=o-k,S=C}for(;_>2;)C[o++]=S[x++],C[o++]=S[x++],C[o++]=S[x++],_-=3;_&&(C[o++]=S[x++],_>1&&(C[o++]=S[x++]))}else{x=o-k;do{C[o++]=C[x++],C[o++]=C[x++],C[o++]=C[x++],_-=3}while(_>2);_&&(C[o++]=C[x++],_>1&&(C[o++]=C[x++]))}break}}break}}while(i<r&&o<a);i-=_=p>>3,d&=(1<<(p-=_<<3))-1,t.next_in=i,t.next_out=o,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=o<a?a-o+257:257-(o-a),n.hold=d,n.bits=p}},{}],49:[function(t,e,n){"use strict";var i=t("../utils/common"),r=t("./adler32"),o=t("./crc32"),s=t("./inffast"),a=t("./inftrees"),u=-2,l=12,h=30;function c(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function f(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(852),e.distcode=e.distdyn=new i.Buf32(592),e.sane=1,e.back=-1,0):u}function p(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,d(t)):u}function v(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?u:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,p(t))):u}function m(t,e){var n,i;return t?(i=new f,t.state=i,i.window=null,0!==(n=v(t,e))&&(t.state=null),n):u}var g,y,b=!0;function w(t){if(b){var e;for(g=new i.Buf32(512),y=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(a(1,t.lens,0,288,g,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;a(2,t.lens,0,32,y,0,t.work,{bits:5}),b=!1}t.lencode=g,t.lenbits=9,t.distcode=y,t.distbits=5}function _(t,e,n,r){var o,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new i.Buf8(s.wsize)),r>=s.wsize?(i.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>r&&(o=r),i.arraySet(s.window,e,n-r,o,s.wnext),(r-=o)?(i.arraySet(s.window,e,n-r,r,0),s.wnext=r,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}n.inflateReset=p,n.inflateReset2=v,n.inflateResetKeep=d,n.inflateInit=function(t){return m(t,15)},n.inflateInit2=m,n.inflate=function(t,e){var n,f,d,p,v,m,g,y,b,k,x,S,E,C,T,N,O,A,I,z,R,P,L,j,B=0,D=new i.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return u;(n=t.state).mode===l&&(n.mode=13),v=t.next_out,d=t.output,g=t.avail_out,p=t.next_in,f=t.input,m=t.avail_in,y=n.hold,b=n.bits,k=m,x=g,P=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(2&n.wrap&&35615===y){n.check=0,D[0]=255&y,D[1]=y>>>8&255,n.check=o(n.check,D,2,0),y=0,b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){t.msg="incorrect header check",n.mode=h;break}if(8!=(15&y)){t.msg="unknown compression method",n.mode=h;break}if(b-=4,R=8+(15&(y>>>=4)),0===n.wbits)n.wbits=R;else if(R>n.wbits){t.msg="invalid window size",n.mode=h;break}n.dmax=1<<R,t.adler=n.check=1,n.mode=512&y?10:l,y=0,b=0;break;case 2:for(;b<16;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(n.flags=y,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=h;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=h;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(D[0]=255&y,D[1]=y>>>8&255,n.check=o(n.check,D,2,0)),y=0,b=0,n.mode=3;case 3:for(;b<32;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}n.head&&(n.head.time=y),512&n.flags&&(D[0]=255&y,D[1]=y>>>8&255,D[2]=y>>>16&255,D[3]=y>>>24&255,n.check=o(n.check,D,4,0)),y=0,b=0,n.mode=4;case 4:for(;b<16;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(D[0]=255&y,D[1]=y>>>8&255,n.check=o(n.check,D,2,0)),y=0,b=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(D[0]=255&y,D[1]=y>>>8&255,n.check=o(n.check,D,2,0)),y=0,b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((S=n.length)>m&&(S=m),S&&(n.head&&(R=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,f,p,S,R)),512&n.flags&&(n.check=o(n.check,f,S,p)),m-=S,p+=S,n.length-=S),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===m)break t;S=0;do{R=f[p+S++],n.head&&R&&n.length<65536&&(n.head.name+=String.fromCharCode(R))}while(R&&S<m);if(512&n.flags&&(n.check=o(n.check,f,S,p)),m-=S,p+=S,R)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===m)break t;S=0;do{R=f[p+S++],n.head&&R&&n.length<65536&&(n.head.comment+=String.fromCharCode(R))}while(R&&S<m);if(512&n.flags&&(n.check=o(n.check,f,S,p)),m-=S,p+=S,R)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(y!==(65535&n.check)){t.msg="header crc mismatch",n.mode=h;break}y=0,b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=l;break;case 10:for(;b<32;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}t.adler=n.check=c(y),y=0,b=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=v,t.avail_out=g,t.next_in=p,t.avail_in=m,n.hold=y,n.bits=b,2;t.adler=n.check=1,n.mode=l;case l:if(5===e||6===e)break t;case 13:if(n.last){y>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}switch(n.last=1&y,b-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(w(n),n.mode=20,6===e){y>>>=2,b-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=h}y>>>=2,b-=2;break;case 14:for(y>>>=7&b,b-=7&b;b<32;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if((65535&y)!=(y>>>16^65535)){t.msg="invalid stored block lengths",n.mode=h;break}if(n.length=65535&y,y=0,b=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(S=n.length){if(S>m&&(S=m),S>g&&(S=g),0===S)break t;i.arraySet(d,f,p,S,v),m-=S,p+=S,g-=S,v+=S,n.length-=S;break}n.mode=l;break;case 17:for(;b<14;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(n.nlen=257+(31&y),y>>>=5,b-=5,n.ndist=1+(31&y),y>>>=5,b-=5,n.ncode=4+(15&y),y>>>=4,b-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=h;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}n.lens[F[n.have++]]=7&y,y>>>=3,b-=3}for(;n.have<19;)n.lens[F[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,L={bits:n.lenbits},P=a(0,n.lens,0,19,n.lencode,0,n.work,L),n.lenbits=L.bits,P){t.msg="invalid code lengths set",n.mode=h;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;N=(B=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,O=65535&B,!((T=B>>>24)<=b);){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(O<16)y>>>=T,b-=T,n.lens[n.have++]=O;else{if(16===O){for(j=T+2;b<j;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(y>>>=T,b-=T,0===n.have){t.msg="invalid bit length repeat",n.mode=h;break}R=n.lens[n.have-1],S=3+(3&y),y>>>=2,b-=2}else if(17===O){for(j=T+3;b<j;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}b-=T,R=0,S=3+(7&(y>>>=T)),y>>>=3,b-=3}else{for(j=T+7;b<j;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}b-=T,R=0,S=11+(127&(y>>>=T)),y>>>=7,b-=7}if(n.have+S>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=h;break}for(;S--;)n.lens[n.have++]=R}}if(n.mode===h)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=h;break}if(n.lenbits=9,L={bits:n.lenbits},P=a(1,n.lens,0,n.nlen,n.lencode,0,n.work,L),n.lenbits=L.bits,P){t.msg="invalid literal/lengths set",n.mode=h;break}if(n.distbits=6,n.distcode=n.distdyn,L={bits:n.distbits},P=a(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L),n.distbits=L.bits,P){t.msg="invalid distances set",n.mode=h;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(m>=6&&g>=258){t.next_out=v,t.avail_out=g,t.next_in=p,t.avail_in=m,n.hold=y,n.bits=b,s(t,x),v=t.next_out,d=t.output,g=t.avail_out,p=t.next_in,f=t.input,m=t.avail_in,y=n.hold,b=n.bits,n.mode===l&&(n.back=-1);break}for(n.back=0;N=(B=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,O=65535&B,!((T=B>>>24)<=b);){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(N&&0==(240&N)){for(A=T,I=N,z=O;N=(B=n.lencode[z+((y&(1<<A+I)-1)>>A)])>>>16&255,O=65535&B,!(A+(T=B>>>24)<=b);){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}y>>>=A,b-=A,n.back+=A}if(y>>>=T,b-=T,n.back+=T,n.length=O,0===N){n.mode=26;break}if(32&N){n.back=-1,n.mode=l;break}if(64&N){t.msg="invalid literal/length code",n.mode=h;break}n.extra=15&N,n.mode=22;case 22:if(n.extra){for(j=n.extra;b<j;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;N=(B=n.distcode[y&(1<<n.distbits)-1])>>>16&255,O=65535&B,!((T=B>>>24)<=b);){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(0==(240&N)){for(A=T,I=N,z=O;N=(B=n.distcode[z+((y&(1<<A+I)-1)>>A)])>>>16&255,O=65535&B,!(A+(T=B>>>24)<=b);){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}y>>>=A,b-=A,n.back+=A}if(y>>>=T,b-=T,n.back+=T,64&N){t.msg="invalid distance code",n.mode=h;break}n.offset=O,n.extra=15&N,n.mode=24;case 24:if(n.extra){for(j=n.extra;b<j;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=h;break}n.mode=25;case 25:if(0===g)break t;if(S=x-g,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=h;break}S>n.wnext?(S-=n.wnext,E=n.wsize-S):E=n.wnext-S,S>n.length&&(S=n.length),C=n.window}else C=d,E=v-n.offset,S=n.length;S>g&&(S=g),g-=S,n.length-=S;do{d[v++]=C[E++]}while(--S);0===n.length&&(n.mode=21);break;case 26:if(0===g)break t;d[v++]=n.length,g--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===m)break t;m--,y|=f[p++]<<b,b+=8}if(x-=g,t.total_out+=x,n.total+=x,x&&(t.adler=n.check=n.flags?o(n.check,d,x,v-x):r(n.check,d,x,v-x)),x=g,(n.flags?y:c(y))!==n.check){t.msg="incorrect data check",n.mode=h;break}y=0,b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===m)break t;m--,y+=f[p++]<<b,b+=8}if(y!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=h;break}y=0,b=0}n.mode=29;case 29:P=1;break t;case h:P=-3;break t;case 31:return-4;default:return u}return t.next_out=v,t.avail_out=g,t.next_in=p,t.avail_in=m,n.hold=y,n.bits=b,(n.wsize||x!==t.avail_out&&n.mode<h&&(n.mode<27||4!==e))&&_(t,t.output,t.next_out,x-t.avail_out)?(n.mode=31,-4):(k-=t.avail_in,x-=t.avail_out,t.total_in+=k,t.total_out+=x,n.total+=x,n.wrap&&x&&(t.adler=n.check=n.flags?o(n.check,d,x,t.next_out-x):r(n.check,d,x,t.next_out-x)),t.data_type=n.bits+(n.last?64:0)+(n.mode===l?128:0)+(20===n.mode||15===n.mode?256:0),(0===k&&0===x||4===e)&&0===P&&(P=-5),P)},n.inflateEnd=function(t){if(!t||!t.state)return u;var e=t.state;return e.window&&(e.window=null),t.state=null,0},n.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?u:(n.head=e,e.done=!1,0):u},n.inflateSetDictionary=function(t,e){var n,i=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?u:11===n.mode&&r(1,e,i,0)!==n.check?-3:_(t,e,i,i)?(n.mode=31,-4):(n.havedict=1,0):u},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,n){"use strict";var i=t("../utils/common"),r=15,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,l,h,c,f,d){var p,v,m,g,y,b,w,_,k,x=d.bits,S=0,E=0,C=0,T=0,N=0,O=0,A=0,I=0,z=0,R=0,P=null,L=0,j=new i.Buf16(16),B=new i.Buf16(16),D=null,F=0;for(S=0;S<=r;S++)j[S]=0;for(E=0;E<l;E++)j[e[n+E]]++;for(N=x,T=r;T>=1&&0===j[T];T--);if(N>T&&(N=T),0===T)return h[c++]=20971520,h[c++]=20971520,d.bits=1,0;for(C=1;C<T&&0===j[C];C++);for(N<C&&(N=C),I=1,S=1;S<=r;S++)if(I<<=1,(I-=j[S])<0)return-1;if(I>0&&(0===t||1!==T))return-1;for(B[1]=0,S=1;S<r;S++)B[S+1]=B[S]+j[S];for(E=0;E<l;E++)0!==e[n+E]&&(f[B[e[n+E]]++]=E);if(0===t?(P=D=f,b=19):1===t?(P=o,L-=257,D=s,F-=257,b=256):(P=a,D=u,b=-1),R=0,E=0,S=C,y=c,O=N,A=0,m=-1,g=(z=1<<N)-1,1===t&&z>852||2===t&&z>592)return 1;for(;;){w=S-A,f[E]<b?(_=0,k=f[E]):f[E]>b?(_=D[F+f[E]],k=P[L+f[E]]):(_=96,k=0),p=1<<S-A,C=v=1<<O;do{h[y+(R>>A)+(v-=p)]=w<<24|_<<16|k|0}while(0!==v);for(p=1<<S-1;R&p;)p>>=1;if(0!==p?(R&=p-1,R+=p):R=0,E++,0==--j[S]){if(S===T)break;S=e[n+f[E]]}if(S>N&&(R&g)!==m){for(0===A&&(A=N),y+=C,I=1<<(O=S-A);O+A<T&&!((I-=j[O+A])<=0);)O++,I<<=1;if(z+=1<<O,1===t&&z>852||2===t&&z>592)return 1;h[m=R&g]=N<<24|O<<16|y-c|0}}return 0!==R&&(h[y+R]=S-A<<24|64<<16|0),d.bits=N,0}},{"../utils/common":41}],51:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,n){"use strict";var i=t("../utils/common");function r(t){for(var e=t.length;--e>=0;)t[e]=0}var o=256,s=286,a=30,u=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],h=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],f=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],d=new Array(576);r(d);var p=new Array(60);r(p);var v=new Array(512);r(v);var m=new Array(256);r(m);var g=new Array(29);r(g);var y,b,w,_=new Array(a);function k(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}function x(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function S(t){return t<256?v[t]:v[256+(t>>>7)]}function E(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function C(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,E(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function T(t,e,n){C(t,n[2*e],n[2*e+1])}function N(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function O(t,e,n){var i,r,o=new Array(16),s=0;for(i=1;i<=u;i++)o[i]=s=s+n[i-1]<<1;for(r=0;r<=e;r++){var a=t[2*r+1];0!==a&&(t[2*r]=N(o[a]++,a))}}function A(t){var e;for(e=0;e<s;e++)t.dyn_ltree[2*e]=0;for(e=0;e<a;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function I(t){t.bi_valid>8?E(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function z(t,e,n,i){var r=2*e,o=2*n;return t[r]<t[o]||t[r]===t[o]&&i[e]<=i[n]}function R(t,e,n){for(var i=t.heap[n],r=n<<1;r<=t.heap_len&&(r<t.heap_len&&z(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!z(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i}function P(t,e,n){var i,r,s,a,u=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],r=t.pending_buf[t.l_buf+u],u++,0===i?T(t,r,e):(T(t,(s=m[r])+o+1,e),0!==(a=l[s])&&C(t,r-=g[s],a),T(t,s=S(--i),n),0!==(a=h[s])&&C(t,i-=_[s],a))}while(u<t.last_lit);T(t,256,e)}function L(t,e){var n,i,r,o=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,l=e.stat_desc.elems,h=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<l;n++)0!==o[2*n]?(t.heap[++t.heap_len]=h=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(r=t.heap[++t.heap_len]=h<2?++h:0)]=1,t.depth[r]=0,t.opt_len--,a&&(t.static_len-=s[2*r+1]);for(e.max_code=h,n=t.heap_len>>1;n>=1;n--)R(t,o,n);r=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],R(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,o[2*r]=o[2*n]+o[2*i],t.depth[r]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,o[2*n+1]=o[2*i+1]=r,t.heap[1]=r++,R(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,r,o,s,a,l=e.dyn_tree,h=e.max_code,c=e.stat_desc.static_tree,f=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,p=e.stat_desc.extra_base,v=e.stat_desc.max_length,m=0;for(o=0;o<=u;o++)t.bl_count[o]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(o=l[2*l[2*(i=t.heap[n])+1]+1]+1)>v&&(o=v,m++),l[2*i+1]=o,i>h||(t.bl_count[o]++,s=0,i>=p&&(s=d[i-p]),a=l[2*i],t.opt_len+=a*(o+s),f&&(t.static_len+=a*(c[2*i+1]+s)));if(0!==m){do{for(o=v-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[v]--,m-=2}while(m>0);for(o=v;0!==o;o--)for(i=t.bl_count[o];0!==i;)(r=t.heap[--n])>h||(l[2*r+1]!==o&&(t.opt_len+=(o-l[2*r+1])*l[2*r],l[2*r+1]=o),i--)}}(t,e),O(o,h,t.bl_count)}function j(t,e,n){var i,r,o=-1,s=e[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=s,s=e[2*(i+1)+1],++a<u&&r===s||(a<l?t.bl_tree[2*r]+=a:0!==r?(r!==o&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,o=r,0===s?(u=138,l=3):r===s?(u=6,l=3):(u=7,l=4))}function B(t,e,n){var i,r,o=-1,s=e[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),i=0;i<=n;i++)if(r=s,s=e[2*(i+1)+1],!(++a<u&&r===s)){if(a<l)do{T(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==o&&(T(t,r,t.bl_tree),a--),T(t,16,t.bl_tree),C(t,a-3,2)):a<=10?(T(t,17,t.bl_tree),C(t,a-3,3)):(T(t,18,t.bl_tree),C(t,a-11,7));a=0,o=r,0===s?(u=138,l=3):r===s?(u=6,l=3):(u=7,l=4)}}r(_);var D=!1;function F(t,e,n,r){C(t,0+(r?1:0),3),function(t,e,n,r){I(t),r&&(E(t,n),E(t,~n)),i.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}n._tr_init=function(t){D||(function(){var t,e,n,i,r,o=new Array(16);for(n=0,i=0;i<28;i++)for(g[i]=n,t=0;t<1<<l[i];t++)m[n++]=i;for(m[n-1]=i,r=0,i=0;i<16;i++)for(_[i]=r,t=0;t<1<<h[i];t++)v[r++]=i;for(r>>=7;i<a;i++)for(_[i]=r<<7,t=0;t<1<<h[i]-7;t++)v[256+r++]=i;for(e=0;e<=u;e++)o[e]=0;for(t=0;t<=143;)d[2*t+1]=8,t++,o[8]++;for(;t<=255;)d[2*t+1]=9,t++,o[9]++;for(;t<=279;)d[2*t+1]=7,t++,o[7]++;for(;t<=287;)d[2*t+1]=8,t++,o[8]++;for(O(d,287,o),t=0;t<a;t++)p[2*t+1]=5,p[2*t]=N(t,5);y=new k(d,l,257,s,u),b=new k(p,h,0,a,u),w=new k(new Array(0),c,0,19,7)}(),D=!0),t.l_desc=new x(t.dyn_ltree,y),t.d_desc=new x(t.dyn_dtree,b),t.bl_desc=new x(t.bl_tree,w),t.bi_buf=0,t.bi_valid=0,A(t)},n._tr_stored_block=F,n._tr_flush_block=function(t,e,n,i){var r,s,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<o;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),L(t,t.l_desc),L(t,t.d_desc),a=function(t){var e;for(j(t,t.dyn_ltree,t.l_desc.max_code),j(t,t.dyn_dtree,t.d_desc.max_code),L(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*f[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(s=t.static_len+3+7>>>3)<=r&&(r=s)):r=s=n+5,n+4<=r&&-1!==e?F(t,e,n,i):4===t.strategy||s===r?(C(t,2+(i?1:0),3),P(t,d,p)):(C(t,4+(i?1:0),3),function(t,e,n,i){var r;for(C(t,e-257,5),C(t,n-1,5),C(t,i-4,4),r=0;r<i;r++)C(t,t.bl_tree[2*f[r]+1],3);B(t,t.dyn_ltree,e-1),B(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),P(t,t.dyn_ltree,t.dyn_dtree)),A(t),i&&I(t)},n._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(m[n]+o+1)]++,t.dyn_dtree[2*S(e)]++),t.last_lit===t.lit_bufsize-1},n._tr_align=function(t){C(t,2,3),T(t,256,d),function(t){16===t.bi_valid?(E(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,n){"use strict";e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)},20927:function(t,e,n){t.exports=function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,(function(t){return r(e[s][1][t]||t)}),l,l.exports,t,e,n,i)}return n[s].exports}for(var o=void 0,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,i){(function(t){"use strict";var n,i,r=t.MutationObserver||t.WebKitMutationObserver;if(r){var o=0,s=new r(h),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),n=function(){a.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){h(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(h,0)};else{var u=new t.MessageChannel;u.port1.onmessage=h,n=function(){u.port2.postMessage(0)}}var l=[];function h(){var t,e;i=!0;for(var n=l.length;n;){for(e=l,l=[],t=-1;++t<n;)e[t]();n=l.length}i=!1}e.exports=function(t){1!==l.push(t)||i||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var i=t(1);function r(){}var o={},s=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function l(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==r&&d(this,t)}function h(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function c(t,e,n){i((function(){var i;try{i=e(n)}catch(e){return o.reject(t,e)}i===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,i)}))}function f(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var n=!1;function i(e){n||(n=!0,o.reject(t,e))}function r(e){n||(n=!0,o.resolve(t,e))}var s=p((function(){e(r,i)}));"error"===s.status&&i(s.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}e.exports=l,l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===s)return this;var n=new this.constructor(r);return this.state!==u?c(n,this.state===a?t:e,this.outcome):this.queue.push(new h(n,t,e)),n},h.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},h.prototype.otherCallFulfilled=function(t){c(this.promise,this.onFulfilled,t)},h.prototype.callRejected=function(t){o.reject(this.promise,t)},h.prototype.otherCallRejected=function(t){c(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=p(f,e);if("error"===n.status)return o.reject(t,n.value);var i=n.value;if(i)d(t,i);else{t.state=a,t.outcome=e;for(var r=-1,s=t.queue.length;++r<s;)t.queue[r].callFulfilled(e)}return t},o.reject=function(t,e){t.state=s,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},l.resolve=function(t){return t instanceof this?t:o.resolve(new this(r),t)},l.reject=function(t){var e=new this(r);return o.reject(e,t)},l.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,u=-1,l=new this(r);++u<n;)h(t[u],u);return l;function h(t,r){e.resolve(t).then((function(t){s[r]=t,++a!==n||i||(i=!0,o.resolve(l,s))}),(function(t){i||(i=!0,o.reject(l,t))}))}},l.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n,i=t.length,s=!1;if(!i)return this.resolve([]);for(var a=-1,u=new this(r);++a<i;)n=t[a],e.resolve(n).then((function(t){s||(s=!0,o.resolve(u,t))}),(function(t){s||(s=!0,o.reject(u,t))}));return u}},{1:1}],3:[function(t,e,i){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function o(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}"undefined"==typeof Promise&&t(3);var s=Promise;function a(t,e){e&&t.then((function(t){e(null,t)}),(function(t){e(t)}))}function u(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function l(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function h(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var c="local-forage-detect-blob-support",f=void 0,d={},p=Object.prototype.toString,v="readonly",m="readwrite";function g(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=0;r<e;r++)i[r]=t.charCodeAt(r);return n}function y(t){return"boolean"==typeof f?s.resolve(f):function(t){return new s((function(e){var n=t.transaction(c,m),i=o([""]);n.objectStore(c).put(i,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}})).catch((function(){return!1}))}(t).then((function(t){return f=t}))}function b(t){var e=d[t.name],n={};n.promise=new s((function(t,e){n.resolve=t,n.reject=e})),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then((function(){return n.promise})):e.dbReady=n.promise}function w(t){var e=d[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function _(t,e){var n=d[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function k(t,e){return new s((function(n,i){if(d[t.name]=d[t.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},t.db){if(!e)return n(t.db);b(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var s=r.open.apply(r,o);e&&(s.onupgradeneeded=function(e){var n=s.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(c)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),s.onerror=function(t){t.preventDefault(),i(s.error)},s.onsuccess=function(){var e=s.result;e.onversionchange=function(t){t.target.close()},n(e),w(t)}}))}function x(t){return k(t,!1)}function S(t){return k(t,!0)}function E(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),i=t.version<t.db.version,r=t.version>t.db.version;if(i&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),r||n){if(n){var o=t.db.version+1;o>t.version&&(t.version=o)}return!0}return!1}function C(t){return o([g(atob(t.data))],{type:t.type})}function T(t){return t&&t.__local_forage_encoded_blob}function N(t){var e=this,n=e._initReady().then((function(){var t=d[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady}));return u(n,t,t),n}function O(t,e,n,i){void 0===i&&(i=1);try{var r=t.db.transaction(t.storeName,e);n(null,r)}catch(r){if(i>0&&(!t.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return s.resolve().then((function(){if(!t.db||"NotFoundError"===r.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),S(t)})).then((function(){return function(t){b(t);for(var e=d[t.name],n=e.forages,i=0;i<n.length;i++){var r=n[i];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return t.db=null,x(t).then((function(e){return t.db=e,E(t)?S(t):e})).then((function(i){t.db=e.db=i;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=i})).catch((function(e){throw _(t,e),e}))}(t).then((function(){O(t,e,n,i-1)}))})).catch(n);n(r)}}var A={_driver:"asyncStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]=t[i];var r=d[n.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},d[n.name]=r),r.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=N);var o=[];function a(){return s.resolve()}for(var u=0;u<r.forages.length;u++){var l=r.forages[u];l!==e&&o.push(l._initReady().catch(a))}var h=r.forages.slice(0);return s.all(o).then((function(){return n.db=r.db,x(n)})).then((function(t){return n.db=t,E(n,e._defaultConfig.version)?S(n):t})).then((function(t){n.db=r.db=t,e._dbInfo=n;for(var i=0;i<h.length;i++){var o=h[i];o!==e&&(o._dbInfo.db=n.db,o._dbInfo.version=n.version)}}))},_support:function(){try{if(!r||!r.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=new s((function(e,i){n.ready().then((function(){O(n._dbInfo,v,(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n=s.result;if(n){var i=n.value;T(i)&&(i=C(i));var r=t(i,n.key,a++);void 0!==r?e(r):n.continue()}else e()},s.onerror=function(){i(s.error)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},getItem:function(t,e){var n=this;t=l(t);var i=new s((function(e,i){n.ready().then((function(){O(n._dbInfo,v,(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName).get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),T(t)&&(t=C(t)),e(t)},s.onerror=function(){i(s.error)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},setItem:function(t,e,n){var i=this;t=l(t);var r=new s((function(n,r){var o;i.ready().then((function(){return o=i._dbInfo,"[object Blob]"===p.call(e)?y(o.db).then((function(t){return t?e:(n=e,new s((function(t,e){var i=new FileReader;i.onerror=e,i.onloadend=function(e){var i=btoa(e.target.result||"");t({__local_forage_encoded_blob:!0,data:i,type:n.type})},i.readAsBinaryString(n)})));var n})):e})).then((function(e){O(i._dbInfo,m,(function(o,s){if(o)return r(o);try{var a=s.objectStore(i._dbInfo.storeName);null===e&&(e=void 0);var u=a.put(e,t);s.oncomplete=function(){void 0===e&&(e=null),n(e)},s.onabort=s.onerror=function(){var t=u.error?u.error:u.transaction.error;r(t)}}catch(t){r(t)}}))})).catch(r)}));return a(r,n),r},removeItem:function(t,e){var n=this;t=l(t);var i=new s((function(e,i){n.ready().then((function(){O(n._dbInfo,m,(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName).delete(t);o.oncomplete=function(){e()},o.onerror=function(){i(s.error)},o.onabort=function(){var t=s.error?s.error:s.transaction.error;i(t)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},clear:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){O(e._dbInfo,m,(function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName).clear();r.oncomplete=function(){t()},r.onabort=r.onerror=function(){var t=o.error?o.error:o.transaction.error;n(t)}}catch(t){n(t)}}))})).catch(n)}));return a(n,t),n},length:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){O(e._dbInfo,v,(function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName).count();o.onsuccess=function(){t(o.result)},o.onerror=function(){n(o.error)}}catch(t){n(t)}}))})).catch(n)}));return a(n,t),n},key:function(t,e){var n=this,i=new s((function(e,i){t<0?e(null):n.ready().then((function(){O(n._dbInfo,v,(function(r,o){if(r)return i(r);try{var s=o.objectStore(n._dbInfo.storeName),a=!1,u=s.openKeyCursor();u.onsuccess=function(){var n=u.result;n?0===t||a?e(n.key):(a=!0,n.advance(t)):e(null)},u.onerror=function(){i(u.error)}}catch(t){i(t)}}))})).catch(i)}));return a(i,e),i},keys:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){O(e._dbInfo,v,(function(i,r){if(i)return n(i);try{var o=r.objectStore(e._dbInfo.storeName).openKeyCursor(),s=[];o.onsuccess=function(){var e=o.result;e?(s.push(e.key),e.continue()):t(s)},o.onerror=function(){n(o.error)}}catch(t){n(t)}}))})).catch(n)}));return a(n,t),n},dropInstance:function(t,e){e=h.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,o=this;if(t.name){var u=t.name===n.name&&o._dbInfo.db?s.resolve(o._dbInfo.db):x(t).then((function(e){var n=d[t.name],i=n.forages;n.db=e;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=e;return e}));i=t.storeName?u.then((function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;b(t);var i=d[t.name],o=i.forages;e.close();for(var a=0;a<o.length;a++){var u=o[a];u._dbInfo.db=null,u._dbInfo.version=n}var l=new s((function(e,i){var o=r.open(t.name,n);o.onerror=function(t){o.result.close(),i(t)},o.onupgradeneeded=function(){o.result.deleteObjectStore(t.storeName)},o.onsuccess=function(){var t=o.result;t.close(),e(t)}}));return l.then((function(t){i.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,w(n._dbInfo)}})).catch((function(e){throw(_(t,e)||s.resolve()).catch((function(){})),e}))}})):u.then((function(e){b(t);var n=d[t.name],i=n.forages;e.close();for(var o=0;o<i.length;o++)i[o]._dbInfo.db=null;var a=new s((function(e,n){var i=r.deleteDatabase(t.name);i.onerror=function(){var t=i.result;t&&t.close(),n(i.error)},i.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},i.onsuccess=function(){var t=i.result;t&&t.close(),e(t)}}));return a.then((function(t){n.db=t;for(var e=0;e<i.length;e++)w(i[e]._dbInfo)})).catch((function(e){throw(_(t,e)||s.resolve()).catch((function(){})),e}))}))}else i=s.reject("Invalid arguments");return a(i,e),i}};var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",z=/^~~local_forage_type~([^~]+)~/,R="__lfsc__:",P=R.length,L="arbf",j="blob",B="si08",D="ui08",F="uic8",M="si16",U="si32",W="ur16",q="ui32",H="fl32",X="fl64",Z=P+L.length,V=Object.prototype.toString;function Y(t){var e,n,i,r,o,s=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l=new ArrayBuffer(s),h=new Uint8Array(l);for(e=0;e<a;e+=4)n=I.indexOf(t[e]),i=I.indexOf(t[e+1]),r=I.indexOf(t[e+2]),o=I.indexOf(t[e+3]),h[u++]=n<<2|i>>4,h[u++]=(15&i)<<4|r>>2,h[u++]=(3&r)<<6|63&o;return l}function G(t){var e,n=new Uint8Array(t),i="";for(e=0;e<n.length;e+=3)i+=I[n[e]>>2],i+=I[(3&n[e])<<4|n[e+1]>>4],i+=I[(15&n[e+1])<<2|n[e+2]>>6],i+=I[63&n[e+2]];return n.length%3==2?i=i.substring(0,i.length-1)+"=":n.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var K={serialize:function(t,e){var n="";if(t&&(n=V.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===V.call(t.buffer))){var i,r=R;t instanceof ArrayBuffer?(i=t,r+=L):(i=t.buffer,"[object Int8Array]"===n?r+=B:"[object Uint8Array]"===n?r+=D:"[object Uint8ClampedArray]"===n?r+=F:"[object Int16Array]"===n?r+=M:"[object Uint16Array]"===n?r+=W:"[object Int32Array]"===n?r+=U:"[object Uint32Array]"===n?r+=q:"[object Float32Array]"===n?r+=H:"[object Float64Array]"===n?r+=X:e(new Error("Failed to get type for BinaryArray"))),e(r+G(i))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n="~~local_forage_type~"+t.type+"~"+G(this.result);e("__lfsc__:blob"+n)},o.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}},deserialize:function(t){if(t.substring(0,P)!==R)return JSON.parse(t);var e,n=t.substring(Z),i=t.substring(P,Z);if(i===j&&z.test(n)){var r=n.match(z);e=r[1],n=n.substring(r[0].length)}var s=Y(n);switch(i){case L:return s;case j:return o([s],{type:e});case B:return new Int8Array(s);case D:return new Uint8Array(s);case F:return new Uint8ClampedArray(s);case M:return new Int16Array(s);case W:return new Uint16Array(s);case U:return new Int32Array(s);case q:return new Uint32Array(s);case H:return new Float32Array(s);case X:return new Float64Array(s);default:throw new Error("Unkown type: "+i)}},stringToBuffer:Y,bufferToString:G};function $(t,e,n,i){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,i)}function J(t,e,n,i,r,o){t.executeSql(n,i,r,(function(t,s){s.code===s.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],(function(t,a){a.rows.length?o(t,s):$(t,e,(function(){t.executeSql(n,i,r,o)}),o)}),o):o(t,s)}),o)}function Q(t,e,n,i){var r=this;t=l(t);var o=new s((function(o,s){r.ready().then((function(){void 0===e&&(e=null);var a=e,u=r._dbInfo;u.serializer.serialize(e,(function(e,l){l?s(l):u.db.transaction((function(n){J(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],(function(){o(a)}),(function(t,e){s(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(i>0)return void o(Q.apply(r,[t,a,n,i-1]));s(e)}}))}))})).catch(s)}));return a(o,n),o}function tt(t){return new s((function(e,n){t.transaction((function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,i){for(var r=[],o=0;o<i.rows.length;o++)r.push(i.rows.item(o).name);e({db:t,storeNames:r})}),(function(t,e){n(e)}))}),(function(t){n(t)}))}))}var et={_driver:"webSQLStorage",_initStorage:function(t){var e=this,n={db:null};if(t)for(var i in t)n[i]="string"!=typeof t[i]?t[i].toString():t[i];var r=new s((function(t,i){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return i(t)}n.db.transaction((function(r){$(r,n,(function(){e._dbInfo=n,t()}),(function(t,e){i(e)}))}),i)}));return n.serializer=K,r},_support:"function"==typeof openDatabase,iterate:function(t,e){var n=this,i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){J(n,r,"SELECT * FROM "+r.storeName,[],(function(n,i){for(var o=i.rows,s=o.length,a=0;a<s;a++){var u=o.item(a),l=u.value;if(l&&(l=r.serializer.deserialize(l)),void 0!==(l=t(l,u.key,a+1)))return void e(l)}e()}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},getItem:function(t,e){var n=this;t=l(t);var i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){J(n,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,n){var i=n.rows.length?n.rows.item(0).value:null;i&&(i=r.serializer.deserialize(i)),e(i)}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},setItem:function(t,e,n){return Q.apply(this,[t,e,n,1])},removeItem:function(t,e){var n=this;t=l(t);var i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){J(n,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},clear:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var i=e._dbInfo;i.db.transaction((function(e){J(e,i,"DELETE FROM "+i.storeName,[],(function(){t()}),(function(t,e){n(e)}))}))})).catch(n)}));return a(n,t),n},length:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var i=e._dbInfo;i.db.transaction((function(e){J(e,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],(function(e,n){var i=n.rows.item(0).c;t(i)}),(function(t,e){n(e)}))}))})).catch(n)}));return a(n,t),n},key:function(t,e){var n=this,i=new s((function(e,i){n.ready().then((function(){var r=n._dbInfo;r.db.transaction((function(n){J(n,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,n){var i=n.rows.length?n.rows.item(0).key:null;e(i)}),(function(t,e){i(e)}))}))})).catch(i)}));return a(i,e),i},keys:function(t){var e=this,n=new s((function(t,n){e.ready().then((function(){var i=e._dbInfo;i.db.transaction((function(e){J(e,i,"SELECT key FROM "+i.storeName,[],(function(e,n){for(var i=[],r=0;r<n.rows.length;r++)i.push(n.rows.item(r).key);t(i)}),(function(t,e){n(e)}))}))})).catch(n)}));return a(n,t),n},dropInstance:function(t,e){e=h.apply(this,arguments);var n=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var i,r=this;return a(i=t.name?new s((function(e){var i;i=t.name===n.name?r._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:i,storeNames:[t.storeName]}):e(tt(i))})).then((function(t){return new s((function(e,n){t.db.transaction((function(i){function r(t){return new s((function(e,n){i.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){n(e)}))}))}for(var o=[],a=0,u=t.storeNames.length;a<u;a++)o.push(r(t.storeNames[a]));s.all(o).then((function(){e()})).catch((function(t){n(t)}))}),(function(t){n(t)}))}))})):s.reject("Invalid arguments"),e),i}};function nt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function it(){return!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}()||localStorage.length>0}var rt={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=nt(t,this._defaultConfig),it()?(this._dbInfo=e,e.serializer=K,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,e){var n=this,i=n.ready().then((function(){for(var e=n._dbInfo,i=e.keyPrefix,r=i.length,o=localStorage.length,s=1,a=0;a<o;a++){var u=localStorage.key(a);if(0===u.indexOf(i)){var l=localStorage.getItem(u);if(l&&(l=e.serializer.deserialize(l)),void 0!==(l=t(l,u.substring(r),s++)))return l}}}));return a(i,e),i},getItem:function(t,e){var n=this;t=l(t);var i=n.ready().then((function(){var e=n._dbInfo,i=localStorage.getItem(e.keyPrefix+t);return i&&(i=e.serializer.deserialize(i)),i}));return a(i,e),i},setItem:function(t,e,n){var i=this;t=l(t);var r=i.ready().then((function(){void 0===e&&(e=null);var n=e;return new s((function(r,o){var s=i._dbInfo;s.serializer.serialize(e,(function(e,i){if(i)o(i);else try{localStorage.setItem(s.keyPrefix+t,e),r(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||o(t),o(t)}}))}))}));return a(r,n),r},removeItem:function(t,e){var n=this;t=l(t);var i=n.ready().then((function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));return a(i,e),i},clear:function(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var i=localStorage.key(n);0===i.indexOf(t)&&localStorage.removeItem(i)}}));return a(n,t),n},length:function(t){var e=this.keys().then((function(t){return t.length}));return a(e,t),e},key:function(t,e){var n=this,i=n.ready().then((function(){var e,i=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(i.keyPrefix.length)),e}));return a(i,e),i},keys:function(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo,n=localStorage.length,i=[],r=0;r<n;r++){var o=localStorage.key(r);0===o.indexOf(t.keyPrefix)&&i.push(o.substring(t.keyPrefix.length))}return i}));return a(n,t),n},dropInstance:function(t,e){if(e=h.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var i,r=this;return i=t.name?new s((function(e){t.storeName?e(nt(t,r._defaultConfig)):e(t.name+"/")})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments"),a(i,e),i}},ot=function(t,e){for(var n=t.length,i=0;i<n;){if((r=t[i])===(o=e)||"number"==typeof r&&"number"==typeof o&&isNaN(r)&&isNaN(o))return!0;i++}var r,o;return!1},st=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},at={},ut={},lt={INDEXEDDB:A,WEBSQL:et,LOCALSTORAGE:rt},ht=[lt.INDEXEDDB._driver,lt.WEBSQL._driver,lt.LOCALSTORAGE._driver],ct=["dropInstance"],ft=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ct),dt={description:"",driver:ht.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function pt(t,e){t[e]=function(){var n=arguments;return t.ready().then((function(){return t[e].apply(t,n)}))}}function vt(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(st(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var mt=function(){function t(e){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),lt)if(lt.hasOwnProperty(n)){var i=lt[n],r=i._driver;this[n]=r,at[r]||this.defineDriver(i)}this._defaultConfig=vt({},dt),this._config=vt({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return t.prototype.config=function(t){if("object"===(void 0===t?"undefined":i(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var i=new s((function(e,n){try{var i=t._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(r);for(var o=ft.concat("_initStorage"),u=0,l=o.length;u<l;u++){var h=o[u];if((!ot(ct,h)||t[h])&&"function"!=typeof t[h])return void n(r)}!function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=s.reject(e);return a(n,arguments[arguments.length-1]),n}},n=0,i=ct.length;n<i;n++){var r=ct[n];t[r]||(t[r]=e(r))}}();var c=function(n){at[i]&&console.info("Redefining LocalForage driver: "+i),at[i]=t,ut[i]=n,e()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(c,n):c(!!t._support):c(!0)}catch(t){n(t)}}));return u(i,e,n),i},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var i=at[t]?s.resolve(at[t]):s.reject(new Error("Driver not found."));return u(i,e,n),i},t.prototype.getSerializer=function(t){var e=s.resolve(K);return u(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then((function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready}));return u(n,t,t),n},t.prototype.setDriver=function(t,e,n){var i=this;st(t)||(t=[t]);var r=this._getSupportedDrivers(t);function o(){i._config.driver=i.driver()}function a(t){return i._extend(t),o(),i._ready=i._initStorage(i._config),i._ready}var l=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve();return this._driverSet=l.then((function(){var t=r[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then((function(t){i._driver=t._driver,o(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(t){return function(){var e=0;return function n(){for(;e<t.length;){var r=t[e];return e++,i._dbInfo=null,i._ready=null,i.getDriver(r).then(a).catch(n)}o();var u=new Error("No available storage method found.");return i._driverSet=s.reject(u),i._driverSet}()}}(r)}))})).catch((function(){o();var t=new Error("No available storage method found.");return i._driverSet=s.reject(t),i._driverSet})),u(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!ut[t]},t.prototype._extend=function(t){vt(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];this.supports(r)&&e.push(r)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ft.length;t<e;t++)pt(this,ft[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),gt=new mt;e.exports=gt},{3:3}]},{},[4])(4)},96539:function(t,e,n){var i=n(77400).Symbol;t.exports=i},99736:function(t,e,n){var i=n(96539),r=n(34840),o=n(21258),s=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":s&&s in Object(t)?r(t):o(t)}},74833:function(t,e,n){var i=n(56127),r=/^\s+/;t.exports=function(t){return t?t.slice(0,i(t)+1).replace(r,""):t}},39120:function(t,e,n){var i="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=i},34840:function(t,e,n){var i=n(96539),r=Object.prototype,o=r.hasOwnProperty,s=r.toString,a=i?i.toStringTag:void 0;t.exports=function(t){var e=o.call(t,a),n=t[a];try{t[a]=void 0;var i=!0}catch(t){}var r=s.call(t);return i&&(e?t[a]=n:delete t[a]),r}},21258:function(t){var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},77400:function(t,e,n){var i=n(39120),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();t.exports=o},56127:function(t){var e=/\s/;t.exports=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}},66726:function(t,e,n){var i=n(11611),r=n(82846),o=n(91936),s=Math.max,a=Math.min;t.exports=function(t,e,n){var u,l,h,c,f,d,p=0,v=!1,m=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function y(e){var n=u,i=l;return u=l=void 0,p=e,c=t.apply(i,n)}function b(t){return p=t,f=setTimeout(_,e),v?y(t):c}function w(t){var n=t-d;return void 0===d||n>=e||n<0||m&&t-p>=h}function _(){var t=r();if(w(t))return k(t);f=setTimeout(_,function(t){var n=e-(t-d);return m?a(n,h-(t-p)):n}(t))}function k(t){return f=void 0,g&&u?y(t):(u=l=void 0,c)}function x(){var t=r(),n=w(t);if(u=arguments,l=this,d=t,n){if(void 0===f)return b(d);if(m)return clearTimeout(f),f=setTimeout(_,e),y(d)}return void 0===f&&(f=setTimeout(_,e)),c}return e=o(e)||0,i(n)&&(v=!!n.leading,h=(m="maxWait"in n)?s(o(n.maxWait)||0,e):h,g="trailing"in n?!!n.trailing:g),x.cancel=function(){void 0!==f&&clearTimeout(f),p=0,u=d=l=f=void 0},x.flush=function(){return void 0===f?c:k(r())},x}},11611:function(t){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},92360:function(t){t.exports=function(t){return null!=t&&"object"==typeof t}},55193:function(t,e,n){var i=n(99736),r=n(92360);t.exports=function(t){return"symbol"==typeof t||r(t)&&"[object Symbol]"==i(t)}},82846:function(t,e,n){var i=n(77400);t.exports=function(){return i.Date.now()}},19783:function(t,e,n){var i=n(66726),r=n(11611);t.exports=function(t,e,n){var o=!0,s=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return r(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),i(t,e,{leading:o,maxWait:e,trailing:s})}},91936:function(t,e,n){var i=n(74833),r=n(11611),o=n(55193),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return NaN;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=i(t);var n=a.test(t);return n||u.test(t)?l(t.slice(2),n?2:8):s.test(t)?NaN:+t}},34369:function(t,e){"use strict";function n(t,e){function n(n){for(var o=e.length-1;o>=0;o--){var s=e[o],a=n.clientX,u=n.clientY;if(n.touches&&n.touches.length&&(a=n.touches[0].clientX,u=n.touches[0].clientY),r(s,t,a,u)){s.dispatchEvent(i(n));break}}}if("iframe"===t.nodeName||"IFRAME"===t.nodeName)try{this.target=t.contentDocument}catch(e){this.target=t}else this.target=t;for(var o=["mouseup","mousedown","click","touchstart"],s=0;s<o.length;s++){var a=o[s];this.target.addEventListener(a,(function(t){return n(t)}),!1)}}function i(t){var e=Object.assign({},t,{bubbles:!1});try{return new MouseEvent(t.type,e)}catch(i){var n=document.createEvent("MouseEvents");return n.initMouseEvent(t.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),n}}function r(t,e,n,i){var r=e.getBoundingClientRect();function o(t,e,n){var i=t.top-r.top,o=t.left-r.left,s=i+t.height,a=o+t.width;return i<=n&&o<=e&&s>n&&a>e}if(!o(t.getBoundingClientRect(),n,i))return!1;for(var s=t.getClientRects(),a=0,u=s.length;a<u;a++)if(o(s[a],n,i))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.proxyMouse=n,e.clone=i,e.default={proxyMouse:n}},74661:function(t,e,n){"use strict";e.v6=e.y$=e.X6=void 0;var i=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=a(n(42817)),s=a(n(34369));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.X6=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;h(this,t),this.target=e,this.element=o.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),s.default.proxyMouse(this.target,this.marks),this.container=n,this.container.appendChild(this.element),this.render()}return r(t,[{key:"addMark",value:function(t){var e=o.default.createElement("g");return this.element.appendChild(e),t.bind(e,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var e=this.marks.indexOf(t);if(-1!==e){var n=t.unbind();this.element.removeChild(n),this.marks.splice(e,1)}}},{key:"render",value:function(){var t,e,n,i;!function(t,e){t.style.setProperty("top",e.top+"px","important"),t.style.setProperty("left",e.left+"px","important"),t.style.setProperty("height",e.height+"px","important"),t.style.setProperty("width",e.width+"px","important")}(this.element,(t=this.target,e=this.container,n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),{top:i.top-n.top,left:i.left-n.left,height:t.scrollHeight,width:t.scrollWidth}));var r=!0,o=!1,s=void 0;try{for(var a,u=this.marks[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)a.value.render()}catch(t){o=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw s}}}}]),t}();var c=function(){function t(){h(this,t),this.element=null}return r(t,[{key:"bind",value:function(t,e){this.element=t,this.container=e}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],e=this.element.firstChild;e;)t.push(e.getBoundingClientRect()),e=e.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter((function(e){for(var n=0;n<t.length;n++){if(t[n]===e)return!0;if(i=t[n],(r=e).right<=i.right&&r.left>=i.left&&r.top>=i.top&&r.bottom<=i.bottom)return!1}var i,r;return!0}))}}]),t}(),f=e.y$=function(t){function e(t,n,i,r){h(this,e);var o=u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.range=t,o.className=n,o.data=i||{},o.attributes=r||{},o}return l(e,t),r(e,[{key:"bind",value:function(t,n){for(var r in i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,t,n),this.data)this.data.hasOwnProperty(r)&&(this.element.dataset[r]=this.data[r]);for(var r in this.attributes)this.attributes.hasOwnProperty(r)&&this.element.setAttribute(r,this.attributes[r]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var t=this.element.ownerDocument.createDocumentFragment(),e=this.filteredRanges(),n=this.element.getBoundingClientRect(),i=this.container.getBoundingClientRect(),r=0,s=e.length;r<s;r++){var a=e[r],u=o.default.createElement("rect");u.setAttribute("x",a.left-n.left+i.left),u.setAttribute("y",a.top-n.top+i.top),u.setAttribute("height",a.height),u.setAttribute("width",a.width),t.appendChild(u)}this.element.appendChild(t)}}]),e}(c);e.v6=function(t){function e(t,n,i,r){return h(this,e),u(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i,r))}return l(e,t),r(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var t=this.element.ownerDocument.createDocumentFragment(),e=this.filteredRanges(),n=this.element.getBoundingClientRect(),i=this.container.getBoundingClientRect(),r=0,s=e.length;r<s;r++){var a=e[r],u=o.default.createElement("rect");u.setAttribute("x",a.left-n.left+i.left),u.setAttribute("y",a.top-n.top+i.top),u.setAttribute("height",a.height),u.setAttribute("width",a.width),u.setAttribute("fill","none");var l=o.default.createElement("line");l.setAttribute("x1",a.left-n.left+i.left),l.setAttribute("x2",a.left-n.left+i.left+a.width),l.setAttribute("y1",a.top-n.top+i.top+a.height-1),l.setAttribute("y2",a.top-n.top+i.top+a.height-1),l.setAttribute("stroke-width",1),l.setAttribute("stroke","black"),l.setAttribute("stroke-linecap","square"),t.appendChild(u),t.appendChild(l)}this.element.appendChild(t)}}]),e}(f)},42817:function(t,e){"use strict";function n(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}Object.defineProperty(e,"__esModule",{value:!0}),e.createElement=n,e.default={createElement:n}},6011:function(t){"use strict";if(!e)var e={cwd:function(){return"/"}};function n(t){if("string"!=typeof t)throw new TypeError("Path must be a string. Received "+t)}function i(t,e){for(var n,i="",r=-1,o=0,s=0;s<=t.length;++s){if(s<t.length)n=t.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(r===s-1||1===o);else if(r!==s-1&&2===o){if(i.length<2||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){for(var a=i.length-1,u=a;u>=0&&47!==i.charCodeAt(u);--u);if(u!==a){i=-1===u?"":i.slice(0,u),r=s,o=0;continue}}else if(2===i.length||1===i.length){i="",r=s,o=0;continue}e&&(i.length>0?i+="/..":i="..")}else i.length>0?i+="/"+t.slice(r+1,s):i=t.slice(r+1,s);r=s,o=0}else 46===n&&-1!==o?++o:o=-1}return i}var r={resolve:function(){for(var t,r="",o=!1,s=arguments.length-1;s>=-1&&!o;s--){var a;s>=0?a=arguments[s]:(void 0===t&&(t=e.cwd()),a=t),n(a),0!==a.length&&(r=a+"/"+r,o=47===a.charCodeAt(0))}return r=i(r,!o),o?r.length>0?"/"+r:"/":r.length>0?r:"."},normalize:function(t){if(n(t),0===t.length)return".";var e=47===t.charCodeAt(0),r=47===t.charCodeAt(t.length-1);return 0!==(t=i(t,!e)).length||e||(t="."),t.length>0&&r&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return n(t),t.length>0&&47===t.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var t,e=0;e<arguments.length;++e){var i=arguments[e];n(i),i.length>0&&(void 0===t?t=i:t+="/"+i)}return void 0===t?".":r.normalize(t)},relative:function(t,e){if(n(t),n(e),t===e)return"";if((t=r.resolve(t))===(e=r.resolve(e)))return"";for(var i=1;i<t.length&&47===t.charCodeAt(i);++i);for(var o=t.length,s=o-i,a=1;a<e.length&&47===e.charCodeAt(a);++a);for(var u=e.length-a,l=s<u?s:u,h=-1,c=0;c<=l;++c){if(c===l){if(u>l){if(47===e.charCodeAt(a+c))return e.slice(a+c+1);if(0===c)return e.slice(a+c)}else s>l&&(47===t.charCodeAt(i+c)?h=c:0===c&&(h=0));break}var f=t.charCodeAt(i+c);if(f!==e.charCodeAt(a+c))break;47===f&&(h=c)}var d="";for(c=i+h+1;c<=o;++c)c!==o&&47!==t.charCodeAt(c)||(0===d.length?d+="..":d+="/..");return d.length>0?d+e.slice(a+h):(a+=h,47===e.charCodeAt(a)&&++a,e.slice(a))},_makeLong:function(t){return t},dirname:function(t){if(n(t),0===t.length)return".";for(var e=t.charCodeAt(0),i=47===e,r=-1,o=!0,s=t.length-1;s>=1;--s)if(47===(e=t.charCodeAt(s))){if(!o){r=s;break}}else o=!1;return-1===r?i?"/":".":i&&1===r?"//":t.slice(0,r)},basename:function(t,e){if(void 0!==e&&"string"!=typeof e)throw new TypeError('"ext" argument must be a string');n(t);var i,r=0,o=-1,s=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var a=e.length-1,u=-1;for(i=t.length-1;i>=0;--i){var l=t.charCodeAt(i);if(47===l){if(!s){r=i+1;break}}else-1===u&&(s=!1,u=i+1),a>=0&&(l===e.charCodeAt(a)?-1==--a&&(o=i):(a=-1,o=u))}return r===o?o=u:-1===o&&(o=t.length),t.slice(r,o)}for(i=t.length-1;i>=0;--i)if(47===t.charCodeAt(i)){if(!s){r=i+1;break}}else-1===o&&(s=!1,o=i+1);return-1===o?"":t.slice(r,o)},extname:function(t){n(t);for(var e=-1,i=0,r=-1,o=!0,s=0,a=t.length-1;a>=0;--a){var u=t.charCodeAt(a);if(47!==u)-1===r&&(o=!1,r=a+1),46===u?-1===e?e=a:1!==s&&(s=1):-1!==e&&(s=-1);else if(!o){i=a+1;break}}return-1===e||-1===r||0===s||1===s&&e===r-1&&e===i+1?"":t.slice(e,r)},format:function(t){if(null===t||"object"!=typeof t)throw new TypeError('Parameter "pathObject" must be an object, not '+typeof t);return function(t,e){var n=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return n?n===e.root?n+i:n+"/"+i:i}(0,t)},parse:function(t){n(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;var i,r=t.charCodeAt(0),o=47===r;o?(e.root="/",i=1):i=0;for(var s=-1,a=0,u=-1,l=!0,h=t.length-1,c=0;h>=i;--h)if(47!==(r=t.charCodeAt(h)))-1===u&&(l=!1,u=h+1),46===r?-1===s?s=h:1!==c&&(c=1):-1!==s&&(c=-1);else if(!l){a=h+1;break}return-1===s||-1===u||0===c||1===c&&s===u-1&&s===a+1?-1!==u&&(e.base=e.name=0===a&&o?t.slice(1,u):t.slice(a,u)):(0===a&&o?(e.name=t.slice(1,s),e.base=t.slice(1,u)):(e.name=t.slice(a,s),e.base=t.slice(a,u)),e.ext=t.slice(s,u)),a>0?e.dir=t.slice(0,a-1):o&&(e.dir="/"),e},sep:"/",delimiter:":",posix:null};t.exports=r},85111:function(t,e,n){"use strict";var i=n(99666);t.exports=function(t){if("function"!=typeof t)return!1;if(!hasOwnProperty.call(t,"length"))return!1;try{if("number"!=typeof t.length)return!1;if("function"!=typeof t.call)return!1;if("function"!=typeof t.apply)return!1}catch(t){return!1}return!i(t)}},64617:function(t,e,n){"use strict";var i=n(51102),r={object:!0,function:!0,undefined:!0};t.exports=function(t){return!!i(t)&&hasOwnProperty.call(r,typeof t)}},42307:function(t,e,n){"use strict";var i=n(85111),r=/^\s*class[\s{/}]/,o=Function.prototype.toString;t.exports=function(t){return!!i(t)&&!r.test(o.call(t))}},99666:function(t,e,n){"use strict";var i=n(64617);t.exports=function(t){if(!i(t))return!1;try{return!!t.constructor&&t.constructor.prototype===t}catch(t){return!1}}},51102:function(t){"use strict";t.exports=function(t){return null!=t}}}]);