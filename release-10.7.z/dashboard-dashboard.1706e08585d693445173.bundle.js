"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7515],{92780:function(e,t,a){a(23938),a(61013),a(32081),a(98010),a(63238),a(40895),a(99785);var n=a(47005),s=a(53754),r=a(83094),i=a(48906),o=a(9785),l=a(1197),d=(a(78066),a(17734),a(53913)),c=a(61642);function g(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,a,n,l){null==n&&(n=parseInt(t.getAttribute("data-activitystartindex")||"0")),l=l||parseInt(t.getAttribute("data-activitylimit")||"7");var d=new Date,c="false"!==t.getAttribute("data-useractivity");c?d.setTime(d.getTime()-864e5):d.setTime(d.getTime()-6048e5),ApiClient.getJSON(ApiClient.getUrl("System/ActivityLog/Entries",{startIndex:n,limit:l,minDate:d.toISOString(),hasUserId:c})).then((function(d){if(t.setAttribute("data-activitystartindex",n),t.setAttribute("data-activitylimit",l),!n){var c=r.ZP.parentWithClass(t,"activityContainer");c&&(d.Items.length?c.classList.remove("hide"):c.classList.add("hide"))}e.items=d.Items,function(e,t,a,n,r){e.innerHTML=a.Items.map((function(e){return function(e,t){var a="";a+='<div class="listItem listItem-border">';var n="#00a4dc",r="notifications";return"Error"!=e.Severity&&"Fatal"!=e.Severity&&"Warn"!=e.Severity||(n="#cc0000",r="notification_important"),e.UserId&&e.UserPrimaryImageTag?a+='<span class="listItemIcon material-icons dvr" style="width:2em!important;height:2em!important;padding:0;color:transparent;background-color:'+n+";background-image:url('"+t.getUserImageUrl(e.UserId,{type:"Primary",tag:e.UserPrimaryImageTag})+"');background-repeat:no-repeat;background-position:center center;background-size: cover;\"></span>":a+='<span class="listItemIcon material-icons '+r+'" style="background-color:'+n+'"></span>',a+='<div class="listItemBody three-line">',a+='<div class="listItemBodyText">',a+=e.Name,a+="</div>",a+='<div class="listItemBodyText secondary">',a+=i.Z(Date.parse(e.Date),Date.parse(new Date),{locale:o.ZP.getLocale()}),a+="</div>",a+='<div class="listItemBodyText secondary listItemBodyText-nowrap">',a+=e.ShortOverview||"",a+="</div>",a+="</div>",e.Overview&&(a+='<button type="button" is="paper-icon-button-light" class="btnEntryInfo" data-id="'.concat(e.Id,'" title="').concat(s.ZP.translate("Info"),'">\n                       <span class="material-icons info"></span>\n                    </button>')),a+"</div>"}(e,t)})).join("")}(t,a,d)}))}function m(e,t,a){var n=this.options;n&&n.serverId===t.serverId()&&u(this,n.element,t)}function p(e){var t=r.ZP.parentWithClass(e.target,"btnEntryInfo");if(t){var a=t.getAttribute("data-id"),n=this.items;if(n){var s=n.filter((function(e){return e.Id.toString()===a}))[0];s&&function(e){(0,c.Z)({text:e.Overview})}(s)}}}var v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t;var a=t.element;a.classList.add("activityLogListWidget"),a.addEventListener("click",p.bind(this));var s=d.Z.getApiClient(t.serverId);u(this,a,s);var r=m.bind(this);this.updateFn=r,n.Events.on(l.default,"ActivityLogEntry",r),s.sendMessage("ActivityLogEntryStart","0,1500")}var t,a;return t=e,(a=[{key:"destroy",value:function(){var e=this.options;e&&(e.element.classList.remove("activityLogListWidget"),d.Z.getApiClient(e.serverId).sendMessage("ActivityLogEntryStop","0,1500"));var t=this.updateFn;t&&n.Events.off(l.default,"ActivityLogEntry",t),this.items=null,this.options=null}}])&&g(t.prototype,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Z=v},10480:function(e,t,a){t.Z={getDisplayPlayMethod:function(e){return e.NowPlayingItem?e.TranscodingInfo&&e.TranscodingInfo.IsVideoDirect&&e.TranscodingInfo.IsAudioDirect?"Remux":e.TranscodingInfo&&e.TranscodingInfo.IsVideoDirect?"DirectStream":"Transcode"===e.PlayState.PlayMethod?"Transcode":"DirectStream"===e.PlayState.PlayMethod||"DirectPlay"===e.PlayState.PlayMethod?"DirectPlay":void 0:null}}},9899:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}}),a(5769),a(63238),a(55849),a(61418),a(17460),a(14078),a(98010),a(76056),a(27471),a(23938);var n=a(28469),s=a(47005),r=a(71616),i=a(1197),o=a(83094),l=a(53754),d=a(19502),c=a(9785),g=a(6594),u=a(10480),m=a(61097),p=a(91081),v=a(92780),h=a(7816),f=a(61160),y=(a(17734),a(78066),a(93462),a(32420),a(30504)),P=a(76543),S=a(53913),I=a(61642),b=a(56346);function T(e,t){var a,n=[],s=u.Z.getDisplayPlayMethod(t);"Remux"===s?(a=l.ZP.translate("Remuxing"),n.push(l.ZP.translate("RemuxHelp1")),n.push("<br/>"),n.push(l.ZP.translate("RemuxHelp2"))):"DirectStream"===s?(a=l.ZP.translate("DirectStreaming"),n.push(l.ZP.translate("DirectStreamHelp1")),n.push("<br/>"),n.push(l.ZP.translate("DirectStreamHelp2"))):"DirectPlay"===s?(a=l.ZP.translate("DirectPlaying"),n.push(l.ZP.translate("DirectPlayHelp"))):"Transcode"===s&&(a=l.ZP.translate("Transcoding"),n.push(l.ZP.translate("MediaIsBeingConverted")),n.push(DashboardPage.getSessionNowPlayingStreamInfo(t)),t.TranscodingInfo&&t.TranscodingInfo.TranscodeReasons&&t.TranscodingInfo.TranscodeReasons.length&&(n.push("<br/>"),n.push(l.ZP.translate("LabelReasonForTranscoding")),t.TranscodingInfo.TranscodeReasons.forEach((function(e){n.push(l.ZP.translate(e))})))),(0,I.Z)({text:n.join("<br/>"),title:a})}function Z(e,t){a.e(5506).then(a.bind(a,95506)).then((function(e){(0,e.default)({title:l.ZP.translate("HeaderSendMessage"),label:l.ZP.translate("LabelMessageText"),confirmText:l.ZP.translate("ButtonSend")}).then((function(e){e&&S.Z.getApiClient(t.ServerId).sendMessageCommand(t.Id,{Text:e,TimeoutMs:5e3})}))}))}function C(e){var t=o.ZP.parentWithClass(e.target,"sessionCardButton");if(t){var n=o.ZP.parentWithClass(t,"card");if(n){var s=n.id,r=(DashboardPage.sessionsList||[]).filter((function(e){return"session"+e.Id===s}))[0];r&&(t.classList.contains("btnCardOptions")?function(e,t){Promise.resolve().then(a.bind(a,32465)).then((function(a){var n=a.default,s=[];return t.ServerId&&t.DeviceId!==S.Z.deviceId()&&s.push({name:l.ZP.translate("SendMessage"),id:"sendmessage"}),t.TranscodingInfo&&t.TranscodingInfo.TranscodeReasons&&t.TranscodingInfo.TranscodeReasons.length&&s.push({name:l.ZP.translate("ViewPlaybackInfo"),id:"transcodinginfo"}),n.show({items:s,positionTo:e}).then((function(e){switch(e){case"sendmessage":Z(0,t);break;case"transcodinginfo":T(0,t)}}))}))}(t,r):t.classList.contains("btnSessionInfo")?T(0,r):t.classList.contains("btnSessionSendMessage")?Z(0,r):t.classList.contains("btnSessionStop")?S.Z.getApiClient(r.ServerId).sendPlayStateCommand(r.Id,"Stop"):t.classList.contains("btnSessionPlayPause")&&r.PlayState&&S.Z.getApiClient(r.ServerId).sendPlayStateCommand(r.Id,"PlayPause"))}}}function L(e,t){t.getSystemInfo().then((function(t){e.querySelector("#serverName").innerHTML=l.ZP.translate("DashboardServerName",t.ServerName),e.querySelector("#versionNumber").innerHTML=l.ZP.translate("DashboardVersionNumber",t.Version),e.querySelector("#operatingSystem").innerHTML=l.ZP.translate("DashboardOperatingSystem",t.OperatingSystem),e.querySelector("#architecture").innerHTML=l.ZP.translate("DashboardArchitecture",t.SystemArchitecture),t.CanSelfRestart?e.querySelector("#btnRestartServer").classList.remove("hide"):e.querySelector("#btnRestartServer").classList.add("hide"),e.querySelector("#cachePath").innerHTML=t.CachePath,e.querySelector("#logPath").innerHTML=t.LogPath,e.querySelector("#transcodePath").innerHTML=t.TranscodingTempPath,e.querySelector("#metadataPath").innerHTML=t.InternalMetadataPath,e.querySelector("#webPath").innerHTML=t.WebPath}))}function A(e,t,a){(function(e,t){var a="";DashboardPage.sessionsList=t;var n=e.querySelector(".activeDevices"),s=n.querySelector(".card");s&&s.classList.add("deadSession");for(var r=0,i=t.length;r<i;r++){var o=t[r],d="session"+o.Id,c=e.querySelector("#"+d);if(c)DashboardPage.updateSession(c,o);else{var g,u,p,v=o.NowPlayingItem,h=DashboardPage.getNowPlayingImageUrl(v);a+='<div class="scalableCard card activeSession backdropCard backdropCard-scalable" id="'+d+'">',a+='<div class="cardBox visualCardBox">',a+='<div class="cardScalable visualCardBox-cardScalable">',a+='<div class="cardPadder cardPadder-backdrop"></div>',a+='<div class="cardContent '.concat(m.default.getDefaultBackgroundClass(),'">'),h?(a+='<div class="sessionNowPlayingContent sessionNowPlayingContent-withbackground"',a+=' data-src="'+h+'" style="display:inline-block;background-image:url(\''+h+"');\"></div>"):a+='<div class="sessionNowPlayingContent"></div>',a+='<div class="sessionNowPlayingInnerContent">',a+='<div class="sessionAppInfo">';var y=DashboardPage.getClientImage(o);y&&(a+=y),a+='<div class="sessionAppName" style="display:inline-block;">',a+='<div class="sessionDeviceName">'+o.DeviceName+"</div>",a+='<div class="sessionAppSecondaryText">'+DashboardPage.getAppSecondaryText(o)+"</div>",a+="</div>",a+="</div>",a+='<div class="sessionNowPlayingDetails">';var P=DashboardPage.getNowPlayingName(o);a+='<div class="sessionNowPlayingInfo" data-imgsrc="'+P.image+'">',a+=P.html,a+="</div>",a+='<div class="sessionNowPlayingTime">'+DashboardPage.getSessionNowPlayingTime(o)+"</div>",a+="</div>";var I=100*(null==o||null===(g=o.PlayState)||void 0===g?void 0:g.PositionTicks)/(null==v?void 0:v.RunTimeTicks);a+=f.ZP.getProgressHtml(I||0,{containerClass:"playbackProgress"}),I=null==o||null===(u=o.TranscodingInfo)||void 0===u||null===(p=u.CompletionPercentage)||void 0===p?void 0:p.toFixed(1),a+=f.ZP.getProgressHtml(I||0,{containerClass:"transcodingProgress"}),a+=f.ZP.getProgressHtml(100,{containerClass:"backgroundProgress"}),a+="</div>",a+="</div>",a+="</div>",a+='<div class="sessionCardFooter cardFooter">',a+='<div class="sessionCardButtons flex align-items-center justify-content-center">';var b=o.ServerId&&o.NowPlayingItem&&o.SupportsRemoteControl?"":" hide";a+='<button is="paper-icon-button-light" class="sessionCardButton btnSessionPlayPause paper-icon-button-light '+b+'"><span class="material-icons '+(o.PlayState.IsPaused?"pause":"play_arrow")+'"></span></button>',a+='<button is="paper-icon-button-light" class="sessionCardButton btnSessionStop paper-icon-button-light '+b+'"><span class="material-icons stop"></span></button>',a+='<button is="paper-icon-button-light" class="sessionCardButton btnSessionInfo paper-icon-button-light '+b+'" title="'+l.ZP.translate("ViewPlaybackInfo")+'"><span class="material-icons info"></span></button>',a+='<button is="paper-icon-button-light" class="sessionCardButton btnSessionSendMessage paper-icon-button-light '+(b=o.ServerId&&-1!==o.SupportedCommands.indexOf("DisplayMessage")&&o.DeviceId!==S.Z.deviceId()?"":" hide")+'" title="'+l.ZP.translate("SendMessage")+'"><span class="material-icons message"></span></button>',a+="</div>",a+='<div class="flex align-items-center justify-content-center">';var T=DashboardPage.getUserImage(o);a+=T?'<div class="activitylogUserPhoto" style="background-image:url(\''+T+"');\"></div>":'<div style="height:1.71em;"></div>',a+='<div class="sessionUserName">',a+=DashboardPage.getUsersHtml(o),a+="</div>",a+="</div>",a+="</div>",a+="</div>",a+="</div>"}}n.insertAdjacentHTML("beforeend",a);var Z=n.querySelector(".deadSession");Z&&Z.parentNode.removeChild(Z)})(e,t=function(e){for(var t=[],a=(new Date).getTime()-9e5,s=0,r=e.length;s<r;s++){var i=e[s];(i.NowPlayingItem||i.UserId)&&n.ZP.parseISO8601Date(i.LastActivityDate,!0).getTime()>=a&&t.push(i)}return t}(t)),g.ZP.hide()}function k(e,t,a){t.getSessions({ActiveWithinSeconds:960}).then((function(t){A(e,t)})),t.getScheduledTasks().then((function(t){w(e,t)}))}function w(e,t){var a="";t=t.filter((function(e){return"Idle"!=e.State&&!e.IsHidden})),t.length?e.querySelector(".runningTasksContainer").classList.remove("hide"):e.querySelector(".runningTasksContainer").classList.add("hide");for(var n=0,s=t.length;n<s;n++){var r=t[n];if(a+="<p>",a+=r.Name+"<br/>","Running"===r.State){var i=(r.CurrentProgressPercentage||0).toFixed(1);a+='<progress max="100" value="'+i+'" title="'+i+'%">',a+=i+"%",a+="</progress>",a+="<span style='color:#00a4dc;margin-left:5px;margin-right:5px;'>"+i+"%</span>",a+='<button type="button" is="paper-icon-button-light" title="'+l.ZP.translate("ButtonStop")+'" onclick="DashboardPage.stopTask(this, \''+r.Id+'\');" class="autoSize"><span class="material-icons cancel"></span></button>'}else"Cancelling"===r.State&&(a+='<span style="color:#cc0000;">'+l.ZP.translate("LabelStopping")+"</span>");a+="</p>"}e.querySelector("#divRunningTasks").innerHTML=a}function D(e,t){function a(e,t){console.debug("onRestartRequired not implemented",e,t)}function n(e,t){console.debug("onServerShuttingDown not implemented",e,t)}function r(e,t){console.debug("onServerRestarting not implemented",e,t)}function o(t,a){a.serverId()===u&&(k(e,a),L(e,a))}function l(t,a){a.serverId()===u&&(k(e,a),L(e,a))}function d(t,a,n){a.serverId()===u&&A(e,n)}function c(t,a,n){a.serverId()===u&&w(e,n)}var u=ApiClient.serverId();e.querySelector(".activeDevices").addEventListener("click",C),e.addEventListener("viewshow",(function(){var t=this,u=ApiClient;u&&(g.ZP.show(),k(t,u),DashboardPage.startInterval(u),s.Events.on(i.default,"RestartRequired",a),s.Events.on(i.default,"ServerShuttingDown",n),s.Events.on(i.default,"ServerRestarting",r),s.Events.on(i.default,"PackageInstalling",o),s.Events.on(i.default,"PackageInstallationCompleted",l),s.Events.on(i.default,"Sessions",d),s.Events.on(i.default,"ScheduledTasksInfo",c),DashboardPage.lastAppUpdateCheck=null,L(t,ApiClient),t.userActivityLog||(t.userActivityLog=new v.Z({serverId:ApiClient.serverId(),element:t.querySelector(".userActivityItems")})),ApiClient.isMinServerVersion("3.4.1.25")&&(t.serverActivityLog||(t.serverActivityLog=new v.Z({serverId:ApiClient.serverId(),element:t.querySelector(".serverActivityItems")}))),function(e,t){t.getLiveTvRecordings({UserId:P.ZP.getCurrentUserId(),IsInProgress:!0,Fields:"CanDelete,PrimaryImageAspectRatio",EnableTotalRecordCount:!1,EnableImageTypes:"Primary,Thumb,Backdrop"}).then((function(t){var a=e.querySelector(".activeRecordingItems");if(!t.Items.length)return e.querySelector(".activeRecordingsSection").classList.add("hide"),void(a.innerHTML="");e.querySelector(".activeRecordingsSection").classList.remove("hide"),a.innerHTML=m.default.getCardsHtml({items:t.Items,shape:"auto",defaultShape:"backdrop",showTitle:!0,showParentTitle:!0,coverImage:!0,cardLayout:!1,centerText:!0,preferThumb:"auto",overlayText:!1,overlayMoreButton:!0,action:"none",centerPlayButton:!0}),p.default.lazyChildren(a)}))}(e,u),g.ZP.hide()),(0,y.Z)({mode:"on",taskKey:"RefreshLibrary",button:t.querySelector(".btnRefresh")})})),e.addEventListener("viewbeforehide",(function(){var e=ApiClient;s.Events.off(i.default,"RestartRequired",a),s.Events.off(i.default,"ServerShuttingDown",n),s.Events.off(i.default,"ServerRestarting",r),s.Events.off(i.default,"PackageInstalling",o),s.Events.off(i.default,"PackageInstallationCompleted",l),s.Events.off(i.default,"Sessions",d),s.Events.off(i.default,"ScheduledTasksInfo",c),e&&DashboardPage.stopInterval(e),(0,y.Z)({mode:"off",taskKey:"RefreshLibrary",button:this.querySelector(".btnRefresh")})})),e.addEventListener("viewdestroy",(function(){var e=this.userActivityLog;e&&e.destroy();var t=this.serverActivityLog;t&&t.destroy()}))}window.DashboardPage={startInterval:function(e){e.sendMessage("SessionsStart","0,1500"),e.sendMessage("ScheduledTasksInfoStart","0,1000")},stopInterval:function(e){e.sendMessage("SessionsStop"),e.sendMessage("ScheduledTasksInfoStop")},getSessionNowPlayingStreamInfo:function(e){var t="",a=!1,n=u.Z.getDisplayPlayMethod(e);if("DirectPlay"===n?t+=l.ZP.translate("DirectPlaying"):"Remux"===n?t+=l.ZP.translate("Remuxing"):"DirectStream"===n?t+=l.ZP.translate("DirectStreaming"):"Transcode"===n&&(e.TranscodingInfo&&e.TranscodingInfo.Framerate&&(t+="".concat(l.ZP.translate("Framerate"),": ").concat(e.TranscodingInfo.Framerate,"fps")),a=!0),a){var s=[];e.TranscodingInfo&&(e.TranscodingInfo.Bitrate&&(e.TranscodingInfo.Bitrate>1e6?s.push((e.TranscodingInfo.Bitrate/1e6).toFixed(1)+" Mbps"):s.push(Math.floor(e.TranscodingInfo.Bitrate/1e3)+" Kbps")),e.TranscodingInfo.Container&&s.push(e.TranscodingInfo.Container.toUpperCase()),e.TranscodingInfo.VideoCodec&&s.push(e.TranscodingInfo.VideoCodec.toUpperCase()),e.TranscodingInfo.AudioCodec&&e.TranscodingInfo.AudioCodec!=e.TranscodingInfo.Container&&s.push(e.TranscodingInfo.AudioCodec.toUpperCase())),s.length&&(t+="<br/><br/>"+s.join(" "))}return t},getSessionNowPlayingTime:function(e){var t=e.NowPlayingItem,a="";return t&&(e.PlayState.PositionTicks?a+=n.ZP.getDisplayRunningTime(e.PlayState.PositionTicks):a+="0:00",a+=" / ",t&&t.RunTimeTicks?a+=n.ZP.getDisplayRunningTime(t.RunTimeTicks):a+="0:00"),a},getAppSecondaryText:function(e){return e.Client+" "+e.ApplicationVersion},getNowPlayingName:function(e){var t="",a=e.NowPlayingItem;if(!a)return{html:l.ZP.translate("LastSeen",(0,d.Z)(Date.parse(e.LastActivityDate),c.mF)),image:t};var n=r.ZP.getDisplayName(a),s="";return a.Artists&&a.Artists.length?(s=n,n=a.Artists[0]):a.SeriesName||a.Album?(s=n,n=a.SeriesName||a.Album):a.ProductionYear&&(s=a.ProductionYear),a.ImageTags&&a.ImageTags.Logo?t=ApiClient.getScaledImageUrl(a.Id,{tag:a.ImageTags.Logo,maxHeight:24,maxWidth:130,type:"Logo"}):a.ParentLogoImageTag&&(t=ApiClient.getScaledImageUrl(a.ParentLogoItemId,{tag:a.ParentLogoImageTag,maxHeight:24,maxWidth:130,type:"Logo"})),t&&(n='<img src="'+t+'" style="max-height:24px;max-width:130px;" />'),{html:s?n+"<br/>"+s:n,image:t}},getUsersHtml:function(e){var t=[];e.UserId&&t.push(e.UserName);for(var a=0,n=e.AdditionalUsers.length;a<n;a++)t.push(e.AdditionalUsers[a].UserName);return t.join(", ")},getUserImage:function(e){return e.UserId&&e.UserPrimaryImageTag?ApiClient.getUserImageUrl(e.UserId,{tag:e.UserPrimaryImageTag,type:"Primary"}):null},updateSession:function(e,t){var a,n,s;e.classList.remove("deadSession");var r=t.NowPlayingItem;r?(e.classList.add("playingSession"),e.querySelector(".btnSessionInfo").classList.remove("hide")):(e.classList.remove("playingSession"),e.querySelector(".btnSessionInfo").classList.add("hide")),t.ServerId&&-1!==t.SupportedCommands.indexOf("DisplayMessage")?e.querySelector(".btnSessionSendMessage").classList.remove("hide"):e.querySelector(".btnSessionSendMessage").classList.add("hide");var i=e.querySelector(".btnSessionPlayPause");t.ServerId&&r&&t.SupportsRemoteControl?(i.classList.remove("hide"),e.querySelector(".btnSessionStop").classList.remove("hide")):(i.classList.add("hide"),e.querySelector(".btnSessionStop").classList.add("hide"));var o=i.querySelector(".material-icons");o.classList.remove("play_arrow","pause"),o.classList.add(t.PlayState&&t.PlayState.IsPaused?"play_arrow":"pause"),e.querySelector(".sessionNowPlayingTime").innerHTML=DashboardPage.getSessionNowPlayingTime(t),e.querySelector(".sessionUserName").innerHTML=DashboardPage.getUsersHtml(t),e.querySelector(".sessionAppSecondaryText").innerHTML=DashboardPage.getAppSecondaryText(t);var l=DashboardPage.getNowPlayingName(t),d=e.querySelector(".sessionNowPlayingInfo");l.image&&l.image==d.getAttribute("data-imgsrc")||(d.innerHTML=l.html,d.setAttribute("data-imgsrc",l.image||""));var c=e.querySelector(".playbackProgress"),g=e.querySelector(".transcodingProgress"),u=100*(null==t||null===(a=t.PlayState)||void 0===a?void 0:a.PositionTicks)/(null==r?void 0:r.RunTimeTicks);c.outerHTML=f.ZP.getProgressHtml(u||0,{containerClass:"playbackProgress"}),u=null==t||null===(n=t.TranscodingInfo)||void 0===n||null===(s=n.CompletionPercentage)||void 0===s?void 0:s.toFixed(1),g.outerHTML=f.ZP.getProgressHtml(u||0,{containerClass:"transcodingProgress"});var m=DashboardPage.getNowPlayingImageUrl(r)||"",p=e.querySelector(".sessionNowPlayingContent");m!=p.getAttribute("data-src")&&(p.style.backgroundImage=m?"url('"+m+"')":"",p.setAttribute("data-src",m),m?p.classList.add("sessionNowPlayingContent-withbackground"):p.classList.remove("sessionNowPlayingContent-withbackground"))},getClientImage:function(e){return"<img src='"+h.ZP.getDeviceIcon(e)+"' />"},getNowPlayingImageUrl:function(e){if(e&&e.BackdropImageTags&&e.BackdropImageTags.length)return ApiClient.getScaledImageUrl(e.Id,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Backdrop",tag:e.BackdropImageTags[0]});if(e&&e.ParentBackdropImageTags&&e.ParentBackdropImageTags.length)return ApiClient.getScaledImageUrl(e.ParentBackdropItemId,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Backdrop",tag:e.ParentBackdropImageTags[0]});if(e&&e.BackdropImageTag)return ApiClient.getScaledImageUrl(e.BackdropItemId,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Backdrop",tag:e.BackdropImageTag});var t=(e||{}).ImageTags||{};return e&&t.Thumb?ApiClient.getScaledImageUrl(e.Id,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Thumb",tag:t.Thumb}):e&&e.ParentThumbImageTag?ApiClient.getScaledImageUrl(e.ParentThumbItemId,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Thumb",tag:e.ParentThumbImageTag}):e&&e.ThumbImageTag?ApiClient.getScaledImageUrl(e.ThumbItemId,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Thumb",tag:e.ThumbImageTag}):e&&t.Primary?ApiClient.getScaledImageUrl(e.Id,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Primary",tag:t.Primary}):e&&e.PrimaryImageTag?ApiClient.getScaledImageUrl(e.PrimaryImageItemId,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Primary",tag:e.PrimaryImageTag}):e&&e.AlbumPrimaryImageTag?ApiClient.getScaledImageUrl(e.AlbumId,{maxWidth:Math.round(.2*o.ZP.getScreenWidth()),type:"Primary",tag:e.AlbumPrimaryImageTag}):null},systemUpdateTaskKey:"SystemUpdateTask",stopTask:function(e,t){var a=o.ZP.parentWithClass(e,"page");ApiClient.stopScheduledTask(t).then((function(){k(a,ApiClient)}))},restart:function(e){(0,b.Z)({title:l.ZP.translate("Restart"),text:l.ZP.translate("MessageConfirmRestart"),confirmText:l.ZP.translate("Restart"),primary:"delete"}).then((function(){var t=o.ZP.parentWithClass(e,"page");t.querySelector("#btnRestartServer").disabled=!0,t.querySelector("#btnShutdown").disabled=!0,ApiClient.restartServer()}))},shutdown:function(e){(0,b.Z)({title:l.ZP.translate("ButtonShutdown"),text:l.ZP.translate("MessageConfirmShutdown"),confirmText:l.ZP.translate("ButtonShutdown"),primary:"delete"}).then((function(){var t=o.ZP.parentWithClass(e,"page");t.querySelector("#btnRestartServer").disabled=!0,t.querySelector("#btnShutdown").disabled=!0,ApiClient.shutdownServer()}))}}},9785:function(e,t,a){a.d(t,{Kd:function(){return X},mF:function(){return $}});var n=a(77946),s=a(12496),r=a(11401),i=a(84146),o=a(59996),l=a(78210),d=a(9477),c=a(33026),g=a(91814),u=a(88303),m=a(22410),p=a(35997),v=a(73956),h=a(86496),f=a(6902),y=a(35163),P=a(36749),S=a(89310),I=a(22481),b=a(75710),T=a(11109),Z=a(74270),C=a(37159),L=a(27324),A=a(68490),k=a(19046),w=a(81905),D=a(19656),x=a(5905),M=a(64660),R=a(69509),N=a(24770),U=a(84216),E=a(77411),q=a(23282),B=a(60754),H=a(21430),W=a(45614),F=a(83305),O=a(95861),j=a(37405),V=a(6148),K=a(63258),z=a(50281),_=a(67889),Y=a(44362),J=a(69244),G=a(96730),Q=a(53754);function X(){return e=Q.ZP.getCurrentLocale(),{af:n.Z,ar:s.Z,"be-by":r.Z,"bg-bg":i.Z,bn:o.Z,ca:l.Z,cs:d.Z,da:c.Z,de:g.Z,el:u.Z,"en-gb":m.Z,"en-us":p.Z,eo:v.Z,es:h.Z,"es-ar":h.Z,"es-do":h.Z,"es-mx":h.Z,fa:f.Z,fi:y.Z,fr:P.Z,"fr-ca":S.Z,gl:I.Z,gsw:g.Z,he:b.Z,"hi-in":T.Z,hr:Z.Z,hu:C.Z,id:L.Z,is:A.Z,it:k.Z,ja:w.Z,kk:D.Z,ko:x.Z,"lt-lt":M.Z,ms:R.Z,nb:N.Z,nl:U.Z,pl:E.Z,pt:q.Z,"pt-br":B.Z,"pt-pt":q.Z,ro:H.Z,ru:W.Z,sk:F.Z,"sl-si":O.Z,sv:j.Z,ta:V.Z,th:K.Z,tr:z.Z,uk:_.Z,vi:Y.Z,"zh-cn":J.Z,"zh-hk":J.Z,"zh-tw":G.Z}[e]||p.Z;var e}var $={addSuffix:!0,locale:X()};t.ZP={getLocale:X,localeWithSuffix:$}},30504:function(e,t,a){a.d(t,{Z:function(){return o}}),a(98010),a(63238),a(76056);var n=a(47005),s=a(1197),r=a(53754),i=(a(78066),a(53913));function o(e){function t(){i.Z.getApiClient(u).getScheduledTasks({IsEnabled:!0}).then(a)}function a(t){var a=t.filter((function(t){return t.Key==e.taskKey}))[0];if(e.panel&&(a?e.panel.classList.remove("hide"):e.panel.classList.add("hide")),a){"Idle"==a.State?g.removeAttribute("disabled"):g.setAttribute("disabled","disabled"),g.setAttribute("data-taskid",a.Id);var n=(a.CurrentProgressPercentage||0).toFixed(1);if(e.progressElem&&(e.progressElem.value=n,"Running"==a.State?e.progressElem.classList.remove("hide"):e.progressElem.classList.add("hide")),e.lastResultElem){var s=a.LastExecutionResult?a.LastExecutionResult.Status:"";"Failed"==s?e.lastResultElem.html('<span style="color:#FF0000;">('+r.ZP.translate("LabelFailed")+")</span>"):"Cancelled"==s?e.lastResultElem.html('<span style="color:#0026FF;">('+r.ZP.translate("LabelCancelled")+")</span>"):"Aborted"==s?e.lastResultElem.html('<span style="color:#FF0000;">'+r.ZP.translate("LabelAbortedByServerShutdown")+"</span>"):e.lastResultElem.html(s)}}}function o(){var e;e=this.getAttribute("data-taskid"),i.Z.getApiClient(u).startScheduledTask(e).then(t)}function l(e,t,n){t.serverId()===u&&a(n)}var d,c,g=e.button,u=ApiClient.serverId();e.panel&&e.panel.classList.add("hide"),"off"==e.mode?(g.removeEventListener("click",o),n.Events.off(s.default,"ScheduledTasksInfo",l),i.Z.getApiClient(u).sendMessage("ScheduledTasksInfoStop"),d&&clearInterval(d)):(g.addEventListener("click",o),t(),c=i.Z.getApiClient(u),d&&clearInterval(d),c.sendMessage("ScheduledTasksInfoStart","1000,1000"),d=setInterval((function(){i.Z.getApiClient(u).isMessageChannelOpen()||t()}),5e3),n.Events.on(s.default,"ScheduledTasksInfo",l))}}}]);